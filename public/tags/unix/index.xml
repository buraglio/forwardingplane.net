<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>UNIX on ForwardingPlane.net</title>
    <link>https://forwardingplane.net/tags/unix/</link>
    <description>Recent content in UNIX on ForwardingPlane.net</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>Copyright (c) 2019, all rights reserved.</copyright>
    <lastBuildDate>Mon, 29 Apr 2019 10:23:32 +0000</lastBuildDate>
    
        <atom:link href="https://forwardingplane.net/tags/unix/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>The value of measurements: Network Latency</title>
      <link>https://forwardingplane.net/post/the-value-of-measurements-network-latency/</link>
      <pubDate>Mon, 29 Apr 2019 10:23:32 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/the-value-of-measurements-network-latency/</guid>
      <description>&lt;p&gt;There is no shortage of network telemetry data that can be collected, recorded, graphed, and stored for cross reference and triage. Not one to be underestimated, latency at a can be incredibly powerful when leveraged for baseline and deviation notification. As I have &lt;a href=&#34;https://www.forwardingplane.net/2018/02/strategy-series-view-outside-network/&#34;&gt;eluded to in the past,&lt;/a&gt; there are many tools in this space. &lt;a href=&#34;https://netbeez.net/blog/how-to-leverage-latency-testing-and-long-term-trend-collection/&#34;&gt;I have written about a few of them in detail&lt;/a&gt; and touched on others in passing. Regardless of the tool, the data is powerful and the instrumentation they provide will only serve to make your network more robust and easier to work on. One tool that is particularly easy to set up and utilize is &lt;a href=&#34;https://oss.oetiker.ch/smokeping/&#34;&gt;smokeping&lt;/a&gt;. From the authors site: &lt;em&gt;SmokePing keeps track of your network latency:&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Best of breed latency visualisation.&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Interactive graph explorer.&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Wide range of latency measurement plugins.&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Master/Slave System for distributed measurement.&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Highly configurable alerting system.&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Live Latency Charts with the most &amp;lsquo;interesting&amp;rsquo; graphs.&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Free and OpenSource Software written in Perl written by Tobi Oetiker, the creator of MRTG and RRDtool &lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&#34;https://www.forwardingplane.net/wp-content/uploads/2019/04/download_Comcast_Chicago_last_864000.png&#34; alt=&#34;Download Comcast Chicago last 864000&#34; title=&#34;download_Comcast_Chicago_last_864000.png&#34; /&gt; &lt;em&gt;Comcast SpeedTest.net graph for home network&lt;/em&gt; Now, you may be asking _“why do I need to track latency?_”, well, the data is incredibly powerful and can be indicators of anything from a failing optic to a network compromise. This is especially useful in small to medium sized ISPs (and especially WISPs), where cost of software and operational overhead is at a premium, and customer satisfaction is the currency that is dealt. In fact, I was able to use smokeqping to help diagnose a functional denial of service of a commonly deployed cable CPE as detailed &lt;a href=&#34;https://forums.businesshelp.comcast.com/t5/IPV6/Reproducible-denial-of-service-of-Netgear-CPE-running-native/m-p/31597#M787&#34;&gt;here&lt;/a&gt;. &lt;strong&gt;I can’t emphasize enough how useful long term trend data is.&lt;/strong&gt; Smokeping can be used to monitor more than just ping RTT, it supports a myriad of plugins allowing for application latency of protocols such as DNS queries, http get, ssh daemon response, speed test results, the list of plugins - or as smokeping calls them, probes - goes on and can be found &lt;a href=&#34;https://oss.oetiker.ch/smokeping/probe/index.en.html&#34;&gt;here&lt;/a&gt;. Where this is particularly useful is in simulating customer experience.  As with most things in life, perspective is paramount. To address this, smokeping can also be deployed as a distributed model. Deploying it with installations more local to a customer or in a far flung site, say on a raspberry pi, located in remote POP sides or pedestal locations will provide a closer perspective to what the customer actually sees. In the past I have deployed remote raspberry pi devices in an actual FTTH pedestal connected to an ONT to provide the exact customer point of view and it provided a wealth of information I would not otherwise be able to see. There are a myriad of different instal guides for Smokeping, my recommended starting point is by &lt;a href=&#34;https://github.com/magicdude4eva&#34;&gt;Gerd Naschenweng&lt;/a&gt; and can be found &lt;a href=&#34;https://github.com/magicdude4eva/docker-smokeping&#34;&gt;here&lt;/a&gt;. It provides a docker instance but also has a very good set of configuration files to build examples from. Don’t discount latency data - it’s a powerful set of information for any working network. For anyone interested in seeing a working smokeping installation, mine is public and available to view. It provides a few things such as DNS latency, RTT for v4 and v6, RTT for ZeroTier hosts and RIPE ATLAS probes, etc. It’s a powerful toolkit. My public cloud instance is hosted at &lt;a href=&#34;http://www.prgmr.com&#34;&gt;prgmr.com&lt;/a&gt; and can be found &lt;a href=&#34;https://watcher.forwardingplane.net/smokeping/smokeping.cgi&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>DNS - the treasure trove of information your ISP can see</title>
      <link>https://forwardingplane.net/post/dns-the-treasure-trove-of-information-your-isp-can-see/</link>
      <pubDate>Mon, 10 Dec 2018 10:23:42 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/dns-the-treasure-trove-of-information-your-isp-can-see/</guid>
      <description>&lt;p&gt;In recent years, the nature of &lt;a href=&#34;http://fortune.com/2017/11/23/net-neutrality-explained-what-it-means-and-why-it-matters/&#34;&gt;privacy on the internet&lt;/a&gt; has become a very important topic amongst those concerned with the now lack of &lt;a href=&#34;https://www.theverge.com/2017/12/14/16776154/fcc-net-neutrality-vote-results-rules-repealed&#34;&gt;net neutrality&lt;/a&gt;. The de-facto mechanism for dealing with privacy has been to &amp;ldquo;&lt;a href=&#34;https://letsencrypt.org/&#34;&gt;SSL all the things&lt;/a&gt;&amp;rdquo;, which I am very much in favor of. What many do not realize, though, is that simply using SSL for the traffic that transits a given ISP still leaves a wealth of thick, rich, delicious personal data still easily available to your ISP to harvest, sell, and do with as they please. This data comes in the form of DNS queries. DNS is the nearly-always-forgotten, crucial aspect of how the internet functions. Without DNS, nothing works. Everything appears broken and manifest as what appears to be a networking problem. ISPs typically provide what is called a &lt;a href=&#34;https://umbrella.cisco.com/blog/2014/07/16/difference-authoritative-recursive-dns-nameservers/&#34;&gt;recursive resolver&lt;/a&gt;, which for most people is handed down by a local provider to the customer premise equipment (CPE; usually a modem or optical terminal of some kind) that they install at a residence. This CPE then hands that resolver to your clients that use it to - you guessed it - recursively resolve DNS queries. These queries can be logged and then mined for browsing habits, etc. Anyone that has ever done any network forensics will know straight away that the value of the information contained in DNS query logs is very, very high. &lt;/p&gt;

&lt;p&gt;What this means is that even though a privacy conscious individual is hiding the bulk of their content in SSL, meaning the bulk of what they’re reading, searching for, and doing, is encrypted, the requests for that content or activity is not. For example, an ISP can potentially see that a client is making many, many queries for $onlineshopping.com and begin selling that data to advertisers. If you think they’re not doing this now, &lt;a href=&#34;https://www.wired.com/story/can-verizon-build-a-strong-brand-from-the-bones-of-yahoo-and-aol/&#34;&gt;think again&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;Great, so $bigbadprovider can see your queries. There are a number of pretty good ways to work around this, and &lt;a href=&#34;https://pi-hole.net/&#34;&gt;one of my favorite projects&lt;/a&gt; handily deals with one of them with great simplicity. What I am referring to is the newly popular &lt;a href=&#34;https://scotthelme.co.uk/securing-dns-across-all-of-my-devices-with-pihole-dns-over-https-1-1-1-1/&#34;&gt;DNS over HTTPS&lt;/a&gt;, which is supported by the &lt;a href=&#34;https://one.one.one.one/&#34;&gt;cloudflare 1.1.1.1 service&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;So, as a thought experiment I decided to play Reeses Peanut butter and chocolate with two of my favorite technological creations: the aforementioned PiHole, and &lt;a href=&#34;https://zerotier.com/&#34;&gt;ZeroTier&lt;/a&gt;. Now anyone that isn’t familiar with ZeroTier, you should acquaint yourself - Packet Pushers did a good &lt;a href=&#34;https://packetpushers.net/podcast/pq-134-meet-zerotier-open-source-networking/&#34;&gt;podcast on it back in November of 2017&lt;/a&gt;. It’s functionally an encrypted overlay supporting dual stack networking with auto configuration and gateway capabilities, and it runs on almost everything. I love this overlay technology and have been using it for a while - highly recommended.&lt;/p&gt;

&lt;p&gt;Back to my peanut butter and chocolate experiment. So, given that I had an existing ZeroTier network and an existing PiHole setup at home, I went over to &lt;a href=&#34;https://www.vultr.com/?ref=7692870&#34;&gt;Vultr.com&lt;/a&gt; and spun up a small VM for $3.50/mo, integrated it into my fleet with my Ansible and Salt tools, and installed ZeroTier and Pihole. From there I set up this DNS hierarchy. &lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://docs.google.com/drawings/d/e/2PACX-1vS-DsmzNWvE335KZtNo6AHX3SySG-VQWhK7i9sNgT6mFMHC5VzRWtMuJg5JraU2dJTFQT4QIGnfaMFP/pub?w=960&amp;amp;h=720&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;What this buys me is a fully encrypted DNS path up through the Vultr.com VM host without modifying the underlying DNS transport. And it works surprisingly well. I ran SmokePing from two hosts - both leveraging ZeroTier to do their testing, one on my local network and one in the cloud - to measure latency for a few days before I did this and kept that running after the deployment. Now, it’s not perfect but my family and I have been using this for about a month with minimal issues. Once in a great while we’ll see some slow DNS resolution time, but overall it works fairly well. &lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://www.forwardingplane.net/wp-content/uploads/2018/12/Resolver-Queries.png&#34; alt=&#34;Resolver Queries&#34; title=&#34;Resolver Queries.png&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;My take &lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;The idea of using a public resolver kinda bothers me, I realize it’s probably unfounded, but I know how to and have run resolvers for ISPs and organizations for like 20 years, so I have the burden of knowledge about what is in the logs and how to run my own. Using a secured recursive resolver is simply trading transit privacy for lack of query privacy somewhere else. Then there is the issue of content networks that use DNS queries to take you to the best / topologically closest cache of their content [NOTE: this, along with the forensics data for debugging potential security issues is a &lt;strong&gt;top&lt;/strong&gt; reason that all ISPs should run their own resolvers]. I fully realize that a normal end user running their own resolver is unlikely and that this deployment is a bit overkill. However, as I can demonstrably prove, it works. And it works pretty well. It also has the added bonus of allowing me to have internal DNS resolution of my own hosts and any mobile ZeroTier client. Is it for everyone? No way. Does it prove viability for low/medium traffic use? Sure. The point is really just to get folks thinking about information leaking that they may not have considered. The nature of the internet makes true privacy pretty much impossible, but there are a few ways to make your data a little harder to for companies to compile and capitalize on if you truly don’t want them to.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Creating an internal span port inside proxmox OVS</title>
      <link>https://forwardingplane.net/post/creating-internal-span-port-inside-proxmox-ovs/</link>
      <pubDate>Tue, 21 Mar 2017 03:49:58 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/creating-internal-span-port-inside-proxmox-ovs/</guid>
      <description>&lt;p&gt;In the last few years I have moved all of my virtualization to &lt;a href=&#34;https://www.proxmox.com/en/&#34;&gt;proxmox&lt;/a&gt; and docker. Seeing as I like to look at packets because I am a closet security guy, and being as I have been working off-and-on on a security project in recent times, I wanted to be able to span a port not only from a hardware switch, but also within my software switches. I had been using linux bridge, which I am not a fan of, so when I started down this path I did not look hard to find a way to do so under that platform. Instead I used it as an opportunity to move some of the internal bridges to &lt;a href=&#34;http://openvswitch.org/&#34;&gt;OpenVSwitch&lt;/a&gt;. I wanted to create an OVS span port internally. I had experience with OVS in the past for SDN work that I was doing, but I had never created a mirror port. I briefly thought about using OpenFlow to do it, but the unnecessary complexity was off putting. Instead I chose to create a simple mirror of a span port from my switch. So, traffic flow goes as such: &lt;a href=&#34;http://www.forwardingplane.net/wp-content/uploads/2017/03/OVS-SPAN-1.png&#34;&gt;&lt;img src=&#34;http://www.forwardingplane.net/wp-content/uploads/2017/03/OVS-SPAN-1.png&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;     This was fairly trivial, and I was seeing packets in no time. I&amp;rsquo;m not going to go through creating an OVS bridge in proxmox, there are lots of &lt;a href=&#34;https://pve.proxmox.com/wiki/Open_vSwitch&#34;&gt;documents&lt;/a&gt; on how to do that. Once you have your switch port SPAN up and running, and the physical interface in the OVS bridge, you essentially just need to add the following: Create the mirror```
ovs-vsctl &amp;ndash; &amp;ndash;id=@m create mirror name=span &amp;ndash; add bridge vmbr1 mirrors @m&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Find your ports that you want to mirror - you&#39;ll need the physical port if consuming from a real switch like I am, and the software port of the virtualized analyzer.  Remember, in OVS anything you want to mess with is going to have a UUID. You need to match the interfaces with the UUID to verify. ovs-vsctl list port \_uuid : 42dbd5a9-27c6-4f1b-958b-943f67b6801b bond\_downdelay : 0 bond\_fake\_iface : false bond\_mode : \[\] bond\_updelay : 0 external\_ids : {} fake\_bridge : false interfaces : \[b155454d-db6e-4bb8-af88-7cd6b544c303\] lacp : \[\] mac : \[\] name : &#34;eth1&#34; other\_config : {} qos : \[\] statistics : {} status : {} tag : \[\] trunks : \[\] vlan\_mode : \[\] \_uuid : 85c932b2-4f98-4650-8298-ae9e9ca72796 bond\_downdelay : 0 bond\_fake\_iface : false bond\_mode : \[\] bond\_updelay : 0 external\_ids : {} fake\_bridge : false interfaces : \[5219306f-96ec-440a-ac8b-d949ea18d752\] lacp : \[\] mac : \[\] name : &#34;vmbr1&#34; other\_config : {} qos : \[\] statistics : {} status : {} tag : \[\] trunks : \[\] vlan\_mode : \[\] \_uuid : d53c7323-517f-48a2-9235-4505e654d4b1 bond\_downdelay : 0 bond\_fake\_iface : false bond\_mode : \[\] bond\_updelay : 0 external\_ids : {} fake\_bridge : false interfaces : \[91d52d05-d881-4693-ab5c-fc64b5d87518\] lacp : \[\] mac : \[\] name : &#34;veth100i9&#34; other\_config : {} qos : \[\] statistics : {} status : {} tag : \[\] trunks : \[\] vlan\_mode : \[\] In red we have the interfaces I want to to use. the veth interface is the software port on the VM. Eth1 is the hardware interfce that my switch is spanning traffic to. Pro tip: In OVS, the commands are a little unintuitive to me when talking about mirrors.  &#34;select\_src\_port&#34; and &#34;select\_dst\_port=&#34; is the destination of the traffic flow from an interface and not source and destination of the traffic you are mirroring from the point of view of the in and out ports. Confusing, right? For instance I can monitor the input from one interface and the output of another in the mirror. What we want is the input and output of the same interface to get both directions of traffic. This is not unlike how span ports are configured on your hardware switch, the nomenclature just threw me off.```&#34; data-lang=&#34;Find your ports that you want to mirror - you&#39;ll need the physical port if consuming from a real switch like I am, and the software port of the virtualized analyzer.  Remember, in OVS anything you want to mess with is going to have a UUID. You need to match the interfaces with the UUID to verify. ovs-vsctl list port \_uuid : 42dbd5a9-27c6-4f1b-958b-943f67b6801b bond\_downdelay : 0 bond\_fake\_iface : false bond\_mode : \[\] bond\_updelay : 0 external\_ids : {} fake\_bridge : false interfaces : \[b155454d-db6e-4bb8-af88-7cd6b544c303\] lacp : \[\] mac : \[\] name : &#34;eth1&#34; other\_config : {} qos : \[\] statistics : {} status : {} tag : \[\] trunks : \[\] vlan\_mode : \[\] \_uuid : 85c932b2-4f98-4650-8298-ae9e9ca72796 bond\_downdelay : 0 bond\_fake\_iface : false bond\_mode : \[\] bond\_updelay : 0 external\_ids : {} fake\_bridge : false interfaces : \[5219306f-96ec-440a-ac8b-d949ea18d752\] lacp : \[\] mac : \[\] name : &#34;vmbr1&#34; other\_config : {} qos : \[\] statistics : {} status : {} tag : \[\] trunks : \[\] vlan\_mode : \[\] \_uuid : d53c7323-517f-48a2-9235-4505e654d4b1 bond\_downdelay : 0 bond\_fake\_iface : false bond\_mode : \[\] bond\_updelay : 0 external\_ids : {} fake\_bridge : false interfaces : \[91d52d05-d881-4693-ab5c-fc64b5d87518\] lacp : \[\] mac : \[\] name : &#34;veth100i9&#34; other\_config : {} qos : \[\] statistics : {} status : {} tag : \[\] trunks : \[\] vlan\_mode : \[\] In red we have the interfaces I want to to use. the veth interface is the software port on the VM. Eth1 is the hardware interfce that my switch is spanning traffic to. Pro tip: In OVS, the commands are a little unintuitive to me when talking about mirrors.  &#34;select\_src\_port&#34; and &#34;select\_dst\_port=&#34; is the destination of the traffic flow from an interface and not source and destination of the traffic you are mirroring from the point of view of the in and out ports. Confusing, right? For instance I can monitor the input from one interface and the output of another in the mirror. What we want is the input and output of the same interface to get both directions of traffic. This is not unlike how span ports are configured on your hardware switch, the nomenclature just threw me off.```&#34;&gt;ovs-vsctl set mirror span select\_src\_port=@eth1 select\_dst\_port=@eth1&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You can also do this with the UUID```
ovs-vsctl set mirror span select_src_port=42dbd5a9-27c6-4f1b-958b-943f67b6801b select_dst_port=42dbd5a9-27c6-4f1b-958b-943f67b6801b&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Now that we have the source of our mirror we just need to send it somewhere. I wanted mine to go to an internal host running some analytics software (on interface veth100i9)```&#34; data-lang=&#34;Now that we have the source of our mirror we just need to send it somewhere. I wanted mine to go to an internal host running some analytics software (on interface veth100i9)```&#34;&gt;ovs-vsctl -- --id=@veth100i9 get port veth100i9 -- set mirror span output-port=@veth100i9&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And that&amp;rsquo;s it. Log into your host and do a tcpdump on whatever interface is mapped to veth100i9 and you should see packets flowing. A few tips:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Verify your span from the hardware switch is working before diving into the software stack.&lt;/li&gt;
&lt;li&gt;If you&amp;rsquo;re doing this is proxmox, be aware that proxmox networking stack can be unforgiving when you much around outside of their environment.&lt;/li&gt;
&lt;li&gt;This will not persist across reboots. Add it to /etc/network/interfaces manually to keep it after a restart.&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>NIX4NetEng 6 DNS, ad-blocking, and quality of experience</title>
      <link>https://forwardingplane.net/post/nix4neteng-6-dns-ad-blocking-and-quality-of-experience/</link>
      <pubDate>Sat, 27 Feb 2016 16:40:04 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/nix4neteng-6-dns-ad-blocking-and-quality-of-experience/</guid>
      <description>

&lt;p&gt;The sixth [and arguably very overdue] installment of my &lt;a href=&#34;https://www.forwardingplane.net/?s=nix4neteng&#34;&gt;NIX4NetEng&lt;/a&gt; series, this began as an overly complex diatribe about &lt;a href=&#34;https://en.wikipedia.org/wiki/Domain_Name_System&#34;&gt;DNS&lt;/a&gt;. As it evolved, I realized that DNS is so complex and far reaching that it could never be contained in one meager post. DNS is a powerful tool. It has existed for so long that many that have never had the responsibility of running an authoritative or recursive resolver may take for granted the extensive reach of a tool so engrained in the fabric of the internet that it is frequently overlooked, much like a utility such as electricity or running water. Over time DNS has been reviled as the weak link in the chain that is the internet and and revered as the binding agent that makes the internet as we know it function. As someone that has run service provider and large campus resolvers, both recursive and authoritative, my opinion is that it is both. In the old days, and even now, black hat players will often target resolvers to perform DNS poisioning and will employ techniques such as flux and double flux to obfuscate their bot herders. Content providers use DNS tricks and anycast DNS to steer eyeballs to the topologically closest resource. Wifi hotspots use DNS to capture and force users through a captive portal. As users at large surf the web, advertisers utilize DNS to deliver advertising. Google does this, Yahoo does it, Hulu and other streaming video services do it. It has also been known to deliver pretty nasty &lt;a href=&#34;https://en.wikipedia.org/wiki/Malvertising&#34;&gt;malware&lt;/a&gt;. That&amp;rsquo;s why when internet and security ninja &lt;a href=&#34;http://blog.samoehlert.com/&#34;&gt;Sam Oehlert&lt;/a&gt; pointed me at this project called &lt;a href=&#34;https://pi-hole.net/&#34;&gt;pi-hole&lt;/a&gt;, I knew that it would be a blog post. Pi-Hole is a recursive resolver based on the venerable &lt;a href=&#34;http://www.thekelleys.org.uk/dnsmasq/doc.html&#34;&gt;dnsmasq&lt;/a&gt; that actively blocks and logs ads. And it WORKS. The initial project was aimed at running this on a raspberry pi as a hardware based resolver for a small network. While this works well, it&amp;rsquo;s really just a linux service that can be run as a &lt;a href=&#34;https://hub.docker.com/r/diginc/pi-hole/&#34;&gt;docker container&lt;/a&gt; or a standard LXC container. I decided to set this up as a linux container on my &lt;a href=&#34;https://www.proxmox.com/en/&#34;&gt;proxmox&lt;/a&gt; box. The install is as simple as running a single command and walking through some simple menus.&lt;/p&gt;

&lt;h2 id=&#34;curl-l-install-pi-hole-net-bash&#34;&gt;curl -L install.pi-hole.net | bash&lt;/h2&gt;

&lt;p&gt;The install is straightforward and allows for both IPv4 &lt;strong&gt;and&lt;/strong&gt; IPv6 ad blocking, should your network support it (which is should!). Like any self funded opensource project, I have found a few caveats and hidden features with it:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Scaling the web interface for a network that performs significant numbers of queries is hard. It seems to have a difficult time displaying from large log files. Perhaps they&amp;rsquo;ll add something like a sqlite db to make this faster, the web interface seems to be updated frequently.&lt;/li&gt;
&lt;li&gt;It&amp;rsquo;s based on dnsmasq, so adding local hostnames for within your network is a trivial as adding them to the /etc/hosts file on the pihole device. I personally don not like to type IP addresses and my network has been dial stacked with IPv6 for more than a decade, so local DNS resolution is a requirement. I&amp;rsquo;m not memorizing v6 addresses.&lt;/li&gt;
&lt;li&gt;Again, it&amp;rsquo;s based on dnsmasq, so the flexibility and features are pretty significant and are as simple as tweaking the config file once it&amp;rsquo;s installed.&lt;/li&gt;

&lt;li&gt;&lt;p&gt;The query log is available. Security professionals are always interested in DNS query logs - they provide a monumental amount of useful information. With pihole, you have access to that in /etc/log/pihole.log. Here is a snippit of the log&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Feb 27 16:28:04 dnsmasq\[7620\]: /etc/pihole/gravity.list s.youtube.com is 10.209.209.10
Feb 27 16:28:04 dnsmasq\[7620\]: query\[AAAA\] pubads.g.doubleclick.net from 10.209.89.21
Feb 27 16:28:04 dnsmasq\[7620\]: /etc/pihole/gravity.list pubads.g.doubleclick.net is 2001:470:c03a:809::a
Feb 27 16:28:04 dnsmasq\[7620\]: query\[A\] pubads.g.doubleclick.net from 10.209.89.21
Feb 27 16:28:04 dnsmasq\[7620\]: /etc/pihole/gravity.list pubads.g.doubleclick.net is 10.209.209.10
Feb 27 16:28:04 dnsmasq\[7620\]: query\[A\] r2---sn-vgqs7nls.googlevideo.com from 10.209.89.21
Feb 27 16:28:04 dnsmasq\[7620\]: forwarded r2---sn-vgqs7nls.googlevideo.com to 75.75.76.76
Feb 27 16:28:04 dnsmasq\[7620\]: query\[AAAA\] r2---sn-vgqs7nls.googlevideo.com from 10.209.89.21
Feb 27 16:28:04 dnsmasq\[7620\]: forwarded r2---sn-vgqs7nls.googlevideo.com to 75.75.76.76
Feb 27 16:28:04 dnsmasq\[7620\]: query\[AAAA\] manifest.googlevideo.com from 10.209.89.21
Feb 27 16:28:04 dnsmasq\[7620\]: forwarded manifest.googlevideo.com to 75.75.76.76
Feb 27 16:28:04 dnsmasq\[7620\]: query\[A\] manifest.googlevideo.com from 10.209.89.21
Feb 27 16:28:04 dnsmasq\[7620\]: forwarded manifest.googlevideo.com to 75.75.76.76
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;It&amp;rsquo;s easy to add or remove ad domains. Just edit /etc/pihole/gravity.list&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;  &lt;a href=&#34;https://vimeo.com/135965232&#34;&gt;Pi-hole Explained&lt;/a&gt; from &lt;a href=&#34;https://vimeo.com/user40849716&#34;&gt;Pi-hole&lt;/a&gt; on &lt;a href=&#34;https://vimeo.com&#34;&gt;Vimeo&lt;/a&gt;.   Completely ignoring the merit or unethical nature of blocking revenue generating advertisements (which I personally make a small amount of money on from on my &lt;a href=&#34;https://www.youtube.com/buraglio&#34;&gt;youtube channel&lt;/a&gt;), this is a recommended project that exposes networking folks to unix, critical network services, as well as security. &lt;a href=&#34;https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&amp;amp;hosted_button_id=3J2L3Z4DHW9UY&#34;&gt;Throw them some beer or coffee money&lt;/a&gt; if you find it useful. They&amp;rsquo;ve earned it.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Monitoring VMware ESXi with SNMP and Cacti</title>
      <link>https://forwardingplane.net/post/monitoring-vmware-esxi-with-snmp-and-cacti/</link>
      <pubDate>Mon, 19 Jan 2015 10:02:10 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/monitoring-vmware-esxi-with-snmp-and-cacti/</guid>
      <description>&lt;p&gt;VMWare is a powerful tool, and monitoring is a critical service. How does one monitor such an integral piece of infrastructure, and what do they monitor it with? There are powerful commercial ways of monitoring &lt;a href=&#34;http://www.vmware.com/&#34;&gt;VMware&lt;/a&gt;, however, for those with existing &lt;a href=&#34;http://en.wikipedia.org/wiki/Simple_Network_Management_Protocol&#34;&gt;SNMP&lt;/a&gt; based systems in place, specifically &lt;a href=&#34;http://www.cacti.net/&#34;&gt;cacti&lt;/a&gt;, there are options. To that end, I&amp;rsquo;ll set aside my strong distaste for SNMP [yet again], because those are for a larger, less useful series of posts.&lt;/p&gt;

&lt;p&gt;Luckily for those of us that need it there exists in that vast wilderness we call the internet, a user contributed &lt;a href=&#34;http://www.cacti.net/&#34;&gt;cacti&lt;/a&gt; template for monitoring basic functionality with SNMP and cacti and it is available &lt;a href=&#34;http://forums.cacti.net/download/file.php?id=29171&amp;amp;sid=888e5451bc68b1c05a5b7dec6667afd2&#34;&gt;here&lt;/a&gt;, and with the full thread being worth a read &lt;a href=&#34;http://forums.cacti.net/viewtopic.php?f=12&amp;amp;t=52122&#34;&gt;here&lt;/a&gt;. Since VMWare ESXi doesn&amp;rsquo;t have SNMP enabled (or really exposed from what I can tell), you have to do some CLI jockeying to make it work. Full disclosure, I&amp;rsquo;m not a vmware expert by any stretch of the imagination, but I have been hacking at it for a few years because it is low overhead to use comparatively speaking, offers a free version for my lab, makes a nice contrast to my KVM system and is widely deployed, so I want to understand it. Your mileage may vary with what I&amp;rsquo;ve got here.&lt;/p&gt;

&lt;p&gt;Enabling ssh is beyond the scope of this post but details can be found &lt;a href=&#34;http://www.thomasmaurer.ch/2014/01/enable-ssh-on-vmware-esxi-5-5/&#34;&gt;here&lt;/a&gt;. It&amp;rsquo;s fairly straightforward.&lt;a href=&#34;http://www.forwardingplane.net/wp-content/uploads/2015/01/vmware-snmp-device.png&#34;&gt;&lt;img src=&#34;http://www.forwardingplane.net/wp-content/uploads/2015/01/vmware-snmp-device.png&#34; alt=&#34;vmware-snmp-device&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Details of enabling SNMP for vmware 5.5 can be found &lt;a href=&#34;https://pubs.vmware.com/vsphere-51/index.jsp#com.vmware.vsphere.monitoring.doc/GUID-0EB48A32-34B0-4003-B2D0-ADE3BAFD29F0.html&#34;&gt;here&lt;/a&gt;, essentially one simply needs to run the following commands from within an ssh session:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;esxcli  system snmp set --communities &amp;lt;community&amp;gt;
esxcli system snmp set --port 161
esxcli system snmp set --enable true
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Getting the cacti scripts in place is a little more involved, but it&amp;rsquo;s still pretty simple. Using the importer just add the new template. &lt;a href=&#34;http://www.forwardingplane.net/wp-content/uploads/2015/01/Screenshot-2015-01-10-10.09.09.png&#34;&gt;&lt;img src=&#34;http://www.forwardingplane.net/wp-content/uploads/2015/01/Screenshot-2015-01-10-10.09.09.png&#34; alt=&#34;Screenshot 2015-01-10 10.09.09&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt; Once that is imported you&amp;rsquo;ll need to move some scripts into place within the cacti system as below (adjust your paths as needed; I moved them directly from my workstation into place)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;scp ss\_esxi\_vhosts.php netmon:/var/lib/cacti/scripts/
scp cacte\_esxi\_template/resource/snmp\_queries/\* netmon:/usr/share/cacti/resource/snmp\_queries/
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;[](&lt;a href=&#34;http://www.forwardingplane.net/wp-content/uploads/2015/01/Screenshot-2015-01-10-10.10.43.png)[![](http://www.forwardingplane.net/wp-content/uploads/2015/01/vmware-snmp-device.png)](http://www.forwardingplane.net/wp-content/uploads/2015/01/vmware-snmp-device.png&#34;&gt;http://www.forwardingplane.net/wp-content/uploads/2015/01/Screenshot-2015-01-10-10.10.43.png)[![](http://www.forwardingplane.net/wp-content/uploads/2015/01/vmware-snmp-device.png)](http://www.forwardingplane.net/wp-content/uploads/2015/01/vmware-snmp-device.png&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;[](&lt;a href=&#34;http://www.forwardingplane.net/wp-content/uploads/2015/01/Screenshot-2015-01-10-10.13.33.png&#34;&gt;http://www.forwardingplane.net/wp-content/uploads/2015/01/Screenshot-2015-01-10-10.13.33.png&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;Then adjust the template being used for your ESXi server or add it as a new host if it was not there already. The new template should show up in the list.&lt;/p&gt;

&lt;p&gt;Once complete the cacti server should start graphing and checking uptime, etc. IF it does not, make sure the scripts are in place and have the correct permissions. It&amp;rsquo;s also useful (although not required) to add the additional parameters to the host.&lt;/p&gt;

&lt;p&gt;Once complete, the cacti system should be able to baseline (and alert if so desited, using thresholds) on any of the newly added variables, including number of VMs, number of VMs using vmware tools, number of VMs running, disk space, processes, network traffic, etc.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://www.forwardingplane.net/wp-content/uploads/2015/01/vmware-create-graphs.png&#34; alt=&#34;vmware-create-graphs&#34; /&gt;  &lt;/p&gt;

&lt;p&gt;I have yet to be able to get successful CPU graphs, but I suspect it is user error on my part and I&amp;rsquo;ve not investigated yet. Overall, I&amp;rsquo;d call it a pretty bigwin for anyone that has an existing cacti installation and wants to include their vmware system(s). It should also be said that the readme that accompanies the template is relatively useful.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>NIX4NetEng 5 - GeoIP tools</title>
      <link>https://forwardingplane.net/post/nix4neteng-5-geoip-tools/</link>
      <pubDate>Sun, 21 Dec 2014 18:22:15 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/nix4neteng-5-geoip-tools/</guid>
      <description>&lt;p&gt;Sometimes in networking and security it becomes necessary to do lookups of location data on IP addresses and prefixes. On my Mac I use &lt;a href=&#34;http://brew.sh/&#34;&gt;homebrew&lt;/a&gt; to manage packages, but most of these tools are available with thetypocal apt, yum and port package management systems. For this post, I&amp;rsquo;m going to shift gears and show the install on my mac:```
sliver:~ buraglio$ brew install geoip
==&amp;gt; Downloading &lt;a href=&#34;https://downloads.sf.net/project/machomebrew/Bottles/geoip-1.6.3.mavericks.bottle.tar.gz&#34;&gt;https://downloads.sf.net/project/machomebrew/Bottles/geoip-1.6.3.mavericks.bottle.tar.gz&lt;/a&gt;
######################################################################## 100.0%
==&amp;gt; Pouring geoip-1.6.3.mavericks.bottle.tar.gz
sliver:~ buraglio$ brew install geoipupdate
==&amp;gt; Downloading &lt;a href=&#34;https://downloads.sf.net/project/machomebrew/Bottles/geoipupdate-2.0.2.mavericks.bottle.tar.gz&#34;&gt;https://downloads.sf.net/project/machomebrew/Bottles/geoipupdate-2.0.2.mavericks.bottle.tar.gz&lt;/a&gt;
######################################################################## 100.0%
==&amp;gt; Pouring geoipupdate-2.0.2.mavericks.bottle.tar.gz&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Once this installed we need to do a simple update:```&#34; data-lang=&#34;Once this installed we need to do a simple update:```&#34;&gt;sliver:~ buraglio$ geoipupdate
sliver:~ buraglio$&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This really doesn&amp;rsquo;t yield any output, but I tend to do it pretty much every time I am using the tool so I know I have up to date information. So lets say that you are a service provider and your customers are calling complaining that they&amp;rsquo;re seeing www.weather.co.uk when going to weather.com or more realistically, they can&amp;rsquo;t get to netflix or amazon video, which tells them they don&amp;rsquo;t support srtreaming to the UK.```
sliver:~ buraglio$ geoiplookup 141.142.2.2
GeoIP Country Edition: US, United States
GeoIP City Edition, Rev 1: US, IL, Illinois, Urbana, 61801, 40.109501, -88.212303, 648, 217&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Nope, that looks ok, it must be something else \[I have actually seen this problem in the past, it&#39;s really no fun to run to ground\]. As you can see, there is a good deal of information there, lat/long, area code, city, state, zip, etc. This data, specifically the lat/long, can be used to do really cool visualization stuff with things like google maps or google earth. As a sanity check, here is a view of bbc.com:```&#34; data-lang=&#34;Nope, that looks ok, it must be something else \[I have actually seen this problem in the past, it&#39;s really no fun to run to ground\]. As you can see, there is a good deal of information there, lat/long, area code, city, state, zip, etc. This data, specifically the lat/long, can be used to do really cool visualization stuff with things like google maps or google earth. As a sanity check, here is a view of bbc.com:```&#34;&gt;sliver:~ buraglio$ geoiplookup 212.58.244.71
GeoIP Country Edition: GB, United Kingdom
GeoIP City Edition, Rev 1: GB, N7, Surrey, Tadworth, N/A, 51.283298, -0.233300, 0, 0&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Yup, that looks right. The nice thing about this tool is that it can be automated to do all kinds of things with logs from syslog, Bro-IDS, Snort, whatever, and then act on the data or like I mentioned above, plot it out for visualization. The one drawback I&amp;rsquo;ve found is that the IPv6 lookups are sparsely correct, for example:&lt;code&gt;
sliver:~ buraglio$ geoiplookup6 2400:cb00:2048:1::681c:194f
sliver:~ buraglio$
&lt;/code&gt;Looking up 2400:cb00:2048:1::681c:194f which belongs to cloudflare yields me nothink, so there is some work to do there on the IPv6 front. Overall this is a useful tool for quick troubleshooting but it really shines when used in scripts and for visualization.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>NIX4Neteng 4: POODLE and SSLv3, scanning and updating</title>
      <link>https://forwardingplane.net/post/nix4neteng-4-poodle-and-sslv3-scanning-and-updating/</link>
      <pubDate>Wed, 15 Oct 2014 17:36:54 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/nix4neteng-4-poodle-and-sslv3-scanning-and-updating/</guid>
      <description>&lt;p&gt;With the recent release of the &lt;a href=&#34;https://www.openssl.org/~bodo/ssl-poodle.pdf&#34;&gt;POODLE SSLv3 vulnerability&lt;/a&gt;, folks are scrambling around trying to figure out what runs what and where.  Running a handful of things that do SSL, I was obligated, both personally and professionally, to figure out an easy way to drill down and figure out what does what and then fix the vulnerable services.  When there are a lot of devices, this can seem like a daunting task, and it is if you&amp;rsquo;re trying to do it manually.  This is where &lt;a href=&#34;http://nmap.org/&#34;&gt;NMAP&lt;/a&gt; comes into play.  NMAP is an extremely powerful tool for scanning and enumerating your own network, not just a tool for the script kiddies to port scan. Since there is no SSL patch at the time of this writing, and since SSLv3 is old and depricated, it is a good idea to see what services support it and then squish them in favor of TLS 1+.  Thankfully, smarter folks than myself have done most of the legwork for accomplishing this task and written most of it down &lt;a href=&#34;http://nmap.org/nsedoc/scripts/ssl-enum-ciphers.html&#34;&gt;here&lt;/a&gt;. NMAP has a wealth of cool scripts and bolt ons that extend it in amazing ways.  To accomplish our tasks we&amp;rsquo;ll ned to do a few things. Install nmap. I ran into issues with the &lt;a href=&#34;http://nmap.org/book/nse-library.html&#34;&gt;nselibs&lt;/a&gt; being incomplete, so I grabbed the source and built it that way as opposed to using yum.```
git clone git@github.com:nmap/nmap.git&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-We then need to build it from source which requires the dev tools:```&#34; data-lang=&#34;We then need to build it from source which requires the dev tools:```&#34;&gt;sudo yum -y groupinstall &amp;#39;Development Tools&amp;#39;
cd nmap
./configure
sudo make&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and alternatively```
sudo make install&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-I like to just run it from my directory since there are path considerations.```&#34; data-lang=&#34;I like to just run it from my directory since there are path considerations.```&#34;&gt;(~/nmap) v-chimera $ ./nmap --script ssl-enum-ciphers -p 443 10.14.14.0/27

Starting Nmap 6.46 ( http://nmap.org ) at 2014-10-15 12:21 CDT
Nmap scan report for gw.test (10.14.14.1)
Host is up (0.0028s latency).
PORT    STATE  SERVICE
443/tcp closed https

Nmap scan report for ssldevice.test (10.14.14.2)
Host is up (0.0042s latency).
PORT    STATE SERVICE
443/tcp open  https
| ssl-enum-ciphers:
|   SSLv3:
|     ciphers:
|       TLS\_RSA\_WITH\_RC4\_128\_MD5 - strong
|       TLS\_RSA\_WITH\_RC4\_128\_SHA - strong
|     compressors:
|       NULL
|   TLSv1.0:
|     ciphers:
|       TLS\_RSA\_WITH\_RC4\_128\_MD5 - strong
|       TLS\_RSA\_WITH\_RC4\_128\_SHA - strong
|     compressors:
|       NULL
|\_  least strength: strong

Nmap scan report for nossl.test (10.14.14.3)
Host is up (0.00049s latency).
PORT    STATE  SERVICE
443/tcp closed https&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;From here we can see that there is a host that needs to be updated. There are a wealth of docs out there for changing out the supported version. Most of my stuff is apache so I used &lt;a href=&#34;https://zmap.io/sslv3/&#34;&gt;this guide&lt;/a&gt;. For embedded devices, the best option is to filter access [which you should probably be doing anyway] until there is a patched firmware version.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>sonrancid: A [very] basic RANCID module for sonicwall</title>
      <link>https://forwardingplane.net/post/sonrancid-a-very-basic-rancid-module-for-sonicwall/</link>
      <pubDate>Mon, 15 Sep 2014 09:05:13 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/sonrancid-a-very-basic-rancid-module-for-sonicwall/</guid>
      <description>&lt;p&gt;I know, I know, I&amp;rsquo;m always saying that you don&amp;rsquo;t need a firewall. That&amp;rsquo;s mostly to get your attention to push my agenda of sane security architecture, I do actually believe that firewalls are appropriate in a great many use cases and I&amp;rsquo;ve managed them big and small ranging from &lt;a href=&#34;http://www.forwardingplane.net/2010/08/juniper-srx-cluster/&#34; title=&#34;Juniper SRX Cluster&#34;&gt;Juniper SRX 5800 clusters&lt;/a&gt; to tiny purpose built BSD distros on custom hardware. I even managed &lt;a href=&#34;http://www.checkpoint.com/&#34;&gt;Checkpoint&lt;/a&gt; and &lt;a href=&#34;http://www.kulichki.com/moshkow/SECURITY/gauntlet.txt&#34;&gt;gauntlet firewall&lt;/a&gt; back in the 1990s. And &lt;a href=&#34;https://www.novell.com/products/bordermanager/&#34;&gt;Novell Border manager&lt;/a&gt;&amp;hellip;.good gravy&amp;hellip;.border manager. I just had a chill, that thing is still around.  They work well when spec&amp;rsquo;d, designed, maintained correctly and placed in an appropriate location in a network architecture.  That said, I have a few SonicWall devices that I work on occasionally and it has always irritated me that there was not a usable &lt;a href=&#34;http://www.shrubbery.net/rancid/&#34;&gt;RANCID&lt;/a&gt; module for it.  To that end, I hacked up the Cisco RANCID script to support very rudimentary config backups. &lt;em&gt;&lt;Insert comment about having some DevOps skills is useful, even if they are very basic like mine.&gt;&lt;/em&gt; The script will log in and pull the config and version using the following commands:&lt;code&gt;
show current-config
&lt;/code&gt;&lt;code&gt;
show version
&lt;/code&gt;I am really hoping that someone else will pick it up and massage it a bit because it is very chatty and will produce a diff every time due to the way SonicOS presents some of its configuration parameters. It also needs tested against larger SonicWall devices as I only have smaller boxes to run against.  I know it works against a TZ210, YMMV. Please post comments on github if you use it with anything else.   The password hash is particularly annoying, it always changes when the configuration is displayed. Some of the framework is there to remove it so I may hack at it a bit more but it&amp;rsquo;s usable in the loosest sense for the short term.  It&amp;rsquo;s available on &lt;a href=&#34;https://github.com/buraglio/sonrancid&#34;&gt;my github site&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>NIX4NetEng 3: IP Addressing and Subnet Tools</title>
      <link>https://forwardingplane.net/post/nix4neteng-3-ip-addressing-and-subnet-tools/</link>
      <pubDate>Sat, 26 Jul 2014 16:46:07 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/nix4neteng-3-ip-addressing-and-subnet-tools/</guid>
      <description>&lt;p&gt;IP addressing and subnetting is a common interview subject. I assert that memorizing these things is useful for learning the concepts but ultimately futile in that it is time consuming and inefficient use of engineering time when tools can be utilized to accomplish the same goals in less time with fewer errors. Honestly, I gave up doing this kind of work manually around 10 years ago and have never regretted it, and in actuality, I&amp;rsquo;d probably struggle to do it at this point because it&amp;rsquo;s a repetitive process better suited by code. In the old days, subnetting IPv4 manually was a badge of honor (and one that I always hated), but I learned it because I needed to know it for cert tests and daily work. However, once I started doing IPv6 around 2001, it became clear that doing this kind of thing by hand was consuming more time than it needed to. Enter UNIX tools. HEX Hex isn&amp;rsquo;t really a tool as much as it&amp;rsquo;s a hack for your shell.  Remember the &lt;a href=&#34;http://www.forwardingplane.net/2014/04/nix4neteng-1-managing-dotfiles-pwn-the-unspoken-pain-of-unix-administration/&#34; title=&#34;NIX4NetEng #1 Managing dotfiles; pwn the unspoken pain of UNIX administration&#34;&gt;post on dotfiles&lt;/a&gt;? This is something that can go right into your .bashrc and allows for the quick and easy translation of decimal to hexidecimal, which is very useful for IPv6 dual stacking because [in my opinion] the appropriate addressing scheme is to match the last octet based on hex and not numerically. So, to do that one needs to be able to easily convert the last octet quickly and easily.  Adding this to your .bashrc will accomplish this:```
alias hex=&amp;lsquo;printf &amp;ldquo;%x\n&amp;rdquo;&amp;rsquo;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Now, if you have an address of 10.143.27.199, you take the .199 you can utilize the shell alias to convert it to the hex equivalent.  For example: If you&#39;re using static addresses or dhcpv6 with static addressing, you can match the last octet properly.```&#34; data-lang=&#34;Now, if you have an address of 10.143.27.199, you take the .199 you can utilize the shell alias to convert it to the hex equivalent.  For example: If you&#39;re using static addresses or dhcpv6 with static addressing, you can match the last octet properly.```&#34;&gt;(~) desktop $ hex 199
c7&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you&amp;rsquo;re using static addresses or dhcpv6 with static addressing, you can match the last octet properly.```
10.143.27.&lt;sup&gt;199&lt;/sup&gt;&amp;frasl;&lt;sub&gt;27&lt;/sub&gt;
2001:DB8:1b::c7/120&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-There are more than this, but these are the tools I use almost daily. I generally use [sipcalc](http://www.routemeister.net/projects/sipcalc/) at this point since it does what I used to use [ipcalc](http://jodies.de/ipcalc) for and more.  For gathering and verifying information, this is a fantastic tool.```&#34; data-lang=&#34;There are more than this, but these are the tools I use almost daily. I generally use [sipcalc](http://www.routemeister.net/projects/sipcalc/) at this point since it does what I used to use [ipcalc](http://jodies.de/ipcalc) for and more.  For gathering and verifying information, this is a fantastic tool.```&#34;&gt;(~) desktop $ sipcalc 2001:DB8:1b::c7/120
-\[ipv6 : 2001:DB8:1b::c7/120\] - 0
``````
\[IPV6 INFO\]
Expanded Address - 2001:0db8:001b:0000:0000:0000:0000:00c7
Compressed address - 2001:db8:1b::c7
Subnet prefix (masked) - 2001:db8:1b:0:0:0:0:0/120
Address ID (masked) - 0:0:0:0:0:0:0:c7/120
Prefix address - ffff:ffff:ffff:ffff:ffff:ffff:ffff:ff00
Prefix length - 120
Address type - Aggregatable Global Unicast Addresses
Network range - 2001:0db8:001b:0000:0000:0000:0000:0000 -
 2001:0db8:001b:0000:0000:0000:0000:00ff -&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And for IPv4:&lt;code&gt;
(~) desktop $ sipcalc 10.143.27.199/27
-\[ipv4 : 10.143.27.199/27\] - 0
&lt;/code&gt;&lt;code&gt;
\[CIDR\]
Host address - 10.143.27.199
Host address (decimal) - 177150919
Host address (hex) - A8F1BC7
Network address - 10.143.27.192
Network mask - 255.255.255.224
Network mask (bits) - 27
Network mask (hex) - FFFFFFE0
Broadcast address - 10.143.27.223
Cisco wildcard - 0.0.0.31
Addresses in network - 32
Network range - 10.143.27.192 - 10.143.27.223
Usable range - 10.143.27.193 - 10.143.27.222
&lt;/code&gt;  Notable mention: Web tools are also useful and are becoming more prolific than the UNIX tools, but I will assume that you&amp;rsquo;re probably already loged into a UNIX system like a jump box or bastion host anyway and the tools are faster and thinner in that environment. That said, here are some useful web tools: &lt;a href=&#34;http://jodies.de/ipcalc&#34;&gt;ipcalc&lt;/a&gt; has the web interface to their tool. &lt;a href=&#34;http://www.gestioip.net/cgi-bin/subnet_calculator.cgi&#34;&gt;This site&lt;/a&gt; has a v4 and v6 calculator that works well and looks a lot like the output of sipcalc.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>NIX4NetEng 2 IPv4/6 address investigation tools - whois &#43; dig</title>
      <link>https://forwardingplane.net/post/nix4neteng-2-ipv46-address-investigation-tools-whois-dig/</link>
      <pubDate>Sat, 07 Jun 2014 19:54:41 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/nix4neteng-2-ipv46-address-investigation-tools-whois-dig/</guid>
      <description>

&lt;p&gt;I don&amp;rsquo;t care what your vendor alignment of choice is, Cisco, Juniper, Brocade, Alcatel&amp;hellip;.it doesn&amp;rsquo;t matter. At one point or another you&amp;rsquo;re going to need to bird dog an address to see where it&amp;rsquo;s coming from, who owns it, what it&amp;rsquo;s DNS name is or what path you&amp;rsquo;re taking to get to it.  We&amp;rsquo;ve already talked about &lt;a href=&#34;http://www.forwardingplane.net/2014/03/bgp-tools-troubleshooting-and-monitoring-external-routing-in-a-nutshell/&#34; title=&#34;BGP tools; troubleshooting and monitoring external routing in a nutshell&#34;&gt;BGP tools&lt;/a&gt;, they&amp;rsquo;re a great choice for checking routes across the internet. Hunting down addresses is an interesting one, though, as address management and lookups  can bleed into other aspects of networking like path selection, latency, jitter and many other things.  I&amp;rsquo;m going to touch on a few things and give generalizations on a few others.  First, querying where things originate and who has ownership is infinitely useful, especially if your job description has &amp;ldquo;security&amp;rdquo; anywhere in it, written or implied.  I like to use a range of services, all of which are from the CLI (for speed and scriptability).  My go-to tools for this are the venerable &lt;a href=&#34;http://en.wikipedia.org/wiki/Whois&#34;&gt;whois&lt;/a&gt; and dig tools. Lets say I want to check on the address 192.80.96.88. First, lets figure out if it&amp;rsquo;s got a name.  dig is your friend here.```
(~) jumphost $ dig -x 192.80.96.88
; &amp;lt;&amp;lt;&amp;gt;&amp;gt; DiG 9.8.3-P1 &amp;lt;&amp;lt;&amp;gt;&amp;gt; -x 192.80.96.88
;; global options: +cmd
;; Got answer:
;; -&amp;gt;&amp;gt;HEADER&amp;lt;&amp;lt;- opcode: QUERY, status: NOERROR, id: 29443
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0
;; QUESTION SECTION:
;88.96.80.192.in-addr.arpa. IN PTR
;; ANSWER SECTION:
88.96.80.192.in-addr.arpa. 7145 IN PTR local.forwardingplane.net.
;; Query time: 2 msec
;; SERVER: 10.209.209.1#53(10.209.209.1)
;; WHEN: Sat May 31 11:43:18 2014
;; MSG SIZE rcvd: 82&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Dig is an incredibly powerful DNS tool. I&#39;d recommend learning it as well as you possibly can. [_man dig_](http://linux.die.net/man/1/dig) on any good unix box should give you a good start, [this site](http://www.thegeekstuff.com/2012/02/dig-command-examples/) has some good examples too, I can&#39;t even scratch the surface of how useful DNS tools are, probably a great subject for another NIX4NetEng.  Here we see that the address has reverse DNS (PTR record) of local.forwardingplane.net.  We can poke a bit more at this using DNS, too.```&#34; data-lang=&#34;Dig is an incredibly powerful DNS tool. I&#39;d recommend learning it as well as you possibly can. [_man dig_](http://linux.die.net/man/1/dig) on any good unix box should give you a good start, [this site](http://www.thegeekstuff.com/2012/02/dig-command-examples/) has some good examples too, I can&#39;t even scratch the surface of how useful DNS tools are, probably a great subject for another NIX4NetEng.  Here we see that the address has reverse DNS (PTR record) of local.forwardingplane.net.  We can poke a bit more at this using DNS, too.```&#34;&gt;(~) jumphost $ dig -t ANY local.forwardingplane.net +noall +answer

; &amp;lt;&amp;lt;&amp;gt;&amp;gt; DiG 9.8.3-P1 &amp;lt;&amp;lt;&amp;gt;&amp;gt; -t ANY local.forwardingplane.net +noall +answer
;; global options: +cmd
local.forwardingplane.net. 221 IN AAAA 2607:dd00:8000:18::88
local.forwardingplane.net. 221 IN A 192.80.96.88&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Well, we can see here we have a dual stacked host.  We&amp;rsquo;ll look at that more later. Let&amp;rsquo;s see who owns this address space. Whois is the way to go here.  I always start with querying ARIN and go from there.  ```
(~) jumphost $ whois -h whois.arin.net 192.80.96.88&lt;/p&gt;

&lt;p&gt;#&lt;/p&gt;

&lt;h1 id=&#34;arin-whois-data-and-services-are-subject-to-the-terms-of-use&#34;&gt;ARIN WHOIS data and services are subject to the Terms of Use&lt;/h1&gt;

&lt;h1 id=&#34;available-at-https-www-arin-net-whois-tou-html&#34;&gt;available at: &lt;a href=&#34;https://www.arin.net/whois_tou.html&#34;&gt;https://www.arin.net/whois_tou.html&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;#&lt;/p&gt;

&lt;p&gt;#&lt;/p&gt;

&lt;h1 id=&#34;query-terms-are-ambiguous-the-query-is-assumed-to-be&#34;&gt;Query terms are ambiguous.  The query is assumed to be:&lt;/h1&gt;

&lt;h1 id=&#34;n-192-80-96-88&#34;&gt;&amp;ldquo;n 192.80.96.88&amp;rdquo;&lt;/h1&gt;

&lt;p&gt;#&lt;/p&gt;

&lt;h1 id=&#34;use-to-get-help&#34;&gt;Use &amp;ldquo;?&amp;rdquo; to get help.&lt;/h1&gt;

&lt;p&gt;#&lt;/p&gt;

&lt;p&gt;#&lt;/p&gt;

&lt;h1 id=&#34;the-following-results-may-also-be-obtained-via&#34;&gt;The following results may also be obtained via:&lt;/h1&gt;

&lt;h1 id=&#34;http-whois-arin-net-rest-nets-q-192-80-96-88-showdetails-true-showarin-false-ext-netref2&#34;&gt;&lt;a href=&#34;http://whois.arin.net/rest/nets;q=192.80.96.88?showDetails=true&amp;amp;showARIN=false&amp;amp;ext=netref2&#34;&gt;http://whois.arin.net/rest/nets;q=192.80.96.88?showDetails=true&amp;amp;showARIN=false&amp;amp;ext=netref2&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;#&lt;/p&gt;

&lt;p&gt;NetRange:       192.80.96.0 - 192.80.111.255
CIDR:           192.80.96.0/20
OriginAS:       AS10932
NetName:        UC2B-1
NetHandle:      NET-192-80-96-0-1
Parent:         NET-192-0-0-0-0
NetType:        Direct Allocation
RegDate:        2013-02-27
Updated:        2013-02-27
Ref:            &lt;a href=&#34;http://whois.arin.net/rest/net/NET-192-80-96-0-1&#34;&gt;http://whois.arin.net/rest/net/NET-192-80-96-0-1&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;OrgName:        UC2B
OrgId:          CCLAUBBC
Address:        102 North Neil Street
City:           Champaign
StateProv:      IL
PostalCode:     61820
Country:        US
RegDate:        2012-02-28
Updated:        2014-02-19
Ref:            &lt;a href=&#34;http://whois.arin.net/rest/org/CCLAUBBC&#34;&gt;http://whois.arin.net/rest/org/CCLAUBBC&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;OrgAbuseHandle: UCBTE-ARIN
OrgAbuseName:   uc2b-tech
OrgAbusePhone:  +1-217-265-4226
OrgAbuseEmail:  uc2b-tech@uc2b.net
OrgAbuseRef:    &lt;a href=&#34;http://whois.arin.net/rest/poc/UCBTE-ARIN&#34;&gt;http://whois.arin.net/rest/poc/UCBTE-ARIN&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;OrgNOCHandle: UCBTE-ARIN
OrgNOCName:   uc2b-tech
OrgNOCPhone:  +1-217-265-4226
OrgNOCEmail:  uc2b-tech@uc2b.net
OrgNOCRef:    &lt;a href=&#34;http://whois.arin.net/rest/poc/UCBTE-ARIN&#34;&gt;http://whois.arin.net/rest/poc/UCBTE-ARIN&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;OrgTechHandle: UCBTE-ARIN
OrgTechName:   uc2b-tech
OrgTechPhone:  +1-217-265-4226
OrgTechEmail:  uc2b-tech@uc2b.net
OrgTechRef:    &lt;a href=&#34;http://whois.arin.net/rest/poc/UCBTE-ARIN&#34;&gt;http://whois.arin.net/rest/poc/UCBTE-ARIN&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;#&lt;/p&gt;

&lt;h1 id=&#34;arin-whois-data-and-services-are-subject-to-the-terms-of-use-1&#34;&gt;ARIN WHOIS data and services are subject to the Terms of Use&lt;/h1&gt;

&lt;h1 id=&#34;available-at-https-www-arin-net-whois-tou-html-1&#34;&gt;available at: &lt;a href=&#34;https://www.arin.net/whois_tou.html&#34;&gt;https://www.arin.net/whois_tou.html&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;#&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-The first 7 lines of this are the most important. Here we can see that the address space is owned by an entity called [UC2B](http://www.uc2b.net), it is part of a /20 that the origin ASN is 10932 and that it is a direct allocation (as opposed to assigned space from an upstream provider).```&#34; data-lang=&#34;The first 7 lines of this are the most important. Here we can see that the address space is owned by an entity called [UC2B](http://www.uc2b.net), it is part of a /20 that the origin ASN is 10932 and that it is a direct allocation (as opposed to assigned space from an upstream provider).```&#34;&gt;NetRange:       192.80.96.0 - 192.80.111.255
CIDR:           192.80.96.0/20
OriginAS:       AS10932
NetName:        UC2B-1
NetHandle:      NET-192-80-96-0-1
Parent:         NET-192-0-0-0-0
NetType:        Direct Allocation&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I could tell you some horror stories about getting this address space assigned. It took me 7 months to get that allocation from ARIN&amp;hellip;&amp;hellip;.but I digress.  From here we can query the ASN, also using whois, again, the first few lines are generally the most useful.```
(~) jumphost $ whois -h whois.arin.net 10932
ASNumber: 10932
ASName: UC2B
ASHandle: AS10932
RegDate: 2012-06-28
Updated: 2012-06-28
Ref: &lt;a href=&#34;http://whois.arin.net/rest/asn/AS10932&#34;&gt;http://whois.arin.net/rest/asn/AS10932&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-We can use this information to track down responsible parties, addresses, etc.  It&#39;s a great resource for knowing both technical and non-technical details about address space. [Team Cymru has an extremely powerful whois service](http://www.team-cymru.org/Services/ip-to-asn.html#whois) that allows for significantly more flexibility including time and date.```&#34; data-lang=&#34;We can use this information to track down responsible parties, addresses, etc.  It&#39;s a great resource for knowing both technical and non-technical details about address space. [Team Cymru has an extremely powerful whois service](http://www.team-cymru.org/Services/ip-to-asn.html#whois) that allows for significantly more flexibility including time and date.```&#34;&gt;(~) jumphost $ whois -h whois.cymru.com &amp;#34; -v 192.80.96.88&amp;#34;
AS      | IP               | BGP Prefix          | CC | Registry | Allocated  | AS Name
10932   | 192.80.96.88     | 192.80.96.0/20      | US | arin     | 2013-02-27 | UC2B - UC2B,US&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As you can imagine, this can be a robust way to track changes and re-allocations of ASNs and address blocks, especially with the dwindling amounts of IPv4 and the re-assignment of ASNs.  One can see when ownership has changed and verify the correct origin of address blocks.  Great for validation and correlation. These services also work for IPv6. We can see if the V6 space is coming from the same ASN or if it&amp;rsquo;s a different entity (like a &lt;a href=&#34;http://www.tunnelbroker.net&#34;&gt;tunnel&lt;/a&gt; or a totally different provider).&lt;code&gt;
\[buraglio@local ~\]$ whois -h whois.cymru.com &amp;quot; -v 2607:dd00:8000:18::88&amp;quot;
\[Querying whois.cymru.com\]
\[whois.cymru.com\]
AS      | IP                                       | BGP Prefix          | CC | Registry | Allocated  | AS Name
10932   | 2607:dd00:8000:18::88                    | 2607:dd00::/32      | US | arin     | 2012-07-23 | UC2B - UC2B,US
&lt;/code&gt; &lt;/p&gt;

&lt;p&gt;This is really just the tip of the iceberg in this kind of toolset.  There are &lt;em&gt;countless&lt;/em&gt; scripts, binaries and  shell hacks to do no end of interesting and useful things and gather information.  Have some other, better uses or tools?  Post them in the comments!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>NIX4NetEng 1 Managing dotfiles; pwn the unspoken pain of UNIX administration</title>
      <link>https://forwardingplane.net/post/nix4neteng-1-managing-dotfiles-pwn-the-unspoken-pain-of-unix-administration/</link>
      <pubDate>Thu, 01 May 2014 02:58:20 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/nix4neteng-1-managing-dotfiles-pwn-the-unspoken-pain-of-unix-administration/</guid>
      <description>&lt;p&gt;Many network engineers are also tasked with maintaining systems that provide network services, those things that make the network easier to use such as DNS and DHCP or management systems that perform useful things like monitor the network, collect flow data or bestow access to the equipment by acting as &lt;a href=&#34;http://en.wikipedia.org/wiki/Bastion_host&#34;&gt;bastion&lt;/a&gt; or jump hosts.  In many instances, robust and high availability services run on UNIX, Linux or BSD systems for stability and reliability, so those that manage these systems need to be well versed system admins as well as whatever their other job functions are.  &lt;a href=&#34;http://packetpushers.net/are-certifications-tests-still-worth-your-resources-in-the-day-of-hybrid-it/&#34;&gt;Hybridization&lt;/a&gt;, if you will.  Nothing new, nothing unexpected.  However, one of the banes of these tasks is having a uniform shell environment across platforms and systems. Why create a customized environment with aliases, environmental variables and other personalized settings more than once? I have struggled with how to do this efficiently across desktop, server, jumphosts and other daily use systems for &lt;strong&gt;years&lt;/strong&gt;. Most of the important variables are controlled by dotfiles.   In what I am hoping is the start of a short series of &amp;ldquo;UNIX stuff for networking folks&amp;rdquo;, I will explain how I did this for myself. UNIX and Linux admins have been dealing with dotfiles forever. GitHub even has a &lt;a href=&#34;http://dotfiles.github.io/&#34;&gt;repo dedicated to&lt;/a&gt; it.  For my environment, I chose to go with &lt;a href=&#34;http://jim.github.io/briefcase/&#34;&gt;Briefcase&lt;/a&gt; and &lt;a href=&#34;http://www.bitbucket.com&#34;&gt;BitBucket&lt;/a&gt;.  Briefcase because it has mechanisms for stripping out sensitive information if needed and bitbucket because I can have private repos without paying money.  This can all certainly be done with local git repos or github and without briefcase. Briefcase is really straightforward to install, it&amp;rsquo;s just a ruby gem, so &lt;em&gt;gem install briefcase&lt;/em&gt; is all that is needed to get it on your machine&lt;em&gt;.&lt;/em&gt;  OSX has it by default.  On my machine I needed to to&lt;em&gt;sudo gem update —system&lt;/em&gt; before it would install.  Your mileage may vary&lt;em&gt;. &lt;/em&gt; Once it&amp;rsquo;s installed, just add your files.  I switched to bash, so I needed to import .bashrc and .bash_profile, but I wanted to make sure I had a backup just in case.```
mkdir -p tmp/dotfiles
mv .bashrc tmp/dotfiles/
mv .bash_profile tmp/dotfiles/&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;briefcase import ~/.bashrc
briefcase import ~/.bash\_profile
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;briefcase git remote add origin git@repo.forwardingplane.net:buraglio/briefcase-dotfiles.git&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;briefcase git commit -am &amp;quot;Initial newhost commit&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;briefcase git checkout origin master&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Obviously replace the remote repo address with your own repo destination.   You can now check the status:```&#34; data-lang=&#34;Obviously replace the remote repo address with your own repo destination.   You can now check the status:```&#34;&gt;briefcase sync&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This should output something like this:```
Synchronizing dotfiles between /Users/buraglio/.dotfiles and /Users/buraglio
Symlink verified: /Users/buraglio/.bash_profile -&amp;gt; /Users/buraglio/.dotfiles/bash_profile
Symlink verified: /Users/buraglio/.bashrc -&amp;gt; /Users/buraglio/.dotfiles/bashrc
Symlink verified: /Users/buraglio/.profile -&amp;gt; /Users/buraglio/.dotfiles/profile
Symlink verified: /Users/buraglio/.README.md -&amp;gt; /Users/buraglio/.dotfiles/README.md&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Getting a new branch for an existing host was the biggest hurdle for me, I want a base .bashrc but may want different environment variables for mac and Linux.  I&#39;m not a git expert by any means, so there may be a better way to do this, but it works well for me. To branch a new host, it&#39;s pretty straightforward.  Briefcase is really just a wrapper for git, so prepending &#34;briefcase&#34; before the git commands seems to &#34;just work&#34; (as I learned by trial and error or making this work). On an existing Host:```&#34; data-lang=&#34;Getting a new branch for an existing host was the biggest hurdle for me, I want a base .bashrc but may want different environment variables for mac and Linux.  I&#39;m not a git expert by any means, so there may be a better way to do this, but it works well for me. To branch a new host, it&#39;s pretty straightforward.  Briefcase is really just a wrapper for git, so prepending &#34;briefcase&#34; before the git commands seems to &#34;just work&#34; (as I learned by trial and error or making this work). On an existing Host:```&#34;&gt;git clone git@your.repoaddress.net:username/reponame.git .dotfiles
mkdir -p tmp/dotfiles
mv .bashrc tmp/dotfiles/
mv .bash\_profile tmp/dotfiles/
briefcase sync
briefcase git branch \[newhost\]
briefcase git checkout \[newhost\]&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&amp;hellip;Make changes&amp;hellip;&lt;code&gt;
briefcase git commit -am &amp;quot;Initial newhost commit&amp;quot;
&lt;/code&gt;briefcase git push origin [newhost] There you have it, easily backed up and distributed environment control.  I&amp;rsquo;m planning to add &lt;a href=&#34;http://joeyh.name/code/etckeeper/&#34;&gt;etckeeper&lt;/a&gt; to this process next.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Blending the Network; Pluribus ServerSwitch</title>
      <link>https://forwardingplane.net/post/blending-the-network-pluribus-serverswitch/</link>
      <pubDate>Mon, 21 Apr 2014 04:44:30 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/blending-the-network-pluribus-serverswitch/</guid>
      <description>

&lt;p&gt;I firmly believe that blending disciplines is the way of the future in IT. I&amp;rsquo;ve rambled about it here at &lt;a href=&#34;http://packetpushers.net/are-certifications-tests-still-worth-your-resources-in-the-day-of-hybrid-it/&#34;&gt;other venues&lt;/a&gt; and I&amp;rsquo;m vocal (some would probably say brash) about it on the &lt;a href=&#34;http://www.twitter.com/buraglio&#34;&gt;twitters&lt;/a&gt;.  Be it Networking and System, Systems and Security, Programming and Networking, most of us that have been around any length of time already do it but now it&amp;rsquo;s happening out in the open and &amp;ldquo;&lt;a href=&#34;http://en.wikipedia.org/wiki/DevOps&#34;&gt;DevOps&lt;/a&gt;&amp;rdquo;, a form of the hybrid IT worker, has seemingly become the BOTD (Buzzword of the day). With &amp;ldquo;&lt;em&gt;hybrid&lt;/em&gt;&amp;rdquo; in mind, it was very apt that &lt;a href=&#34;http://www.pluribusnetworks.com/&#34;&gt;Pluribus Networks&lt;/a&gt; presented an intriguing spin on &amp;ldquo;&lt;em&gt;hybrid&lt;/em&gt;&amp;rdquo; from the hardware point of view at &lt;a href=&#34;http://techfieldday.com/event/nfd7/&#34;&gt;Network Field Day 7&lt;/a&gt;.  Remember the days or routers &lt;em&gt;or&lt;/em&gt; switches? Sure you do. Then along came the L3 Switch and shook everything up.  Now you could do both on the same box simplifying OPEX and potentially CAPEX as well as maintenance fees. It became possible to simplify the architecture and even to to collapse it if so desired.  I certainly did not expect to see anything like that in Pluribus.  In fact, to be honest, I really was not sure what to expect.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.forwardingplane.net/wp-content/uploads/2014/04/PBNet.png&#34;&gt;&lt;img src=&#34;http://www.forwardingplane.net/wp-content/uploads/2014/04/PBNet.png&#34; alt=&#34;PBNet&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;What pluribus brings is merchant based hardware but it has a spin that I  didn&amp;rsquo;t see coming.  A pretty innovative one, too. What others began by creating flexible, programmable and highly resilient OSs and/or feature rich hardware without big name fuss (and prices to accompany said fuss), &lt;a href=&#34;http://www.pluribusnetworks.com/&#34;&gt;Pluribus&lt;/a&gt; has evolved one step further, added some serious steroids to the hardware and infused very flexible OS with many management vectors (CLI, API, GUI and even good &amp;lsquo;ol UNIX commands).  &lt;img src=&#34;http://www.forwardingplane.net/wp-content/uploads/2014/03/800px-1968_El_Camino.jpg&#34; alt=&#34;800px-1968_El_Camino&#34; /&gt; Like a Reese&amp;rsquo;s peanut butter cup, Pluribus has blended two things that seem to work well together: a &lt;a href=&#34;http://www.pluribusnetworks.com/products/freedom-server-switch-line/&#34;&gt;powerful server platform&lt;/a&gt; for processing and potentially acting on massive amounts of data and a merchant based silicon switch with a good number of fast interfaces.  It&amp;rsquo;s a software driven hardware solution.  A host router, but so much more.  I&amp;rsquo;ve long thought that host based routing and switching was a powerful tool, having worked on several &lt;a href=&#34;http://www.pfsense.org&#34;&gt;open source platforms&lt;/a&gt; that do just that.  However, the issues that inevitably came up were a lack of commercial hardware and software support, a structured, well defined market or the risk of the fracture of a community based product.  This provides answers to all of those concerns and offers a unique product to boot.&lt;/p&gt;

&lt;h2 id=&#34;swerver&#34;&gt;&lt;em&gt;&amp;ldquo;Swerver&amp;rdquo;  &lt;/em&gt;&lt;/h2&gt;

&lt;p&gt;That&amp;rsquo;s the word that jumps into my brain when I try to categorize this nifty hybrid.  It&amp;rsquo;s a server, no it&amp;rsquo;s a switch no it&amp;rsquo;s a server &amp;hellip;It&amp;rsquo;s like an &lt;a href=&#34;http://en.wikipedia.org/wiki/Chevrolet_El_Camino&#34;&gt;El Camino&lt;/a&gt; (or &lt;a href=&#34;http://en.wikipedia.org/wiki/Ford_Ranchero‎&#34;&gt;Ford Ranchero&lt;/a&gt;, depending on your persuasion), &amp;ldquo;Is it a car? Is it a Truck?&amp;rdquo; &amp;ldquo;Yes.&amp;rdquo; Pluribus presents some interesting questions about how we can blend the network and systems into a more flexible platform with their server switch platform, creating an &lt;em&gt;infrastructure&lt;/em&gt; fabric as opposed to a &amp;ldquo;series of tubes&amp;rdquo; that &amp;ldquo;servers&amp;rdquo; connect to.  Their software suite is quite robust, too.  Anything from NAS to CDN, NAT to L3.  Oh, and they can run VMs, too.  I&amp;rsquo;m thinking a Bro IDS node, a blackhole router and a perfsonar node running right in the network fabric.  Very thought provoking stuff. I like to see ideas, products and people that lay it all out there and try to transform, to evoke thoughts and try to foster change.  This does that.  You can check out the videos from NFD7 &lt;a href=&#34;http://techfieldday.com/appearance/pluribus-networks-presents-at-networking-field-day-7/&#34;&gt;here&lt;/a&gt;.  I &lt;strong&gt;&lt;em&gt;dare&lt;/em&gt;&lt;/strong&gt; you to tell me you can not think of a use for something like this. &lt;a href=&#34;http://commons.wikimedia.org/wiki/File:1968_El_Camino.jpg&#34;&gt;El Camino Image Reference via WikiPedia&lt;/a&gt; Freedom Line image source Pluribus Networks   &lt;a href=&#34;http://www.forwardingplane.net/about/disclaimer/&#34;&gt;Standard Disclaimer&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Replace ZFS RAIDZ1 disk</title>
      <link>https://forwardingplane.net/post/replace-zfs-raidz1-disk/</link>
      <pubDate>Tue, 11 Mar 2014 01:01:58 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/replace-zfs-raidz1-disk/</guid>
      <description>&lt;p&gt;I recently had the displeasure of dealing with a series of failed disks in my newly created ZFS based NAS.  I had cobbled together roughly 12TB of disk space and jammed them into an old PC, stretching the limits of the platform when I decided to go with ZFS.  I broke all of the rules, underpowered, single core PC, only a handful of GIG of non-ECC RAM, etc.  I&amp;rsquo;m sure storage guys are having a coronary after reading that, but it works for me and has minimal issues since I just relatively redundant need bulk storage and it doesn&amp;rsquo;t need to be fast (the ethernet connection is only 100M). Machine stats are as such: AMD Sempron&amp;trade; Processor 2800+ 2G NON-ECC memory The following disks:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.forwardingplane.net/wp-content/uploads/2014/03/Screenshot-2014-03-10-13.49.35.png&#34;&gt;&lt;img src=&#34;http://www.forwardingplane.net/wp-content/uploads/2014/03/Screenshot-2014-03-10-13.49.35-1024x280.png&#34; alt=&#34;Screenshot 2014-03-10 13.49.35&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The NAS was a long standing device on my network.  I&amp;rsquo;ve been using &lt;a href=&#34;http://www.nas4free.org/&#34;&gt;NAS4FREE&lt;/a&gt; for quite some time with fantastic results.  The disks are simply desktop drives, nothing fancy.  When I rebuilt it all using ZFS I found that I had not done 2 things.  I had not documented the warranty status of the devices and I had not enabled SMART monitoring.  I know, amateur hour at its finest; I&amp;rsquo;m OK with it, it&amp;rsquo;s just for home use and I have offsite storage for anything super important. *&lt;em&gt;As an aside, if you&amp;rsquo;re looking to build a NAS I would both recommend &lt;a href=&#34;http://www.nas4free.org/&#34;&gt;NAS4FREE&lt;/a&gt; as well as doing something as simple as documenting the warranty information of each disk in the description field.&lt;/em&gt; So, when I enabled SMART monitoring and email reporting. I found that several of my disks were failing their end-to-end tests when this started showing up in my inbox:  ```
The following warning/error was logged by the smartd daemon:
Device: /dev/ada1, Failed SMART usage Attribute: 184 End-to-End_Error.
Device info:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ST2000DM001-1CH164, S/N:xxxxxxxx, WWN:5-000c50-08147e2a4, FW:CC26, 2.00 TB
```  Bad news. However, with ZFS it is supposed to be fantastically easy to do disk replacements.  I had chosen RAIDZ1 for both volumes, so they could each supposedly sustain a single disk failure. There are a lot of online references for zfs. I used [this page](http://panoramicsolution.com/blog/?p=353) as a starting point for replacing my disk. I dropped to the shell on the NAS and did the following to identify the right disk to remove:```
nas:~# camcontrol devlist
&amp;lt;ST31000340AS SD15&amp;gt; at scbus0 target 0 lun 0 (ada0,pass0)
&amp;lt;ST2000DM001-1CH164 CC26&amp;gt; at scbus1 target 0 lun 0 (ada1,pass1)
&amp;lt;ST2000DM001-1CH164 CC24&amp;gt; at scbus2 target 0 lun 0 (ada2,pass2)
&amp;lt;ST2000DM001-1CH164 CC26&amp;gt; at scbus3 target 0 lun 0 (ada3,pass3)
&amp;lt;WDC WD20EARS-00MVWB0 51.0AB51&amp;gt; at scbus4 target 0 lun 0 (ada4,pass4)
&amp;lt;ST31500341AS CC1H&amp;gt; at scbus5 target 0 lun 0 (ada5,pass5)
&amp;lt;ST2000DM001-1CH164 CC29&amp;gt; at scbus6 target 0 lun 0 (ada6,pass6)
&amp;lt;ST31500341AS CC1H&amp;gt; at scbus7 target 0 lun 0 (ada7,pass7)
&amp;lt;ST2000DM001-9YN164 CC82&amp;gt; at scbus8 target 0 lun 0 (ada8,pass8)
&amp;lt;TOSHIBA THNCF512MPG 1.00&amp;gt; at scbus11 target 0 lun 0 (ada9,pass9)
```ada8 needs replaced.  The volume it exists in is zfs0.  The formula used is _&amp;quot;zpool &amp;lt;command&amp;gt; &amp;lt;pool&amp;gt; &amp;lt;device&amp;gt;&amp;quot;_```
zpool offline zfs0 ada8
```None of my stuff is hot swap, so I have to shut down the box.```
shutdown -h now
```Yank out the old disk and install the new one.```
zpool replace zfs0 ada8
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;zpool online zfs0 ada8&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-After that you&#39;ll see the disk getting resilvered, which will take a while.```&#34; data-lang=&#34;After that you&#39;ll see the disk getting resilvered, which will take a while.```&#34;&gt;nas:~# zpool status zfs0
pool: zfs0
state: DEGRADED
status: One or more devices is currently being resilvered. The pool will
continue to function, possibly in a degraded state.
action: Wait for the resilver to complete.
scan: resilver in progress since Mon Mar 10 13:39:36 2014
105G scanned out of 3.37T at 75.4M/s, 12h36m to go
17.5G resilvered, 3.04% done
config:

NAME STATE READ WRITE CKSUM
zfs0 DEGRADED 0 0 0
raidz1-0 DEGRADED 0 0 0
ada1 ONLINE 0 0 0
ada2 ONLINE 0 0 0
ada3 ONLINE 0 0 0
ada4 ONLINE 0 0 0
ada6 ONLINE 0 0 0
replacing-5 OFFLINE 0 0 0
6070465578770542405 OFFLINE 0 0 0 was /dev/ada8/old
ada8 ONLINE 0 0 0 (resilvering)

errors: No known data errors&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;After the resilvering process you should have a repaired volume.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Install nfsen and nfdump on CentOS 6.5 for netflow and or sflow collection</title>
      <link>https://forwardingplane.net/post/install-nfsen-and-nfdump-on-centos-6-5-for-netflow-and-or-sflow-collection/</link>
      <pubDate>Sat, 11 Jan 2014 21:55:24 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/install-nfsen-and-nfdump-on-centos-6-5-for-netflow-and-or-sflow-collection/</guid>
      <description>

&lt;p&gt;I am an absolutely &lt;strong&gt;huge&lt;/strong&gt; fan of statistical and instrumentation data, especially when it comes to traffic analysis, visualization and baselining.  I&amp;rsquo;ve rambled on about the importance of it at &lt;a href=&#34;http://searchnetworking.techtarget.com/news/2240212051/The-Der-Spiegel-NSA-revelations-What-network-engineers-need-to-know&#34;&gt;every opportunity&lt;/a&gt;.  As a result of that, I have been doing work with netflow and netflow-like data for a fairly long time.  My first collector was the &lt;a href=&#34;http://www.splintered.net/sw/flow-tools/&#34;&gt;OSU Flow tools&lt;/a&gt; based stuff  back around 13 years ago.  From there I played with all kinds of netflow tools, both &lt;a href=&#34;http://www.arbornetworks.com/&#34;&gt;commercial&lt;/a&gt; and open source, finally settling most of my focus on &lt;a href=&#34;http://nfdump.sourceforge.net/&#34;&gt;nfdump&lt;/a&gt; and &lt;a href=&#34;http://nfsen.sourceforge.net/&#34;&gt;nfsen&lt;/a&gt;. A bit of history: nfdump was born out of a research network, requiring it to be able to consume huge amounts of flows efficiently.  This makes it very powerful and very useful for nearly anyone, from the small technology tinkerer to to the enterprise network engineer up through the service provider architect.  nfsen is really just a php wrapper for nfdump, however, the really nice thing about it (other then being free, opensource software) is that it is extendable via &lt;a href=&#34;http://sourceforge.net/apps/trac/nfsen-plugins/&#34;&gt;plugins&lt;/a&gt;.  This is really what makes it a serious player from all angles.     From botnet detection to displaying IP geo-data on a map, there is likely a plugin for it.  Not finding what you are looking for?  Write it!  The architecture to use it is already there and documented. For ease of install, I chose CentOS 6.5.  Once you have a system up and running, to get nfsen/nfdump working, here is what you need to do:```
yum install -y httpd php wget gcc make rrdtool-devel &lt;br /&gt;
rrdtool-perl perl-MailTools perl-Socket6 flex byacc&lt;/p&gt;

&lt;p&gt;vi /etc/selinux/config
set SELINUX=disabled
reboot&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-You&#39;ll need to make an iptables rule (I generally make one for ip6tables as well, in case I want to also enable ipv6 transport)```&#34; data-lang=&#34;You&#39;ll need to make an iptables rule (I generally make one for ip6tables as well, in case I want to also enable ipv6 transport)```&#34;&gt;sudo iptables -I INPUT -p udp -m state --state NEW -m udp --dport 9995 -j ACCEPT
sudo ipt6ables -I INPUT -p udp -m state --state NEW -m udp --dport 9995 -j ACCEPT&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Also allow for access to the web server you just installed.```
sudo ip6tables -I INPUT -p tcp -m state &amp;ndash;state NEW -m tcp &amp;ndash;dport 443 -j ACCEPT
sudo ip6tables -I INPUT -p tcp -m state &amp;ndash;state NEW -m tcp &amp;ndash;dport 80 -j ACCEPT&lt;br /&gt;
sudo iptables -I INPUT -p tcp -m state &amp;ndash;state NEW -m tcp &amp;ndash;dport 443 -j ACCEPT
sudo iptables -I INPUT -p tcp -m state &amp;ndash;state NEW -m tcp &amp;ndash;dport 80 -j ACCEPT&lt;br /&gt;
service iptables save
service ip6tables save&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Once you enable https you can safely remove the table rules for port 80. Start HTTPd```&#34; data-lang=&#34;Once you enable https you can safely remove the table rules for port 80. Start HTTPd```&#34;&gt;sudo service httpd start&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Enable HTTPd at boot```
chkconfig httpd on&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Now you need the actual code. I like to grab the latest from sourceforge. (nfdump-1.6.11 and nfsen-1.3.6p1 at the time of this writing)```&#34; data-lang=&#34;Now you need the actual code. I like to grab the latest from sourceforge. (nfdump-1.6.11 and nfsen-1.3.6p1 at the time of this writing)```&#34;&gt;wget http://downloads.sourceforge.net/project/nfdump/stable/nfdump-1.6.11/nfdump-1.6.11.tar.gz
wget http://downloads.sourceforge.net/project/nfsen/stable/nfsen-1.3.6p1/nfsen-1.3.6p1.tar.gz
``````
tar -zxvf nfdump-1.6.11.tar.gz 
./configure --enable-nfprofile --enable-nftrack --enable-sflow 
make &amp;amp;&amp;amp; sudo make install&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;By default 1.6.11 enables v9 and ipfix =)```
adduser netflow
vi /etc/group&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Add user netflow to group apache```&#34; data-lang=&#34;Add user netflow to group apache```&#34;&gt;vi etc/nfsen.conf&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;change www user to apache Add your host to the file to allow for collection, my %sources looks like this:```
%sources = (
    &amp;lsquo;home&amp;rsquo;    =&amp;gt; { &amp;lsquo;port&amp;rsquo; =&amp;gt; &amp;lsquo;9995&amp;rsquo;, &amp;lsquo;col&amp;rsquo; =&amp;gt; &amp;lsquo;#0000ff&amp;rsquo;, &amp;lsquo;type&amp;rsquo; =&amp;gt; &amp;lsquo;netflow&amp;rsquo; },
    &amp;lsquo;internal&amp;rsquo;    =&amp;gt; { &amp;lsquo;port&amp;rsquo; =&amp;gt; &amp;lsquo;9996&amp;rsquo;, &amp;lsquo;col&amp;rsquo; =&amp;gt; &amp;lsquo;#FF0000&amp;rsquo;, &amp;lsquo;type&amp;rsquo; =&amp;gt; &amp;lsquo;netflow&amp;rsquo; },&lt;/p&gt;

&lt;h1 id=&#34;gw-port-9995-col-0000ff-type-netflow&#34;&gt;&amp;lsquo;gw&amp;rsquo;    =&amp;gt; { &amp;lsquo;port&amp;rsquo; =&amp;gt; &amp;lsquo;9995&amp;rsquo;, &amp;lsquo;col&amp;rsquo; =&amp;gt; &amp;lsquo;#0000ff&amp;rsquo;, &amp;lsquo;type&amp;rsquo; =&amp;gt; &amp;lsquo;netflow&amp;rsquo; },&lt;/h1&gt;

&lt;h1 id=&#34;peer1-port-9996-ip-172-16-17-18&#34;&gt;&amp;lsquo;peer1&amp;rsquo;        =&amp;gt; { &amp;lsquo;port&amp;rsquo; =&amp;gt; &amp;lsquo;9996&amp;rsquo;, &amp;lsquo;IP&amp;rsquo; =&amp;gt; &amp;lsquo;172.16.17.18&amp;rsquo; },&lt;/h1&gt;

&lt;h1 id=&#34;peer2-port-9996-ip-172-16-17-19&#34;&gt;&amp;lsquo;peer2&amp;rsquo;        =&amp;gt; { &amp;lsquo;port&amp;rsquo; =&amp;gt; &amp;lsquo;9996&amp;rsquo;, &amp;lsquo;IP&amp;rsquo; =&amp;gt; &amp;lsquo;172.16.17.19&amp;rsquo; },&lt;/h1&gt;

&lt;p&gt;);&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-As you can see, I have two valid sources with different ports and different colors. You can make all netflow, all sflow, or any combination of protocol. change directory to /home/netflow```&#34; data-lang=&#34;As you can see, I have two valid sources with different ports and different colors. You can make all netflow, all sflow, or any combination of protocol. change directory to /home/netflow```&#34;&gt;./install.pl etc/nfsen.conf
cd /home/netflow/bin/
./nfsen start&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Make it start at boot (referenced from &lt;a href=&#34;http://sourceforge.net/mailarchive/message.php?msg_id=29434166&#34;&gt;this post&lt;/a&gt;).```
vi /etc/init.d/nfsen&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Add this into the file:```&#34; data-lang=&#34;Add this into the file:```&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;#
&lt;span style=&#34;color:#75715e&#34;&gt;# chkconfig: - 50 50&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# description: nfsen&lt;/span&gt;

DAEMON&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;/home/netflow/bin/nfsen

&lt;span style=&#34;color:#66d9ef&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;$1&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; in
		start&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
		$DAEMON start
		;;
		stop&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
		$DAEMON stop
		;;
		status&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
		$DAEMON status
		;;
		restart&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
		$DAEMON stop
		sleep &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
		$DAEMON start
		;;
		&lt;span style=&#34;color:#ae81ff&#34;&gt;\*&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
		echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Usage: &lt;/span&gt;$0&lt;span style=&#34;color:#e6db74&#34;&gt; {start|stop|status|restart}&amp;#34;&lt;/span&gt;
		exit &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
		;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;esac&lt;/span&gt;

exit &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then chkconfig it on to start it at boot:```
chmod 755 nfsen &amp;amp;&amp;amp; chkconfig &amp;ndash;add nfsen &amp;amp;&amp;amp; chkconfig nfsen on&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-That&#39;s pretty much it. Once you configure your netflow or sflow source, you should start seeing data in ~5-10 minutes. Point your browser at your web server and see: Mine is set as https://netmon/nfsen/nfsen.php (you&#39;ll need to include the &#34;nfsen.php&#34; uness you edit your apache config to recognize &#34;nfsen.php&#34; as in index.&#34; data-lang=&#34;That&#39;s pretty much it. Once you configure your netflow or sflow source, you should start seeing data in ~5-10 minutes. Point your browser at your web server and see: Mine is set as https://netmon/nfsen/nfsen.php (you&#39;ll need to include the &#34;nfsen.php&#34; uness you edit your apache config to recognize &#34;nfsen.php&#34; as in index.&#34;&gt;[![&lt;span style=&#34;color:#a6e22e&#34;&gt;Screen&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Shot&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2014&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;01&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;at&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;3.13.53&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;PM&lt;/span&gt;](&lt;span style=&#34;color:#a6e22e&#34;&gt;http&lt;/span&gt;:&lt;span style=&#34;color:#75715e&#34;&gt;//www.forwardingplane.net/wp-content/uploads/2014/01/Screen-Shot-2014-01-11-at-3.13.53-PM-913x1024.png)](http://www.forwardingplane.net/wp-content/uploads/2014/01/Screen-Shot-2014-01-11-at-3.13.53-PM.png)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#a6e22e&#34;&gt;Common&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;issues&lt;/span&gt;: &lt;span style=&#34;color:#a6e22e&#34;&gt;I&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;see&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;this&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;one&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;every&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;time&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;ERROR: nfsend connect() error: Permission denied!&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;It&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;s&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;always&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;a&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;permissions&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;issue&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;as&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;documented&lt;/span&gt; [&lt;span style=&#34;color:#a6e22e&#34;&gt;here&lt;/span&gt;](&lt;span style=&#34;color:#a6e22e&#34;&gt;https&lt;/span&gt;:&lt;span style=&#34;color:#75715e&#34;&gt;//code.google.com/p/nfsenplugins/wiki/NFSEN_Installation_Gotchas).  You need to make sure that the nfsen package can read the nfsen.comm socket file. I fixed mine by doing```
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;chmod&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;g&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;rwx&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;~&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;netflow&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;My nfsen.conf file is using /home/netflow as the $BASEDIR.```
 &lt;a href=&#34;http://www.forwardingplane.net/wp-content/uploads/2014/01/Screenshot-2014-01-11-13.04.17.png&#34;&gt;&lt;img src=&#34;http://www.forwardingplane.net/wp-content/uploads/2014/01/Screenshot-2014-01-11-13.04.17.png&#34; alt=&#34;Screenshot 2014-01-11 13.04.17&#34; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-You&#39;ll likely see &#34;Frontend - Backend version mismatch!&#34;, this is a known issue. There is a patch to fix it [here](http://sourceforge.net/p/nfsen/bugs/43/), I never bothered since it did not cause any issues for me. Disk full. Depending on your setup, you may generate a firehose worth of data. I have filled disks in less than a day in the past on a good sized regional WAN. I generally keep a month of data, but you can store as much data as disk you want to buy. I have a script run from cron to prune data, if you want to do the same:```&#34; data-lang=&#34;You&#39;ll likely see &#34;Frontend - Backend version mismatch!&#34;, this is a known issue. There is a patch to fix it [here](http://sourceforge.net/p/nfsen/bugs/43/), I never bothered since it did not cause any issues for me. Disk full. Depending on your setup, you may generate a firehose worth of data. I have filled disks in less than a day in the past on a good sized regional WAN. I generally keep a month of data, but you can store as much data as disk you want to buy. I have a script run from cron to prune data, if you want to do the same:```&#34;&gt;vi /usr/local/etc/rmflowdata.sh&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Paste this in:```
#!/bin/bash&lt;/p&gt;

&lt;h1 id=&#34;prune-flow-data&#34;&gt;prune flow data&lt;/h1&gt;

&lt;h1 id=&#34;usage&#34;&gt;Usage:&lt;/h1&gt;

&lt;h1 id=&#34;30-is-the-number-of-days-adjust-accordingly&#34;&gt;+30 is the number of days, adjust accordingly.&lt;/h1&gt;

&lt;p&gt;/bin/find /home/netflow/profiles-data/live -name &amp;ldquo;nfcapd.*&amp;rdquo; -type f -mtime +30 -delete&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Add this to your crontab:```&#34; data-lang=&#34;Add this to your crontab:```&#34;&gt;@daily /usr/local/bin/rmflowdata.sh&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Make it executable&lt;code&gt;
chmod 755 /usr/local/bin/rmflowdata.sh
&lt;/code&gt;There are probably more elegant ways to do it but this works just fine, is lightweight and can be run manually if needed. There are a lot of great use cases for this.  If you&amp;rsquo;re looking for an SDN tie-in, guess what, there is one.  &lt;a href=&#34;http://blog.sflow.com/2010/05/configuring-open-vswitch.html&#34;&gt;OpenVSwitch supports sflow export&lt;/a&gt; and low-and-behold, nfsen and nfdump can easily consume and display sflow data. Want flow statistics on your all VM, OVS based SDN lab?  Guess what, you can! There are some other great things you can do with flow data, too, specifically sflow.  It&amp;rsquo;s not just for network statistics, there is a host &lt;a href=&#34;http://host-sflow.sourceforge.net/&#34;&gt;based sflow implementation&lt;/a&gt; that track any number of interesting metrics.  &lt;a href=&#34;http://blog.sflow.com/&#34;&gt;blog.sflow.com&lt;/a&gt; is a great resource for all things sflow (also, it does IPv6 by default, as it should). Ok, now you have &lt;strong&gt;absolutely&lt;/strong&gt; no good reason not to be collecting flow data.   It&amp;rsquo;s easy, it&amp;rsquo;s useful and almost everything (hosts, routers, virtual switches) supports exporting &lt;strong&gt;&lt;em&gt;some&lt;/em&gt;&lt;/strong&gt; kind of flow information.  You can even generate it from an inline linux box or a box off of an optical tap or a span port running &lt;a href=&#34;https://code.google.com/p/softflowd/&#34;&gt;softflowd&lt;/a&gt; or &lt;a href=&#34;http://www.ntop.org/products/nprobe/&#34;&gt;nprobe&lt;/a&gt;.   Both of which I can confirm work wonderfully (the above collector is gathering flows from softflowd running on my &lt;a href=&#34;http://www.forwardingplane.net/2013/07/building-a-secured-network-in-a-box/&#34; title=&#34;Building a secured network in a box&#34;&gt;security onion box&lt;/a&gt; as well as exported flows from pfflowd on a &lt;a href=&#34;http://www.pfsense.org/&#34;&gt;pfsense&lt;/a&gt; router).&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Fixing the dreaded &#34;error: could not open configuration database (juniper.data&#43;)&#34; problem.</title>
      <link>https://forwardingplane.net/post/fixing-the-dreaded-error-could-not-open-configuration-database-juniper-data-problem/</link>
      <pubDate>Wed, 07 Aug 2013 16:52:04 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/fixing-the-dreaded-error-could-not-open-configuration-database-juniper-data-problem/</guid>
      <description>&lt;p&gt;Working on some MX series routers recently I encountered a problem I&amp;rsquo;d never seen before, essentially preventing the configuration from being committed:```
buraglio@rtr# commit check
re0:
error: could not open configuration database (juniper.data+)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-This is a very annoying problem and is terribly inconvenient as you can probably imagine. So, my first instinct is to drop down to the shell and starting hacking at it UNIX style.```&#34; data-lang=&#34;This is a very annoying problem and is terribly inconvenient as you can probably imagine. So, my first instinct is to drop down to the shell and starting hacking at it UNIX style.```&#34;&gt;buraglio@rtr&amp;gt;start shell&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;From there I wanted to see the file system and check out the stats of what it thinks we have.```
buraglio@rtr% df -h
Filesystem     Size    Used   Avail Capacity  Mounted on
/dev/ad0s1a    3.5G    313M    2.9G    10%    /
devfs          1.0K    1.0K      0B   100%    /dev
/dev/md0        63M     63M      0B   100%    /packages/mnt/jbase
/dev/md1        53M     53M      0B   100%    /packages/mnt/jkernel64-12.3R3.4
buraglio@rtr%    82M     82M      0B   100%    /packages/mnt/jpfe-X960-12.3R3.4
/dev/md3       5.0M    5.0M      0B   100%    /packages/mnt/jdocs-12.3R3.4
buraglio@rtr%   104M    104M      0B   100%    /packages/mnt/jroute-12.3R3.4
buraglio@rtr% clearM     28M      0B   100%    /packages/mnt/jcrypto64-12.3R3.4
/dev/md6        38M     38M      0B   100%    /packages/mnt/jpfe-common-12.3R3.4
/dev/md7        92K     92K      0B   100%    /packages/mnt/jplatform-12.3R3.4
/dev/md8       422M    422M      0B   100%    /packages/mnt/jruntime-12.3R3.4
/dev/md9       7.9G     16K    7.2G     0%    /tmp
/dev/md10      7.9G     11M    7.2G     0%    /mfs
/dev/ad0s1e    393M     36K    362M     0%    /config
procfs         4.0K    4.0K      0B   100%    /proc
/dev/ad1s1f     18G    4.2G     12G    26%    /var&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-... and check the mounted partitions.```&#34; data-lang=&#34;... and check the mounted partitions.```&#34;&gt;buraglio@rtr% mount
/dev/ad0s1a on / (ufs, local, noatime)
devfs on /dev (devfs, local, multilabel)
/dev/md0 on /packages/mnt/jbase (cd9660, local, noatime, read-only, verified)
/dev/md1 on /packages/mnt/jkernel64-12.3R3.4 (cd9660, local, noatime, read-only, verified)
/dev/md2 on /packages/mnt/jpfe-X960-12.3R3.4 (cd9660, local, noatime, read-only)
/dev/md3 on /packages/mnt/jdocs-12.3R3.4 (cd9660, local, noatime, read-only, verified)
/dev/md4 on /packages/mnt/jroute-12.3R3.4 (cd9660, local, noatime, read-only, verified)
/dev/md5 on /packages/mnt/jcrypto64-12.3R3.4 (cd9660, local, noatime, read-only, verified)
/dev/md6 on /packages/mnt/jpfe-common-12.3R3.4 (cd9660, local, noatime, read-only)
/dev/md7 on /packages/mnt/jplatform-12.3R3.4 (cd9660, local, noatime, read-only, verified)
/dev/md8 on /packages/mnt/jruntime-12.3R3.4 (cd9660, local, noatime, read-only, verified)
/dev/md9 on /tmp (ufs, asynchronous, local, noatime)
/dev/md10 on /mfs (ufs, asynchronous, local, noatime)
/dev/ad0s1e on /config (ufs, local, noatime)
procfs on /proc (procfs, local, noatime)
/dev/ad1s1f on /var (ufs, local, noatime)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I ran a fsck to get some stats and see what the problem could be since it appears that there is no free space even though the router reports that it has it.```
buraglio@rtr% fsck -y -f /dev/ad1s1f
** /dev/ad1s1f (NO WRITE)
** Last Mounted on /var
** Phase 1 - Check Blocks and Sizes
** Phase 2 - Check Pathnames
** Phase 3 - Check Connectivity
** Phase 4 - Check Reference Counts
** Phase 5 - Check Cyl groups
FREE BLK COUNT(S) WRONG IN SUPERBLK
SALVAGE? no&lt;/p&gt;

&lt;p&gt;605 files, 2202492 used, 7040218 free (786 frags, 879929 blocks, 0.0% fragmentation)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Playing around in the shell presented this error as well```&#34; data-lang=&#34;Playing around in the shell presented this error as well```&#34;&gt;/var: create/symlink failed, no inodes free&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So, it appears as if the /var partition is the issue. On my router /var is mounted as /dev/ad1s1f, so lets unmount this partition and try to fix it. In my experience Juniper will shy away from telling you to do anything in the shell, so do this at your own risk. Rebooting the router would also fix this issue, but I&amp;rsquo;m a form believer that rebooting networking equipment to fix issues is a lazy way to fix problems and will only serve to atrophy any troubleshooting skills you may have.```&lt;/p&gt;

&lt;p&gt;buraglio@rtr% umount -f /var&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Now run fsck again to repair the file system```&#34; data-lang=&#34;Now run fsck again to repair the file system```&#34;&gt;buraglio@rtr% fsck -y -f /dev/ad1s1f
\*\* /dev/ad1s1f
\*\* Last Mounted on /var
\*\* Phase 1 - Check Blocks and Sizes
\*\* Phase 2 - Check Pathnames
\*\* Phase 3 - Check Connectivity
\*\* Phase 4 - Check Reference Counts
\*\* Phase 5 - Check Cyl groups
FREE BLK COUNT(S) WRONG IN SUPERBLK
SALVAGE? yes

605 files, 2203376 used, 7039334 free (782 frags, 879819 blocks, 0.0% fragmentation)

\*\*\*\*\* FILE SYSTEM WAS MODIFIED \*\*\*\*\*&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now that the problematic bits have been repaired, we re-mount the partition```
buraglio@rtr% mount /dev/ad1s1f /var/&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Verify the mount```&#34; data-lang=&#34;Verify the mount```&#34;&gt;buraglio@rtr% mount
/dev/ad0s1a on / (ufs, local, noatime)
devfs on /dev (devfs, local, multilabel)
/dev/md0 on /packages/mnt/jbase (cd9660, local, noatime, read-only, verified)
/dev/md1 on /packages/mnt/jkernel64-12.3R3.4 (cd9660, local, noatime, read-only, verified)
/dev/md2 on /packages/mnt/jpfe-X960-12.3R3.4 (cd9660, local, noatime, read-only)
/dev/md3 on /packages/mnt/jdocs-12.3R3.4 (cd9660, local, noatime, read-only, verified)
/dev/md4 on /packages/mnt/jroute-12.3R3.4 (cd9660, local, noatime, read-only, verified)
/dev/md5 on /packages/mnt/jcrypto64-12.3R3.4 (cd9660, local, noatime, read-only, verified)
/dev/md6 on /packages/mnt/jpfe-common-12.3R3.4 (cd9660, local, noatime, read-only)
/dev/md7 on /packages/mnt/jplatform-12.3R3.4 (cd9660, local, noatime, read-only, verified)
/dev/md8 on /packages/mnt/jruntime-12.3R3.4 (cd9660, local, noatime, read-only, verified)
/dev/md9 on /tmp (ufs, asynchronous, local, noatime)
/dev/md10 on /mfs (ufs, asynchronous, local, noatime)
/dev/ad0s1e on /config (ufs, local, noatime)
procfs on /proc (procfs, local, noatime)
/dev/ad1s1f on /var (ufs, local, noatime)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We should now be able to commit correctly.```
buraglio@rtr% cli
{master}
buraglio@rtr&amp;gt;&lt;/p&gt;

&lt;p&gt;{master}
buraglio@rtr&amp;gt; edit
Entering configuration mode
The configuration has been changed but not committed&lt;/p&gt;

&lt;p&gt;{master}[edit]
buraglio@rtr# commit check
re0:
configuration check succeeds
re1:
configuration check succeeds&lt;/p&gt;

&lt;p&gt;{master}[edit]
buraglio@rtr# commit
re0:
configuration check succeeds
re1:
commit complete
re0:
commit complete&lt;/p&gt;

&lt;p&gt;{master}[edit]
buraglio@rtr#
```And&amp;hellip;.you&amp;rsquo;re done. Hopefully this will help someone fight this problem, I only found a &lt;a href=&#34;http://www.gns3.net/labs/juniper/jncia-junos/operational-monitoring-and-maintenance/&#34;&gt;handful&lt;/a&gt; of &lt;a href=&#34;http://forums.juniper.net/t5/Junos-and-Junosphere/Commit-Errors/td-p/17615&#34;&gt;other references&lt;/a&gt; to it that was useful but it didn&amp;rsquo;t address my exact scenario.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Building FlowVisor on Centos 6 - quick and dirty</title>
      <link>https://forwardingplane.net/post/building-flowvisor-on-centos-6-quick-and-dirty/</link>
      <pubDate>Fri, 05 Jul 2013 10:22:23 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/building-flowvisor-on-centos-6-quick-and-dirty/</guid>
      <description>&lt;p&gt;I had the need to build a FlowVisor instance under CentOS.  Since nearly all of the docs I could find were for debian, I threw this together.  I utilized this &lt;a href=&#34;http://groups.geni.net/geni/wiki/FlowVisor&#34;&gt;GENI doc&lt;/a&gt; and the &lt;a href=&#34;https://github.com/OPENNETWORKINGLAB/flowvisor/wiki/Installation-from-Source&#34;&gt;github docs&lt;/a&gt; as a simple reference.  This is the quick and dirty method I used: Install the prerequisites:```
sudo yum -y install ant eclipse java-1.6.0-openjdk.x86_64 git
sudo yum -y groupinstall &amp;ldquo;Development Tools&amp;rdquo;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Create my standard directories:```&#34; data-lang=&#34;Create my standard directories:```&#34;&gt;mkdir /services
cd /services
git clone git://github.com/OPENNETWORKINGLAB/flowvisor.git&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Navigate, add user and install```
cd flowvisor
adduser flowvisor
sudo make fvuser=flowvisor fvgroup=flowvisor install&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Here is the relativde output I saw:```&#34; data-lang=&#34;Here is the relativde output I saw:```&#34;&gt;\[root@collector flowvisor\]# sudo make fvuser=flowvisor fvgroup=flowvisor install
ant
Buildfile: build.xml

init:
\[mkdir\] Created dir: /services/flowvisor/build
\[mkdir\] Created dir: /services/flowvisor/build.tests

compile:
\[javac\] Compiling 239 source files to /services/flowvisor/build
\[javac\] Note: /services/flowvisor/src/org/flowvisor/config/LoadConfig.java uses or overrides a deprecated API.
\[javac\] Note: Recompile with -Xlint:deprecation for details.

dist:
\[mkdir\] Created dir: /services/flowvisor/dist
\[jar\] Building jar: /services/flowvisor/dist/flowvisor.jar
\[jar\] Building jar: /services/flowvisor/dist/flowvisor.jar

BUILD SUCCESSFUL
Total time: 3 seconds
./scripts/install-script.sh
Using source dir: ./scripts/..
Installation prefix (/usr/local):
Install to different root directory ()
Installing FlowVisor into /usr/local with prefix=/usr/local as user/group flowvisor:flowvisor
Updating fvctl-xml.sh to fvctl-xml
Updating fvconfig.sh to fvconfig
Updating flowvisor.sh to flowvisor
Updating envs.sh to envs
Creating directories
Creating /usr/local/bin
Creating /usr/local/sbin
Creating /usr/local/libexec/flowvisor
Creating /usr/local/share/man/man1
Creating /usr/local/share/man/man8
Creating /usr/local/share/doc/flowvisor
Creating /usr/local/share/db/flowvisor
Creating /etc/flowvisor (owned by user=flowvisor  group=flowvisor)
Installing scripts
Installing SYSV startup script (not enabled by default)
Installing jars
Installing flowvisor.jar
Installing manpages
Installing FlowVisorDB
Installing configs
Installing Logrotate config
Installing documentation
Linking fvctl to fvctl-json
ln: creating symbolic link \`fvctl&amp;#39;: File exists
Generating a default config FlowVisor config
Trying to generate SSL Server Key with passwd from scripts/envs.sh
Generating cert with common name == flowvisor
keytool error: java.lang.Exception: Key pair not generated, alias &amp;lt;mykey&amp;gt; already exists
Enter password for account &amp;#39;fvadmin&amp;#39; on the flowvisor:
Generating default config in db
Outputing config file /etc/flowvisor/config.json&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Start the controller:```
sudo /etc/init.d/flowvisor start&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Output from controller starting:```&#34; data-lang=&#34;Output from controller starting:```&#34;&gt;Starting flowvisor with the configuration stored in DB
If DB unpopulated, load config using &amp;#39;fvconfig load config.json&amp;#39;
\[root@collector flowvisor\]#
Message from syslogd@collector at Jul  3 08:49:51 ...
1&amp;gt;Jul  3 08:49:51 flowvisor: ERROR none : log level enabled: CRIT

Message from syslogd@collector at Jul  3 08:49:51 ...
1&amp;gt;Jul  3 08:49:51 flowvisor: ERROR none : log level enabled: ALERT

Message from syslogd@collector at Jul  3 08:49:51 ...
1&amp;gt;Jul  3 08:49:51 flowvisor: WARN none : log level enabled: WARN
``````
This yields a &amp;#34;working&amp;#34; flow visor.

Lock it down with a password:
``````
yum -y install pwgen
test -f /etc/flowvisor.passwd || sudo sh -c &amp;#39;pwgen -sB 24 &amp;gt; /etc/flowvisor.passwd&amp;#39;
service flowvisor restart&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>VMWare ESXi CLI reference</title>
      <link>https://forwardingplane.net/post/vmware-esxi-cli-reference/</link>
      <pubDate>Sun, 30 Jun 2013 14:24:51 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/vmware-esxi-cli-reference/</guid>
      <description>&lt;p&gt;One of my biggest complaints about VMware is that it is an enterprise application. It has historically catered to the masses, which I completely understand, but those of us that aren&amp;rsquo;t a fortune 500 company are figuratively and operationally shoved into a corner and forced to find hackish ways of doing things to work around the enterprise nature. One really, really good example of this is OS dependency. I hated architecture dependencies back in the old days (x86, SPARC, PPC) and I absolutely despise things that are OS platform dependent now.  It&amp;rsquo;s inconvenient and just plain sucks for anyone using anything but that required platform. This goes for anything, mac dependent, MS dependent, unix dependent, whatever. I don&amp;rsquo;t discriminate in my idealism.  While I realize it is an impossible, idealistic expectation,  I back up my stance 100% regardless. That being said, one of the most irritating of those in recent memory has been VMware. Managing the VMWare ESXi instances that I run for both lab and production work is a pain. Since I&amp;rsquo;m not really a sysadmin or a virtualization engineer my knowledge of this stuff is surely limited I may be going about this in a non-optimal way, but until recently it has required a one-off host or VM running windows with the client to do anything useful. Apparently this has changed with the pay version in 5.something adding a web interface.  Unfortunately this isn&amp;rsquo;t an option at this time for me, it&amp;rsquo;s cost prohibitive. So, when I found it necessary to do some management without a windows VM or host, I was pleasantly surprised to find that I can do simple tasks via the SSH CLI. was able to query power state, start, stop, etc. using simple CLI tools. Now, these are all documented at the VMware KB, but I wanted to throw together a quick reference sheet for all of them in one place so I started compiling it &lt;a href=&#34;http://www.forwardingplane.net/unix/vmware-esxi-cli-reference/&#34;&gt;here&lt;/a&gt;.  Please feel free to shoot over any additions or quick tips that should be on there. This is just the tip of the iceberg, I suspect (or maybe I&amp;rsquo;m just going about my VMware management all wrong; I&amp;rsquo;m open to that as well and suggestions on how to remedy). The most useful for me so far have been inventory and power related.```
List all VMs:
vim-cmd vmsvc/getallvms&lt;/p&gt;

&lt;p&gt;List power state of VM:
vim-cmd vmsvc/power.getstate &lt;VM ID&gt;&lt;/p&gt;

&lt;p&gt;Power on VM
vim-cmd vmsvc/power.on &lt;VM ID&gt;&lt;/p&gt;

&lt;p&gt;Power off VM
vim-cmd vmsvc/power.off &lt;VM ID&gt;&lt;/p&gt;

&lt;p&gt;```&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Broadcast input with iTerm</title>
      <link>https://forwardingplane.net/post/broadcast-input-with-iterm/</link>
      <pubDate>Sat, 22 Jun 2013 15:56:12 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/broadcast-input-with-iterm/</guid>
      <description>&lt;p&gt;As much as I like to think I automate everything, I&amp;rsquo;m pretty bad at writing code to make my life easier since it tends to take me longer to write the code and it tends to make be a bit grumpy (this is eomthing I&amp;rsquo;m fixing by learning as much code dev as I can during my limited spare time).  However, I like to think I can be fairly smart about working around my limited programming skills (think boba fett rather than jedi) by using the tools available to common folk.  Enter &lt;a href=&#34;http://www.iterm2.com/#/section/home&#34;&gt;iTerm2&lt;/a&gt;. Last I looked at this is was buggy and unstable. &amp;hellip;.that was years and years ago. This has changed.  &lt;a href=&#34;http://www.iterm2.com/#/section/home&#34;&gt;&lt;img src=&#34;http://www.forwardingplane.net/wp-content/uploads/2013/06/iTerm.png&#34; alt=&#34;iTerm&#34; /&gt;&lt;/a&gt; iTerm has been vastly improved.   In fact, after someone suggested I look at it again, it took all of about 10 minutes for me to go all in as mt primary terminal.  The list of features is good, split pane, tabs and a wealth of customization options.  One of the big weinners for me, though, goes back to my original statement.   Being able to do broadcast input across panes, tabs or windows is fantastically useful.  If you manage systems, need to look at statistics at the same time on routers or switches or just want to do some quick and dirty &amp;ldquo;automation&amp;rdquo;, this is the ticket. I like it so much I did a quick screencast on how to do basic broadcast input.  It&amp;rsquo;s really straightforward.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Scripting the build of OpenDayight Controller under CentOS</title>
      <link>https://forwardingplane.net/post/scripting-the-build-of-opendayight-controller-under-centos/</link>
      <pubDate>Fri, 03 May 2013 21:45:41 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/scripting-the-build-of-opendayight-controller-under-centos/</guid>
      <description>

&lt;p&gt;&lt;a href=&#34;https://twitter.com/blinken_lichten&#34;&gt;Jon Langemak&lt;/a&gt; has a great write up on &lt;a href=&#34;http://www.dasblinkenlichten.com/installing-opendaylight-on-centos/&#34;&gt;building the OpenDaylight controller under CentOS&lt;/a&gt;. Since I&amp;rsquo;ll have to do this a bunch of times, I though tI&amp;rsquo;d take what he so generously put online and build a very rudimentary script for deploying ODC under CentOS. The prerequisites are that you already have an account and ssh key at the &lt;a href=&#34;https://git.opendaylight.org/&#34;&gt;OpenDaylight GIT repo&lt;/a&gt; and that you &lt;a href=&#34;http://www.revsys.com/writings/quicktips/turn-off-selinux.html&#34;&gt;disable SELinux&lt;/a&gt;. Here is the script:```
#!/bin/bash&lt;/p&gt;

&lt;h1 id=&#34;install-opendaylight-controller-under-centos&#34;&gt;Install Opendaylight controller under CentOS&lt;/h1&gt;

&lt;h1 id=&#34;by-nick-at-buraglio-com-http-www-twitter-com-buraglio&#34;&gt;by nick [at] buraglio.com &lt;a href=&#34;http://www.twitter.com/buraglio&#34;&gt;http://www.twitter.com/buraglio&lt;/a&gt;&lt;/h1&gt;

&lt;h1 id=&#34;http-www-forwardingplane-net&#34;&gt;&lt;a href=&#34;http://www.forwardingplane.net&#34;&gt;http://www.forwardingplane.net&lt;/a&gt;&lt;/h1&gt;

&lt;h1 id=&#34;based-on-post-by-jon-langemak-http-www-twitter-com-blinken-lichten&#34;&gt;Based on post by Jon Langemak (&lt;a href=&#34;http://www.twitter.com/blinken_lichten&#34;&gt;http://www.twitter.com/blinken_lichten&lt;/a&gt;)&lt;/h1&gt;

&lt;h1 id=&#34;http-www-dasblinkenlichten-com-installing-opendaylight-on-centos&#34;&gt;&lt;a href=&#34;http://www.dasblinkenlichten.com/installing-opendaylight-on-centos/&#34;&gt;http://www.dasblinkenlichten.com/installing-opendaylight-on-centos/&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;yum=&amp;ldquo;/usr/bin/yum&amp;rdquo;
servivce=&amp;ldquo;/sbin/service&amp;rdquo;
chkconfig=&amp;ldquo;/sbin/chkconfig&amp;rdquo;&lt;/p&gt;

&lt;p&gt;echo &amp;ldquo;************************&amp;ldquo;
echo &amp;ldquo;************************&amp;ldquo;
echo &amp;ldquo;Disable SELINUX before starting this process&amp;rdquo;
echo &amp;ldquo;Edit the /etc/selinux/config file and restart the server&amp;rdquo;
echo &amp;ldquo;************************&amp;ldquo;
echo &amp;ldquo;************************&amp;ldquo;
echo &amp;ldquo;Change the username in the GIT section to your own&amp;rdquo;
echo &amp;ldquo;you&amp;rsquo;ll need to create it and upload&amp;rdquo;
echo &amp;ldquo;your ssh key at git.opendaylight.org&amp;rdquo;
echo &amp;ldquo;************************&amp;ldquo;
echo &amp;ldquo;************************&amp;ldquo;&lt;/p&gt;

&lt;p&gt;echo &amp;ldquo;************************&amp;ldquo;
echo &amp;ldquo;Installing Development tools and other deps&amp;rdquo;
echo &amp;ldquo;************************&amp;ldquo;
yum install -y wget vim java ant python eclipse-platform git
yum groupinstall -y “Development tools”A&lt;/p&gt;

&lt;p&gt;echo &amp;ldquo;************************&amp;ldquo;
echo &amp;ldquo;Downloading and installing maven&amp;rdquo;
echo &amp;ldquo;************************&amp;ldquo;
wget &lt;a href=&#34;http://www.poolsaboveground.com/apache/maven/maven-3/3.0.5/binaries/apache-maven-3.0.5-bin.zip&#34;&gt;http://www.poolsaboveground.com/apache/maven/maven-3/3.0.5/binaries/apache-maven-3.0.5-bin.zip&lt;/a&gt;
unzip apache-maven-3.0.5-bin.zip -d /usr/share/
ln -s /usr/share/apache-maven-3.0.5/bin/mvn /usr/bin/mvn&lt;/p&gt;

&lt;p&gt;echo &amp;ldquo;************************&amp;ldquo;
echo &amp;ldquo;Downloading GIT code&amp;rdquo;
echo &amp;ldquo;************************&amp;ldquo;&lt;/p&gt;

&lt;h1 id=&#34;change-the-username-here-to-your-own-you-ll-need-to-create-it-and-upload&#34;&gt;Change the username here to your own, you&amp;rsquo;ll need to create it and upload&lt;/h1&gt;

&lt;h1 id=&#34;your-ssh-key-at-git-opendaylight-org&#34;&gt;your ssh key at git.opendaylight.org&lt;/h1&gt;

&lt;p&gt;mkdir -p /services/opendaylight/
cd /services/opendaylight/
git clone &lt;a href=&#34;https://buraglio@git.opendaylight.org/gerrit/p/controller.git&#34;&gt;https://buraglio@git.opendaylight.org/gerrit/p/controller.git&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;echo &amp;ldquo;************************&amp;ldquo;
echo &amp;ldquo;Building OpenDaylight Controller with Maven&amp;rdquo;
echo &amp;ldquo;************************&amp;ldquo;
cd controller/opendaylight/distribution/opendaylight/
mvn clean install&lt;/p&gt;

&lt;p&gt;echo &amp;ldquo;************************&amp;ldquo;
echo &amp;ldquo;Configure Java Env variables&amp;rdquo;
echo &amp;ldquo;************************&amp;ldquo;
export JAVA_HOME=/usr/lib/jvm/java-1.6.0-openjdk.x86_64
echo &amp;ldquo;JAVA_HOME=/usr/lib/jvm/java-1.6.0-openjdk.x86_64&amp;rdquo; &amp;gt;&amp;gt; /etc/environment&lt;/p&gt;

&lt;p&gt;echo &amp;ldquo;************************&amp;ldquo;
echo &amp;ldquo;Load the controller&amp;rdquo;
echo &amp;ldquo;************************&amp;ldquo;
cd /services/opendaylight/controller/opendaylight/distribution/opendaylight/target/distribution.opendaylight-0.1.0-SNAPSHOT-osgipackage/opendaylight&lt;/p&gt;

&lt;p&gt;echo &amp;ldquo;************************&amp;ldquo;
echo &amp;ldquo;Start OpenDaylight OF controller&amp;rdquo;
echo &amp;ldquo;************************&amp;ldquo;
./run.sh&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Once up and running, it&#39;s pretty trivial to point something like an HP switch at the controller. For an HP5400, just decide what VLAN(s) you want to use OpenFlow on. I chose 999 as my test VLAN.```&#34; data-lang=&#34;Once up and running, it&#39;s pretty trivial to point something like an HP switch at the controller. For an HP5400, just decide what VLAN(s) you want to use OpenFlow on. I chose 999 as my test VLAN.```&#34;&gt;sw-5400-of# conf t
sw-5400-of(config)# vlan 999 name test-openflow999
sw-5400-of(vlan-999)# untagged A3-A4 
sw-5400-of(vlan-999)# exit
sw-5400-of(config)# openflow vlan 999
sw-5400-of(openFlow vlan-999)# enable
sw-5400-of(openFlow vlan-999)# controller &amp;#34;tcp:10.17.4.22:6633&amp;#34;
sw-5400-of(openFlow vlan-999)# exit       
sw-5400-of(openFlow)# exit
sw-5400-of(config)# 
w-5400-of(config)# exit
sw-5400-of# show openflow 

sw-5400-of# show openflow 

 Openflow Configuration

  Openflow aggregate VLANs \[Disabled\] :           
  Openflow aggregate management VlanId \[0\] : 0     
  Openflow second aggregate management VlanId \[0\] : 0     
  Openflow aggregate configuration VlanId \[0\] : 0     

  VID  State HW  Active controller Pseudo-URL                       Conn
  ---- ----- --- -------------------------------------------------- ----
  666  Off   On                                                     No  
  999  On    On  tcp:10.17.4.22:6633                                Yes&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;From here we can see the box in the openflow controller.    &lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.forwardingplane.net/wp-content/uploads/2013/05/Screen-Shot-2013-05-03-at-4.20.03-PM.png&#34;&gt;&lt;img src=&#34;http://www.forwardingplane.net/wp-content/uploads/2013/05/Screen-Shot-2013-05-03-at-4.20.03-PM.png&#34; alt=&#34;Screen Shot 2013-05-03 at 4.20.03 PM&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  I&amp;rsquo;m still having some issues pushing flows, I&amp;rsquo;m sure I can work it out but here is a quick screencast of me trying to push a flow.  More posts will be added as soon as I can get the flows to push correctly. I suspect it is user error and I just need to read the docs.  More to come for sure.  This controller is very, very slick.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Basic reference openflow controller VMs running in CentOS 6 for KVM.</title>
      <link>https://forwardingplane.net/post/basic-reference-openflow-controller-vms-running-in-centos-6-for-kvm/</link>
      <pubDate>Fri, 26 Apr 2013 04:56:07 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/basic-reference-openflow-controller-vms-running-in-centos-6-for-kvm/</guid>
      <description>&lt;p&gt;I had been working, off and on, on a how-to for building the &lt;a href=&#34;http://www.opendaylight.org/&#34;&gt;daylight openflow controller&lt;/a&gt; under CentOS.  Most openflow docs and dev are done under ubuntu or debian, and while those are both fantastic alternatives, there are a huge number of folks that will want or need to use RHEL or CentOS. So, seeing as that is the case, having someone be mindful of that is important.  When I saw the &lt;a href=&#34;http://www.dasblinkenlichten.com/installing-opendaylight-on-centos/&#34;&gt;write up&lt;/a&gt; by &lt;a href=&#34;https://twitter.com/blinken_lichten&#34;&gt;Jon Langemak&lt;/a&gt;, I scrapped my attempt at a how-to since his was so much better. If you&amp;rsquo;re not following Jon and reading his blog, you should be.  He&amp;rsquo;s a sharp guy with interesting things to say. &lt;a href=&#34;http://www.forwardingplane.net/wp-content/uploads/2013/04/projectfloodlight-logo-header.png&#34;&gt;&lt;img src=&#34;http://www.forwardingplane.net/wp-content/uploads/2013/04/projectfloodlight-logo-header.png&#34; alt=&#34;projectfloodlight-logo-header&#34; /&gt;&lt;/a&gt; That got me thinking about references and resources, and I decided that I would take a few of the things I had been working on on my home lab and make them available to the masses.  I&amp;rsquo;m a fan of importable base VMs.  So, seeing that I am working on testing openflow controllers, it made sense in my [constantly racing] mind to make the reference, base level VMs available.  If anyone is interested in the &lt;a href=&#34;http://www.projectfloodlight.org/floodlight/&#34;&gt;floodlight controller&lt;/a&gt; running under CentOS 6.3 built using the method documented &lt;a href=&#34;http://www.forwardingplane.net/2013/02/building-a-floodlight-openflow-controller-on-centos-6/&#34; title=&#34;Building a Floodlight OpenFlow controller on CentOS 6&#34;&gt;here&lt;/a&gt;, a KVM image is now available to download from &lt;a href=&#34;http://www.forwardingplane.net/wp-content/uploads/vm-images/centos-floodlight-template.tbz&#34;&gt;here&lt;/a&gt;.  It is, as stated, a KVM image, created by using the method I documented in &lt;a href=&#34;http://www.forwardingplane.net/2013/03/centos-kvm-install-quick-start-to-a-vm/&#34; title=&#34;CentOS KVM Install – Quick Start to a VM&#34;&gt;this post&lt;/a&gt; a few months ago.    There is a readme file in the archive wth basic instructions.  You&amp;rsquo;ll need a basic understanding of &lt;a href=&#34;http://www.linux-kvm.org/page/Main_Page&#34;&gt;KVM&lt;/a&gt; to make it work, or you can try to convert it to something else like vmware, XEN or virtualbox. I&amp;rsquo;ll be adding one of these soon for &lt;a href=&#34;http://www.opendaylight.org/&#34;&gt;daylight&lt;/a&gt; as well.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>CentOS KVM Install - Quick Start to a VM</title>
      <link>https://forwardingplane.net/post/centos-kvm-install-quick-start-to-a-vm/</link>
      <pubDate>Sat, 02 Mar 2013 01:12:02 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/centos-kvm-install-quick-start-to-a-vm/</guid>
      <description>&lt;p&gt;I am a network engineer by profession, but with the proliferation of SDN and OpenFlow, I have had to spend a lot of time re-learning a lot of system admin skills that I&amp;rsquo;d shelved years ago.  Now, I&amp;rsquo;ve been a virtualization user forever. From &lt;a href=&#34;http://www.vmware.com&#34;&gt;VMware&lt;/a&gt; (Fusion, ESX), &lt;a href=&#34;https://www.virtualbox.org&#34;&gt;VirtualBox&lt;/a&gt;, to &lt;a href=&#34;www.parallels.com&#34;&gt;Parallels&lt;/a&gt;, I&amp;rsquo;ve used them at least in testing if not in production environments.  I&amp;rsquo;d not really spent any mentionable amount of time with &lt;a href=&#34;http://www.xen.org&#34;&gt;XEN&lt;/a&gt;, &lt;a href=&#34;http://www.qemu.org&#34;&gt;qEMU&lt;/a&gt; or &lt;a href=&#34;www.linux-kvm.org&#34;&gt;KVM&lt;/a&gt;, but some projects I was working on suggested it for the virtualization mechanism, so I figured I&amp;rsquo;d try to pick it up.  I think the hosting provider  of this blog is using it to provide the VPS that this site runs on, so it is clearly production quality.  In looking around for a straightforward how-to, a few things became obvious pretty quickly: KVM is very robust. KVM and qEMU have got a lot of documentation, but not all of it is straightforward. They have a lot of pieces needed to make it work efficiently. It wasn&amp;rsquo;t a plug and run experience, by any means.  I wanted a headless, remotely manageable system that ran on a bare minimum install (i.e. no GUI).  After a late evening of hacking at it,  here is what I finally had to do to get it running and build a functional VM on a fresh install of CentOS 6.3. Install all the dependancies.  And there were many.  Coming from using the VirtualBox CLI, little things that I expected didn&amp;rsquo;t work if I didn&amp;rsquo;t have this or that installed.```
yum install -y qemu-kvm.x86_64 qemu-kvm-tools.x86_64 &lt;br /&gt;
kvm libvirt bridge-utils tunctl python-virtinst.noarch avahi&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Restart the deamons```&#34; data-lang=&#34;Restart the deamons```&#34;&gt;/etc/init.d/messagebus restart
/etc/init.d/avahi-daemon restart
/etc/init.d/libvirtd restart&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Make the new daemons start at boot:```
/sbin/chkconfig messagebus on
/sbin/chkconfig avahi-daemon on&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
I want to bridge rather than NAT.  My VMs need to have a public (or same LAN segment) address as the rest of the hosts for external management and availability of inbound services.  For this, we need to adjust the interfaces.  I want to run the bridge on a second interface and keep the host system management on a dedicated interface.

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;vi /etc/sysconfig/network-scripts/ifcfg-eth1&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Your file should look something like this when done:```&#34; data-lang=&#34;Your file should look something like this when done:```&#34;&gt;DEVICE=&amp;#34;eth1&amp;#34;
HWADDR=&amp;#34;c0:ff:ee:c0:ff:ee&amp;#34; # (leave this as your MAC address)
NM\_CONTROLLED=&amp;#34;yes&amp;#34;
 BRIDGE=br0
 ONBOOT=&amp;#34;yes&amp;#34;
UUID=&amp;#34;a9c26927-7650-42e9-a86a-1ae1227eac4b&amp;#34; #leave this as your UUID)
``````
vi /etc/sysconfig/network-scripts/ifcfg-br0&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Your file should look something like this when done:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DEVICE=&amp;quot;br0&amp;quot;
TYPE=&amp;quot;Bridge&amp;quot;
BOOTPROTO=&amp;quot;static&amp;quot;
IPADDR=&amp;quot;10.10.10.50&amp;quot; # Use your own IP address
NETMASK=&amp;quot;255.255.255.128&amp;quot;
GATEWAY=&amp;quot;10.10.10.1&amp;quot;  # Provide your gateway
IPV6INIT=&amp;quot;yes&amp;quot;
IPV6\_AUTOCONF=&amp;quot;yes&amp;quot;
NM\_CONTROLLED=&amp;quot;yes&amp;quot;
ONBOOT=&amp;quot;yes&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Restart the network to make it active.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;service network restart
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You&amp;rsquo;re going to use virt tools and virsh to manipulate the guests.  I tried it a few other ways and this seems far more supportable.  I wanted to install a CentOS 6.3 guest, I grabbed the install media from a &lt;a href=&#34;http://cosmos.cites.illinois.edu/pub/centos/6.3/isos/x86_64/&#34;&gt;local mirror&lt;/a&gt;.  I have a volume mounted as /services that I keep stuff in.```
mkdir /services/vm/template-host
cd /services/vm/template-host
wget &lt;a href=&#34;http://cosmos.cites.illinois.edu/pub/centos/6.3/isos/x86_64/CentOS-6.3-x86_64-bin-DVD1.iso&#34;&gt;http://cosmos.cites.illinois.edu/pub/centos/6.3/isos/x86_64/CentOS-6.3-x86_64-bin-DVD1.iso&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Now use the virt-install command to boot the system with the following parameters: 2G of RAM 50G disk named disk.img Console redirected to a VNC instance on port 5901 Network interface attached to br0 4 CPUs CDROM points to install image```&#34; data-lang=&#34;Now use the virt-install command to boot the system with the following parameters: 2G of RAM 50G disk named disk.img Console redirected to a VNC instance on port 5901 Network interface attached to br0 4 CPUs CDROM points to install image```&#34;&gt;virt-install --name template-host --ram 2048 --disk /home/vm/template-host/disk.img,size=50 \\
--graphics vnc,port=5901 --network bridge=br0 --vcpus=4 --os-type=linux \\
--cdrom=/home/vm/Install\_Media/CentOS-6.3-x86\_64-bin-DVD1.iso&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now, to connect to the console, you&amp;rsquo;ll need to tunnel VNC over ssh.  This can be adjusted, but that&amp;rsquo;s outside of the scope of this. I like to redirect real port numbers for my own sanity.```
ssh -N -p 22 -c 3des buraglio@vmhost -L 5901/localhost/5901&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-The above command will redirect localhost port 5901 to port 5901 on the host vmhost Connect to the VNC server:&#34; data-lang=&#34;The above command will redirect localhost port 5901 to port 5901 on the host vmhost Connect to the VNC server:&#34;&gt;[![Screen Shot 2013-03-01 at 2.00.37 PM](http://www.forwardingplane.net/wp-content/uploads/2013/03/Screen-Shot-2013-03-01-at-2.00.37-PM.png)](http://www.forwardingplane.net/wp-content/uploads/2013/03/Screen-Shot-2013-03-01-at-2.00.37-PM.png)

Once connected you should drop right into the console of the KVM instance. Install as a normal system at that point.

Once installed It&amp;#39;ll appear as a normal host console.

[![Screen Shot 2013-03-01 at 2.01.21 PM](http://www.forwardingplane.net/wp-content/uploads/2013/03/Screen-Shot-2013-03-01-at-2.01.21-PM.png)](http://www.forwardingplane.net/wp-content/uploads/2013/03/Screen-Shot-2013-03-01-at-2.01.21-PM.png)

I found virsh to be the most useful for manipulating the virtual machine.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;[root@behemoth Install_Media]# virsh list
Id            Name                                      State&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;9              template-host                         running
```Helpful commands I found after 30 minutes of poking around and playing with virsh: virsh list &amp;ndash;show the list of virtual machines virsh destroy &lt;vm name&gt; &amp;ndash;hard shut down a host (I believe) virsh undefine &lt;vm name&gt; &amp;ndash;remove the VM from registration &amp;ndash;this one was hard for me to find.   &lt;a href=&#34;http://www.forwardingplane.net/unix/kvm-virsh-command-referenc/&#34; title=&#34;KVM virsh command reference&#34;&gt;Here&lt;/a&gt; is a complete list of the commands.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Watch out, Gigamon (and others), Arista is bringing their A game</title>
      <link>https://forwardingplane.net/post/watch-out-gigamon-and-others-arista-is-bringing-their-a-game/</link>
      <pubDate>Sat, 16 Feb 2013 03:11:20 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/watch-out-gigamon-and-others-arista-is-bringing-their-a-game/</guid>
      <description>&lt;p&gt;It&amp;rsquo;s no secret that I&amp;rsquo;m a fan of the model &lt;a href=&#34;http://www.aristanetworks.com&#34;&gt;Arista Networks&lt;/a&gt; is using to make gear and provide innovative services and products. In my opinion, they&amp;rsquo;re changing the landscape of campus and data center networking gear. I&amp;rsquo;m always a fan of the little guy trying to change the world and this falls under that category. For those that don&amp;rsquo;t know, Arista Networks is a &amp;ldquo;hardware&amp;rdquo; networking company that is using merchant silicon wrapped in their custom linux based operating system (which is very much like IOS).&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.forwardingplane.net/wp-content/uploads/2013/02/ARISTA-TAP.jpg&#34;&gt;&lt;img src=&#34;http://www.forwardingplane.net/wp-content/uploads/2013/02/ARISTA-TAP-1024x768.jpg&#34; alt=&#34;ARISTA-TAP&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This model does a few things. It takes the time it would normally take a vendor to engineer and spin an ASIC, typically 1-3 years) and completely removes it. Instead, they rely on silicon manufacturers like Intel and &lt;a href=&#34;http://www.fulcrummicro.com&#34;&gt;Fulcrum&lt;/a&gt; for their already engineered and tested chips. Arista is generally touted as an extremely low latency box and has been widely deployed in the financial industry because of this. However, they&amp;rsquo;re not a one trick pony, not by any means. Their open architecture and OS allows for &lt;strong&gt;heavy&lt;/strong&gt; customization. In fact, unlike most others, it&amp;rsquo;s encouraged. Arista has put together an &lt;a href=&#34;https://eos.aristanetworks.com/home.php&#34;&gt;ecosystem for extending and expanding&lt;/a&gt; their &lt;a href=&#34;https://eos.aristanetworks.com/2011/03/eos-so-what-is-it/&#34;&gt;EOS&lt;/a&gt; networking operating system. Want something added to the CLI? Easy, it&amp;rsquo;s all python and can be changed on-box and submitted back to the community. They also have a very, very slick internal mechanism called the sysdb, but that&amp;rsquo;s another blog post altogether.   None of this is really new. Folks have been using merchant silicon forever. What is new and refreshing is the open nature of it. Additionally, the exclusive use of merchant silicon is something [I believe] is now in this class of hardware. With the open nature of this platform, it also lends itself well to the OpenFlow movement in that it&amp;rsquo;s essentially a linux box on well documented hardware of which the vendor is encouraging modification. In addition, it is a well tested data center product. I&amp;rsquo;m calling it now, this platform is going to go places in it&amp;rsquo;s market. For the newest addition to the capabilities portfolio, this is where it really gets interesting. As of 2/13/2013 Arista has added some very &lt;a href=&#34;http://www.aristanetworks.com/en/news/pressrelease/532-pr-20130212-01&#34;&gt;compelling tap aggregation options&lt;/a&gt;. What this means, is that you can now aggregate Nx1 or 10G at 40G, then symmetrically hash that across another 10G array to an IDS cluster. Why is this important? Monitoring fat links. Have some 100G? Good luck finding a security mechanism to watch that.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.forwardingplane.net/wp-content/uploads/2013/02/ARISTA-TAP.png&#34;&gt;&lt;img src=&#34;http://www.forwardingplane.net/wp-content/uploads/2013/02/ARISTA-TAP.png&#34; alt=&#34;ARISTA TAP&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Until now the only options for this are players like &lt;a href=&#34;http://www.gigamon.com&#34;&gt;Gigamon&lt;/a&gt;, &lt;a href=&#34;http://www.cpacket.com&#34;&gt;cPacket&lt;/a&gt; and maybe &lt;a href=&#34;http://www.mrv.com&#34;&gt;MRV&lt;/a&gt;. All are very expensive and one-off solutions. Arista offers a standard ethernet switch that can be managed by an existing networking team, integrated into existing network tools and maintained like any other router or switch. OpEx is a wash. Capital expenditure is standard [probably cheaper] than a normal Layer2 switch. It looks JUST like IOS, so the old networking guy that hates change will only complain a little that it&amp;rsquo;s not a blue box with a bridge on it. This may seem like a small deal, but the implications for passive security monitoring are huge. This feature alone will have a trickle down effect over the next few years since it&amp;rsquo;s something that is only recently being exercised in enterprise worlds. I suspect this will also have a very large impact to gigamon, who is really the current industry leader in this corner of the market, but is priced well beyond what many can afford. Arista can now do the symmetric hashing on layer2, layer3 or layer4 parameters. ACL support is also coming, although I&amp;rsquo;ve not seen it work like I have the hashing.   Oh, you want to know how to do it? =) It currently doesn&amp;rsquo;t exist in the CLI, but here is basically how it&amp;rsquo;s done. Thanks to an awesome Arista rep, the heavy lifting of parsing through the Acons interface is all condensed to a simple script. from the CLI: Log in and enable.```
7150-Source#bash
Arista Networks EOS shell
[arista@7150-Source ~]$ cd /mnt/flash&lt;/p&gt;

&lt;p&gt;[arista@7150-Source ~]$vi set_hash.sh
#!/bin/ti
rm /mnt/flash/set_hash_log.txt
cat &amp;lt;&amp;lt; EOF | Acons FocalPointV2 &amp;gt;&amp;gt; /mnt/flash/set_hash_log.txt 2&amp;gt;&amp;amp;1
from FmApi import *
fmDbgWriteRegisterField(0,0,0,0,&amp;ldquo;FM6000_HASH_LAYER3_PROFILE&amp;rdquo;,&amp;ldquo;SymmetrizeL3&amp;rdquo;,1)
fmDbgWriteRegisterField(0,0,0,0,&amp;ldquo;FM6000_HASH_LAYER3_PROFILE&amp;rdquo;,&amp;ldquo;SymmetrizeL4&amp;rdquo;,1)
fmDbgWriteRegisterField(0,0,0,0,&amp;ldquo;FM6000_HASH_LAYER2_KEY_PROFILE&amp;rdquo;,&amp;ldquo;SymmetrizeMAC&amp;rdquo;,1)
EOF
exit 0&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Done. This, of course, doesn&#39;t include any of the port channel and monitor interface configuration, but if you&#39;re this deep, you probably know how to do that already. If you&#39;d like to dump this to a log, add the following lines to the end of the script before the &#34;EOF&#34;```&#34; data-lang=&#34;Done. This, of course, doesn&#39;t include any of the port channel and monitor interface configuration, but if you&#39;re this deep, you probably know how to do that already. If you&#39;d like to dump this to a log, add the following lines to the end of the script before the &#34;EOF&#34;```&#34;&gt;fmDbgDumpRegisterV2(0,0,0,&amp;#34;FM6000\_HASH\_LAYER2\_KEY\_PROFILE&amp;#34;)
fmDbgDumpRegisterV2(0,0,0,&amp;#34;FM6000\_HASH\_LAYER3\_PROFILE&amp;#34;)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;*As the CLI bits become available in EOS 4.12, this post will be amended to the more supportable way of managing this awesome new feature.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Building a Floodlight OpenFlow controller on CentOS 6</title>
      <link>https://forwardingplane.net/post/building-a-floodlight-openflow-controller-on-centos-6/</link>
      <pubDate>Mon, 04 Feb 2013 13:10:24 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/building-a-floodlight-openflow-controller-on-centos-6/</guid>
      <description>&lt;p&gt;A bit of back history: I came from BSD land. I was a FreeBSD user from way back in the 1990s. BSD land is a land of secure boxes and very high uptimes. It&amp;rsquo;s also a land of arguably clunky package support, a lot of compiling by hand and these days, not nearly as encompassing package and network tuning support. &lt;a href=&#34;http://www.forwardingplane.net/2011/06/better-support-for-linux-and-annoyed-about-it/ &amp;quot;Better support for Linux (and annoyed about it&#34;&gt;I decided to move to Linux&lt;/a&gt;&amp;rdquo;) a while ago, reluctantly, and chose Debian as my flavor of choice. I do love debian, however, I very quiuckly realized that even debian is a bit of a fringe OS build of Linux. Commercial support is nearly all based on RHEL. Folks that run RHEL also run CentOS. We run both in my day job. About a year ago to I, once again, decided I needed to learn CentOS. There are a lot of posts about building floodlight as an openflow controller. I used this tutorial &lt;a href=&#34;http://networkstatic.net/floodlight-openflow-controller-gui-applet/&#34;&gt;Brent Salisbury did&lt;/a&gt; to build mine. There is a good one on the &lt;a href=&#34;http://floodlight.openflowhub.org/getting-started/&#34;&gt;openflow hub&lt;/a&gt; site as well. I&amp;rsquo;ve found that many are based on Debian or Ubuntu, which can be subtly different than a CentOS / RHEL experience.   In CentOS, log in and sudo -s or su to root. Install the prereqs: &lt;em&gt;yum -y install build-essential default-jdk ant python-dev eclipse git&lt;/em&gt; &lt;em&gt;mkdir /services/floodlight&lt;/em&gt; &lt;em&gt;cd /services/floodlight/&lt;/em&gt; &lt;em&gt;git clone git://github.com/floodlight/floodlight.git ant&lt;/em&gt; Start floodlight in the background. &lt;em&gt;./floodlight.sh &amp;amp;&lt;/em&gt; Because I&amp;rsquo;m terrible at looking at directions, I went to the base URL. This will yield an error that looks something like this: &lt;em&gt;{&amp;ldquo;name&amp;rdquo;:&amp;ldquo;Not Found&amp;rdquo;,&amp;ldquo;error&amp;rdquo;:true,&amp;ldquo;throwable&amp;rdquo;:null,&amp;ldquo;description&amp;rdquo;:&amp;ldquo;The server has not found anything matching the request URI&amp;rdquo;,&amp;ldquo;success&amp;rdquo;:false,&amp;ldquo;informational&amp;rdquo;:false,&amp;ldquo;code&amp;rdquo;:404,&amp;ldquo;reasonPhrase&amp;rdquo;:&amp;ldquo;Not Found&amp;rdquo;,&amp;ldquo;uri&amp;rdquo;:&amp;ldquo;&lt;a href=&#34;http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.5&amp;quot;,&amp;quot;serverError&amp;quot;:false,&amp;quot;connectorError&amp;quot;:false,&amp;quot;clientError&amp;quot;:true,&amp;quot;globalError&amp;quot;:false,&amp;quot;redirection&amp;quot;:false,&amp;quot;recoverableError&amp;quot;:false&#34;&gt;http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.5&amp;quot;,&amp;quot;serverError&amp;quot;:false,&amp;quot;connectorError&amp;quot;:false,&amp;quot;clientError&amp;quot;:true,&amp;quot;globalError&amp;quot;:false,&amp;quot;redirection&amp;quot;:false,&amp;quot;recoverableError&amp;quot;:false&lt;/a&gt;}&lt;/em&gt; The right way to access floodlight is to use the entire URL: http://&lt;address&gt;:8080/ui/index.html Learn from my stupidity.   Here is a script to build it for you:```
#!/bin/bash&lt;/p&gt;

&lt;p&gt;echo &amp;ldquo;Installing prerequisits:&amp;rdquo;
yum -y install build-essential default-jdk ant python-dev eclipse git&lt;/p&gt;

&lt;p&gt;echo &amp;ldquo;Installing floodlight to /services/floodight/&amp;rdquo;
mkdir /services/floodlight
cd /services/floodlight/
git clone git://github.com/floodlight/floodlight.git
ant&lt;/p&gt;

&lt;p&gt;echo &amp;ldquo;Starting floodlight:&amp;rdquo;&lt;/p&gt;

&lt;p&gt;./floodlight.sh&amp;amp;
echo &amp;ldquo;Floodlight started, point your beowser at http://&lt;address&gt;:8080/ui/index.html&amp;rdquo;
```&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Headless VirtualBox host on CentOS</title>
      <link>https://forwardingplane.net/post/headless-virtualbox-host-on-centos/</link>
      <pubDate>Thu, 31 Jan 2013 21:48:47 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/headless-virtualbox-host-on-centos/</guid>
      <description>&lt;p&gt;Starting from a base CentOS system with nothing configured, and referencing the &lt;a href=&#34;http://wiki.centos.org/HowTos/Virtualization/VirtualBox&#34;&gt;CentOS wiki&lt;/a&gt;, here is how I like to set up a headless virtualbox environment: Disable selinux. It&amp;rsquo;s overly cumbersome and is enabled by default in CentOS.  I like to permanently disable it even though the default is permissive.  I ride the edge, I know.```
vi /etc/selinux/config&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
 and change

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;SELINUX=enabled&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
to

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;SELINUX=disabled&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
Then reboot.

Using the methodology I originally found found [here](http://stackoverflow.com/questions/14016286/how-to-programmatically-install-the-latest-epel-release-rpm-without-knowing-its), I like to install the epel repo using this method:```
cat &amp;lt;&amp;lt;EOM &amp;gt;/etc/yum.repos.d/epel-bootstrap.repo
 \[epel\]
 name=Bootstrap EPEL
 mirrorlist=http://mirrors.fedoraproject.org/mirrorlist?repo=epel-\\$releasever&amp;amp;arch=\\$basearch
 failovermethod=priority
 enabled=0
 gpgcheck=0
 EOM
``````
yum --enablerepo=epel -y install epel-release
 rm -f /etc/yum.repos.d/epel-bootstrap.repo
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Install rpmforge repo```
rpm &amp;ndash;import &lt;a href=&#34;http://apt.sw.be/RPM-GPG-KEY.dag.txt&#34;&gt;http://apt.sw.be/RPM-GPG-KEY.dag.txt&lt;/a&gt;
 rpm -Uvh &lt;a href=&#34;http://packages.sw.be/rpmforge-release/rpmforge-release-0.5.2-2.el6.rf.x86_64.rpm&#34;&gt;http://packages.sw.be/rpmforge-release/rpmforge-release-0.5.2-2.el6.rf.x86_64.rpm&lt;/a&gt;
 yum clean all&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Install the virtualbox repo```&#34; data-lang=&#34;Install the virtualbox repo```&#34;&gt;yum install -y wget
cd /etc/yum.repos.d
wget http://download.virtualbox.org/virtualbox/rpm/rhel/virtualbox.repo
yum update&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now the interesting bits, lets get to the vbox install.  Although we have enabled dkms, I like to also install as if we didn&amp;rsquo;t.  It populates the system with the pieces we need in a way that I&amp;rsquo;m used to.  I&amp;rsquo;m not a sysadmin by day, so this may be redundant.  YMMV, etc.   First, install the Development Tools. There are a lot here, it may take a bit depending on machine specs and connectivity speed in relation to mirrors. ```
yum groupinstall &amp;ldquo;Development Tools&amp;rdquo;
yum install VirtualBox-4.2&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Then start up the service and you should see something like this:```&#34; data-lang=&#34;Then start up the service and you should see something like this:```&#34;&gt;service vboxdrv setup
Stopping VirtualBox kernel modules \[ OK \]
Uninstalling old VirtualBox DKMS kernel modulesError! There are no instances of module: vboxhost
4.2.6 located in the DKMS tree.
 \[ OK \]
Trying to register the VirtualBox kernel modules using DKMS
 \[ OK \]
Starting VirtualBox kernel modules \[ OK \]&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;At this point you&amp;rsquo;ve got virtualbox done and installed. Now, the &lt;em&gt;real&lt;/em&gt; interesting part begins: VMs. I have a centos template that I built on my laptop.  It&amp;rsquo;s got the settings I like and I can just import it.  You can also build a new one, but that&amp;rsquo;s for a different post.  I moved the template via scp over to the newly anointed VM host. Now, I just need to import it and I can start cloning.  &lt;a href=&#34;http://www.virtualbox.org/manual/ch08.html&#34;&gt;vboxmanage&lt;/a&gt; is the command we&amp;rsquo;re going to be utilizing heavily and it&amp;rsquo;s really powerful.  ```
vboxmanage import /home/buraglio/centos-63-template.ova&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;0%...10%...20%...30%...40%...50%...60%...70%...80%...90%...100%
Interpreting /home/buraglio/centos-63-template.ova...
OK.
Disks: vmdisk1 150 1359413248 http://www.vmware.com/interfaces/specifications/vmdk.html#streamOptimized centos-63-template-disk1.vmdk 512919552 -1 
Virtual system 0:
 0: Suggested OS type: &amp;quot;Linux26\_64&amp;quot;
 (change with &amp;quot;--vsys 0 --ostype &amp;lt;type&amp;gt;&amp;quot;; use &amp;quot;list ostypes&amp;quot; to list all possible values)
 1: Suggested VM name &amp;quot;centos-63-template&amp;quot;
 (change with &amp;quot;--vsys 0 --vmname &amp;lt;name&amp;gt;&amp;quot;)
 2: Number of CPUs: 2
 (change with &amp;quot;--vsys 0 --cpus &amp;lt;n&amp;gt;&amp;quot;)
 3: Guest memory: 4096 MB
 (change with &amp;quot;--vsys 0 --memory &amp;lt;MB&amp;gt;&amp;quot;)
 4: Network adapter: orig ur1-vm1 72.36.126.200/29, config 5, extra type=Bridged
 5: CD-ROM
 (disable with &amp;quot;--vsys 0 --unit 5 --ignore&amp;quot;)
 6: SCSI controller, type LsiLogic
 (change with &amp;quot;--vsys 0 --unit 6 --scsitype {BusLogic|LsiLogic}&amp;quot;;
 disable with &amp;quot;--vsys 0 --unit 6 --ignore&amp;quot;)
 7: IDE controller, type PIIX4
 (disable with &amp;quot;--vsys 0 --unit 7 --ignore&amp;quot;)
 8: IDE controller, type PIIX4
 (disable with &amp;quot;--vsys 0 --unit 8 --ignore&amp;quot;)
 9: Hard disk image: source image=centos-63-template-disk1.vmdk, target path=/home/buraglio/VirtualBox VMs/centos-63-template/centos-63-template-disk1.vmdk, controller=6;channel=0
 (change target path with &amp;quot;--vsys 0 --unit 9 --disk path&amp;quot;;
 disable with &amp;quot;--vsys 0 --unit 9 --ignore&amp;quot;)
0%...10%...20%...30%...40%...50%...60%...70%...80%...90%...100%
Successfully imported the appliance.
```

It&#39;s there. you should now have a folder in your home directory that has the VM in it. 

```
ls -la VirtualBox\\ VMs/
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;total 12
drwx&amp;mdash;&amp;mdash; 3 buraglio buraglio 4096 Jan 29 20:23 .
drwx&amp;mdash;&amp;mdash;. 4 buraglio buraglio 4096 Jan 29 20:23 ..
drwx&amp;mdash;&amp;mdash; 2 buraglio buraglio 4096 Jan 29 20:23 centos-63-template&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-to really make this useful, I clone all the VMs to the names I want and don&#39;t use the template at all. Now list the vms to verify what you have:```&#34; data-lang=&#34;to really make this useful, I clone all the VMs to the names I want and don&#39;t use the template at all. Now list the vms to verify what you have:```&#34;&gt;vboxmanage list vms
&amp;#34;centos-63-template&amp;#34; {4875b540-5514-4d0b-bba8-ce255b7f44a2}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We have one VM named &amp;ldquo;centos-63-template&amp;rdquo;, which is exactly what I wanted. Now clone this VM to the first usable VM, I&amp;rsquo;m building a floodlight OpenFlow controller, so I&amp;rsquo;ll name it accordingly.```
vboxmanage clonevm centos-63-template &amp;ndash;name floodlight1 &amp;ndash;register
0%&amp;hellip;10%&amp;hellip;20%&amp;hellip;30%&amp;hellip;40%&amp;hellip;50%&amp;hellip;60%&amp;hellip;70%&amp;hellip;80%&amp;hellip;90%&amp;hellip;100%
Machine has been successfully cloned as &amp;ldquo;floodlight1&amp;rdquo;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Now list the vms to make sure it is listed:```&#34; data-lang=&#34;Now list the vms to make sure it is listed:```&#34;&gt;vboxmanage list vms
``````
&amp;#34;centos-63-template&amp;#34; {4875b540-5514-4d0b-bba8-ce255b7f44a2}
``````
&amp;#34;floodlight1&amp;#34; {8fb4f03d-d117-43d5-b4bf-24cdcc481686}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now here is the part I really like about virtualbox headless mode (and yes, I know others like qemu and xen can do this), when a virtual machine is started in headless mode, the console of that host can be redirected to an RDP instance. This makes it very convenient to manage systems on an out of band network like an isolated vlan or other non-routed or non-publically available network. It also makes it very convenient for spinning up a new VM that doesn&amp;rsquo;t have an IP stack configured. Its also very handy if you have a bad day and typo a host firewall rule or network config file. This has saved me a trip more than one time. To do this, you&amp;rsquo;ll need the vrdp extension pack.  To list the installed extension packs, once again, use the vboxmanage command  ```
VBoxManage list extpacks
Extension Packs: 0&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-The extension pack for my version is available [here](http://download.virtualbox.org/virtualbox/4.2.6/Oracle_VM_VirtualBox_Extension_Pack-4.2.6-82870.vbox-extpack).```&#34; data-lang=&#34;The extension pack for my version is available [here](http://download.virtualbox.org/virtualbox/4.2.6/Oracle_VM_VirtualBox_Extension_Pack-4.2.6-82870.vbox-extpack).```&#34;&gt;sudo VBoxManage extpack install Oracle\_VM\_VirtualBox\_Extension\_Pack-4.2.6-82870.vbox-extpack 
0%...10%...20%...30%...40%...50%...60%...70%...80%...90%...100%
Successfully installed &amp;#34;Oracle VM VirtualBox Extension Pack&amp;#34;.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;At this point we&amp;rsquo;re ready to fire up the VM and connect to the console.```
vboxheadless -startvm floodlight1 -vrde on -vrdeproperty &amp;ldquo;TCP/Ports&amp;rdquo;=3390&amp;amp;
Oracle VM VirtualBox Headless Interface 4.2.6
&amp;copy; 2008-2012 Oracle Corporation
All rights reserved.&lt;/p&gt;

&lt;p&gt;VRDE server is listening on port 3390.
```The above command will start the VM &amp;ldquo;floodlight1&amp;rdquo;, enable vrde and set the vrde port to 3390. You should now be able to connect to the console of the host using any free or included RDP compatible client. I use the microsoft office for mac provided rdp client. &lt;img src=&#34;http://www.forwardingplane.net/wp-content/uploads/2013/01/RDC.png&#34; alt=&#34;RDC&#34; /&gt; You&amp;rsquo;ll see an error when connecting since the server can&amp;rsquo;t be verified.  This is expected.     &lt;a href=&#34;http://www.forwardingplane.net/wp-content/uploads/2013/01/RDC-Verify.png&#34;&gt;&lt;img src=&#34;http://www.forwardingplane.net/wp-content/uploads/2013/01/RDC-Verify.png&#34; alt=&#34;RDC Verify&#34; /&gt;&lt;/a&gt;   Hit connect and ta-da! Console on your VM.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.forwardingplane.net/wp-content/uploads/2013/01/Console.png&#34;&gt;&lt;img src=&#34;http://www.forwardingplane.net/wp-content/uploads/2013/01/Console-1024x658.png&#34; alt=&#34;Console&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  The best part about this is that it allows for really flexible management of virtual machines from a geographically different location.  Other than the initial install of CentOS 6, this was done 100% remotely, without a windows host and without an expensive hypervisor license. This is perfect for labs and learning virtualization, I&amp;rsquo;d even consider this totally fine for production.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Diff RANCID router configs with SVN</title>
      <link>https://forwardingplane.net/post/diff-rancid-router-configs-with-svn/</link>
      <pubDate>Fri, 25 Jan 2013 00:27:09 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/diff-rancid-router-configs-with-svn/</guid>
      <description>

&lt;p&gt;If you are running a network and aren&amp;rsquo;t using &lt;a href=&#34;http://shrubbery.net/rancid/&#34;&gt;RANCID&lt;/a&gt;, you should give it a serious look.  RANCID is a cross platform configuration management toolkit for backing up router configurations and certain environmental and hardware information into version control.  It&amp;rsquo;s been around for as long as I can remember and supports nearly every platform I can think of, including a &lt;a href=&#34;http://www.forwardingplane.net/2012/11/vdxrancid-contrib-scripts/&#34; title=&#34;VDXrancid contrib scripts&#34;&gt;few&lt;/a&gt; &lt;a href=&#34;http://www.forwardingplane.net/2011/06/alurancid-and-pfrancid/&#34; title=&#34;alurancid and pfrancid&#34;&gt;modules&lt;/a&gt; that I cobbled together myself.  There is are a few nice web based front ends for CVS and SVN, I prefer to use &lt;a href=&#34;http://www.viewvc.org&#34;&gt;ViewVC&lt;/a&gt; because I have a lot of experience with it, however, there may be cases where a web server isn&amp;rsquo;t a good option, unavailable or just too much work.  In this case, you&amp;rsquo;ll want to know how to diff those configs from the CLI using the existing tools.  I find myself always forgetting the exact syntax of how to do this, so here it is. I prefer to use SVN, so we&amp;rsquo;ll talk about that one here.   svn list will give a list of current devices in version control:&lt;code&gt;
svn list
&lt;/code&gt;```
rtr1.company.com
rtr2.company.com
rtr3.company.com
sw1.company.com
sw2.company.com&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-To look at a router config:```&#34; data-lang=&#34;To look at a router config:```&#34;&gt;svn cat &amp;lt;router&amp;gt;
svn cat rtr1.company.com&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;See all revisions: svn log &lt;router&gt;```&lt;/p&gt;

&lt;h2 id=&#34;svn-log-rtr1-company-com&#34;&gt;svn log rtr1.company.com&lt;/h2&gt;

&lt;p&gt;r863 | _rancid | 2013-01-18 12:51:59 -0600 (Fri, 18 Jan 2013) | 1 line&lt;/p&gt;

&lt;h2 id=&#34;updates-change-made-by-buraglio&#34;&gt;updates - Change made by: buraglio&lt;/h2&gt;

&lt;p&gt;r848 | _rancid | 2013-01-09 14:00:27 -0600 (Wed, 09 Jan 2013) | 1 line&lt;/p&gt;

&lt;h2 id=&#34;updates&#34;&gt;updates&lt;/h2&gt;

&lt;p&gt;r847 | _rancid | 2013-01-09 02:07:42 -0600 (Wed, 09 Jan 2013) | 1 line&lt;/p&gt;

&lt;h2 id=&#34;updates-1&#34;&gt;updates&lt;/h2&gt;

&lt;p&gt;r832 | _rancid | 2012-12-12 09:42:33 -0600 (Wed, 12 Dec 2012) | 1 line&lt;/p&gt;

&lt;h2 id=&#34;updates-change-made-by-buraglio-1&#34;&gt;updates - Change made by: buraglio&lt;/h2&gt;

&lt;p&gt;r804 | _rancid | 2012-11-27 14:00:28 -0600 (Tue, 27 Nov 2012) | 1 line
updates&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Diff revisions: svn diff -r &lt;version1&gt;:&lt;version2&gt; &lt;router&gt;```&#34; data-lang=&#34;Diff revisions: svn diff -r &lt;version1&gt;:&lt;version2&gt; &lt;router&gt;```&#34;&gt;svn diff -r r863:r847 rtr1.company.com

Index: 710rtr.ui-iccn.org
===================================================================
--- rtr1.company.com	(revision 863)
+++ rtr1.company.com	(revision 847)
@@ -497,7 +497,6 @@
 !
 interface ethernet 1/1
  port-name rtr2 (1-1-11-2:e1/2)
- enable
  ip ospf area 0
  ip ospf cost 8
  ip address 10.209.143.1/30&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;That&amp;rsquo;s basically it. Anything you can do from svn, you can do with your RANCID gathered SVN data.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>DNS utilities on CentOS</title>
      <link>https://forwardingplane.net/post/dns-utilities-on-centos/</link>
      <pubDate>Fri, 04 Jan 2013 10:13:28 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/dns-utilities-on-centos/</guid>
      <description>&lt;p&gt;It&amp;rsquo;s always annoying to me, being a convert from *BSD to Linux, that tools lke dig and host aren&amp;rsquo;t in the minimal base install.  I realise that this makes me somewhat of a hypocrite, as I prefer an additive system rather than a subtractive base OS.  Nevertheless, I&amp;rsquo;m continually surprised that &amp;ldquo;host&amp;rdquo; isn&amp;rsquo;t available after installing a minimal CentOS system without adding an additional package.  So, since I always forget, here is a quick blog post to remind me and any other converts how to install those tools:```
 yum -y install bind-utils&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-That&#39;s it.  Tragedy avoided.  Now I can make sure my AAAA records are working.```&#34; data-lang=&#34;That&#39;s it.  Tragedy avoided.  Now I can make sure my AAAA records are working.```&#34;&gt;\[buraglio@cupcake httpd\]# dig www.forwardingplane.net -t AAAA
; &amp;lt;&amp;lt;&amp;gt;&amp;gt; DiG 9.8.2rc1-RedHat-9.8.2-0.10.rc1.el6\_3.6 &amp;lt;&amp;lt;&amp;gt;&amp;gt; www.forwardingplane.net -t AAAA
;; global options: +cmd
;; Got answer:
;; -&amp;gt;&amp;gt;HEADER&amp;lt;&amp;lt;- opcode: QUERY, status: NOERROR, id: 47725
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0
;; QUESTION SECTION:
;www.forwardingplane.net. IN AAAA
;; ANSWER SECTION:
www.forwardingplane.net. 86364 IN AAAA 2607:f2f8:4980::2
;; Query time: 1 msec
;; SERVER: 10.209.209.1#53(10.209.209.1)
;; WHEN: Thu Jan 3 22:49:35 2013
;; MSG SIZE rcvd: 69&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>Installing OwnCloud on CentOS</title>
      <link>https://forwardingplane.net/post/291/</link>
      <pubDate>Sun, 30 Dec 2012 13:32:17 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/291/</guid>
      <description>&lt;pre&gt;&lt;code&gt;wget http://dl.fedoraproject.org/pub/epel/6/x86\_64/epel-release-6-8.noarch.rpm
wget http://rpms.famillecollet.com/enterprise/remi-release-6.rpm
yum -y install apache2 php5 php5-json php-xml php-mbstring php5-zip php5-gd
yum -y install php5-sqlite curl libcurl3 libcurl3-dev php5-curl php-pd
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;php5-sqlite isn&amp;rsquo;t available in the repos I use. I wasn&amp;rsquo;t able to find it elsewhere either. Per &lt;a href=&#34;http://php.net/manual/de/sqlite.installation.php&#34;&gt;this page&lt;/a&gt;, I have to install it by source.&lt;code&gt;
cd /etc/yum.repos.d/
wget http://download.opensuse.org/repositories/isv:ownCloud:community/CentOS\_CentOS-6/isv:ownCloud:community.repo
yum install owncloud
&lt;/code&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>CentOS sshguard install for limiting ssh scans</title>
      <link>https://forwardingplane.net/post/centos-sshguard-install-for-limiting-ssh-scans/</link>
      <pubDate>Sun, 16 Dec 2012 03:18:27 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/centos-sshguard-install-for-limiting-ssh-scans/</guid>
      <description>

&lt;p&gt;Securing SSH is a form or art.  It&amp;rsquo;s often debated, much like blocking all ICMP packets (which I normally disagree with).  If you need good proof, read &lt;a href=&#34;http://lonesysadmin.net/2012/11/20/changing-sshd-port-numbers-continues-to-be-a-bad-idea/&#34;&gt;these&lt;/a&gt; &lt;a href=&#34;http://lonesysadmin.net/2012/10/19/on-using-alternate-ports-for-ssh/&#34;&gt;posts&lt;/a&gt; by &lt;a href=&#34;https://twitter.com/plankers&#34;&gt;Bob Plankers&lt;/a&gt;.  There is a camp that likes to promote moving to a non-standard port.  There is a faction that likes to block it completely except from a handful of hosts.  Then there are those that like to leave it open all together.  Running naked in the digital jungle. I tend to err on the side of blocking except for jump hosts.  This is a pretty time proven methodology.  However, what about the hosts that &lt;strong&gt;need&lt;/strong&gt; to be open? A hardened jump host or public shell box comes to mind. Enter &lt;a href=&#34;http://www.sshguard.net&#34;&gt;sshguard&lt;/a&gt;. SSH Guard is an amazing little piece of software that takes the heavy lifting out of blocking all of those scans and automates removal of blocks.  It works across a myriad of popular unix platforms. From &lt;a href=&#34;http://www.sshguard.net&#34;&gt;http://www.sshguard.net&lt;/a&gt;: &lt;em&gt;Sshguard monitors servers from their logging activity. When logs convey that someone is doing a Bad Thing, sshguard reacts by blocking he/she/it for a bit. Sshguard has a touchy personality: when a naughty tyke insists disturbing your host, it reacts firmer and firmer.&lt;/em&gt; &lt;em&gt;Sshguard supports many services out of the box, recognizes severallog formats, and can operate many firewall systems. Many users appreciate its ease of use, compatibility and feature richness.&lt;/em&gt; I like it because they have not left out some of the less common distros, but sinceI&amp;rsquo;ve mostly converted over to CentOS, this focus is how to set it up on Centos 6.3.   We&amp;rsquo;ll assume you have epel repo and rpmforge repo installed. I prefer &lt;a href=&#34;http://www.balabit.com/network-security/syslog-ng&#34;&gt;syslog-ng&lt;/a&gt; so lets install that.```
sudo yum -y install syslog-ng&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;chkconfig syslog-ng on
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;chkconfig rsyslog off&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-This isn&#39;t necessary, but I&#39;d recommend it. Next, I lke to disable selinux.  It&#39;s on be default in CentOS and I really don&#39;t need what it offers.  I find it annoying and far too restrictive and this won&#39;t build correctly without it disabled in my experience.```&#34; data-lang=&#34;This isn&#39;t necessary, but I&#39;d recommend it. Next, I lke to disable selinux.  It&#39;s on be default in CentOS and I really don&#39;t need what it offers.  I find it annoying and far too restrictive and this won&#39;t build correctly without it disabled in my experience.```&#34;&gt;sudo vi /etc/selinux/config&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Change the line that reads```
SELINUX=enabled&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-to```&#34; data-lang=&#34;to```&#34;&gt;SELINUX=disabled&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You&amp;rsquo;ll need to reboot to make this take effect. Note that this will disable selinux completely and permanently.  &lt;a href=&#34;http://www.revsys.com/writings/quicktips/turn-off-selinux.html&#34;&gt;There are ways to temporarily disable it&lt;/a&gt; if you would prefer.```
sudo reboot&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Download sshguard.  I didn&#39;t find it in any repos for Centos 6.x.  I may be mistaken, but I went this route.```&#34; data-lang=&#34;Download sshguard.  I didn&#39;t find it in any repos for Centos 6.x.  I may be mistaken, but I went this route.```&#34;&gt;wget http://sourceforge.net/projects/sshguard/files/sshguard/sshguard-1.5/sshguard-1.5.tar.bz2/download&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Unpack it.```
bunzip2 sshguard-1.5.tar.bz2&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;tar -xvf sshguard-1.5.tar
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;cd sshguard-1.5&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-I like to do minimal installs of Linux, so I need to add gcc before I can compile.  This will likely install some dependancies if it&#39;s a new minimal install.  Same goes for make```&#34; data-lang=&#34;I like to do minimal installs of Linux, so I need to add gcc before I can compile.  This will likely install some dependancies if it&#39;s a new minimal install.  Same goes for make```&#34;&gt;sudo yum install gcc make
``````
sudo ./configure --with-firewall=iptables
``````
sudo make &amp;amp;&amp;amp; sudo make install&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;OK, you should have it installed at this point.  You can verify by doing:```
ls -la /usr/local/sbin/sshguard&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-which should yield something like this:```&#34; data-lang=&#34;which should yield something like this:```&#34;&gt;\-rwxr-xr-x 1 root root 399995 Dec 16 02:28 /usr/local/sbin/sshguard&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Great, now we need to create firewall tables for sshguard for IPv4, and if you&amp;rsquo;re keeping up to date, IPv6.```
sudo iptables -N sshguard&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo ip6tables -N sshguard
```Now tell iptables to drop that traffic. Make sure you don&#39;t have a permit ssh rule above this line or it won&#39;t work.```
sudo iptables -A INPUT -j sshguard
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;sudo ip6tables -A INPUT -j sshguard&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
Save your config.  ```
sudo iptables-save &amp;lt; /etc/sysconfig/iptables
``````
sudo ip6tables-save &amp;lt; /etc/sysconfig/ip6tables
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;For the examples below, we&amp;rsquo;ll just look at IPv4 to keep the post a bit shorter, but the v6 pieces are all identical save for the file names.  If you&amp;rsquo;re running v6 you should remember to secure it just as you would v4. Mine ruleset is pretty vanilla, mostly stock with the exception of ssl and dns.```
# Completed on Sat Dec 15 21:02:09 2012&lt;/p&gt;

&lt;h1 id=&#34;generated-by-iptables-save-v1-4-7-on-sat-dec-15-21-02-09-2012&#34;&gt;Generated by iptables-save v1.4.7 on Sat Dec 15 21:02:09 2012&lt;/h1&gt;

&lt;p&gt;*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [6585:1425605]
:sshguard - [0:0]
-A INPUT -m state &amp;ndash;state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -j sshguard
-A INPUT -p icmp -j ACCEPT
-A INPUT -i lo -j ACCEPT
-A INPUT -p tcp -m state &amp;ndash;state NEW -m tcp &amp;ndash;dport 22 -j ACCEPT
-A INPUT -p tcp -m state &amp;ndash;state NEW -m tcp &amp;ndash;dport 443 -j ACCEPT
-A INPUT -p udp -m state &amp;ndash;state NEW -m udp &amp;ndash;dport 53 -j ACCEPT
-A INPUT -p tcp -m state &amp;ndash;state NEW -m tcp &amp;ndash;dport 53 -j ACCEPT
-A INPUT -j REJECT &amp;ndash;reject-with icmp-host-prohibited
-A FORWARD -j REJECT &amp;ndash;reject-with icmp-host-prohibited
COMMIT&lt;/p&gt;

&lt;h1 id=&#34;completed-on-sat-dec-15-21-02-09-2012&#34;&gt;Completed on Sat Dec 15 21:02:09 2012&lt;/h1&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Note: I did have to relocate the sshguard rule to right below the first INPUT rule to make it actually effective.&#34; data-lang=&#34;Note: I did have to relocate the sshguard rule to right below the first INPUT rule to make it actually effective.&#34;&gt;Now we need to activate it.  This is pretty straightforward.  We essentially need to tell syslog to call sshguard based on activity and it&amp;#39;s why I prefer syslog-ng.  It&amp;#39;s very flexible and easy to add this stuff right in.  I&amp;#39;ve been using it for over a decade and it the most flexible syslog server I&amp;#39;ve found.  ```
vi /etc/syslog-ng/syslog-ng.conf&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Based on the &lt;a href=&#34;http://www.sshguard.net/docs/setup/getlogs/syslog-ng/&#34;&gt;instructions at the sshguard site&lt;/a&gt; (which also have details for extending this to more than just ssh; I&amp;rsquo;ll do a post on that for CentOS at some point too), just add the following to the bottom of your syslog-ng.conf file:```
# pass only entries with auth+authpriv facilities from programs other than sshguard
filter f_sshguard { facility(auth, authpriv) and not program(&amp;ldquo;sshguard&amp;rdquo;); };&lt;/p&gt;

&lt;h1 id=&#34;pass-entries-built-with-this-format&#34;&gt;pass entries built with this format&lt;/h1&gt;

&lt;p&gt;destination sshguard {
 program(&amp;ldquo;/usr/local/sbin/sshguard&amp;rdquo;
 template(&amp;ldquo;$DATE $FULLHOST $MSGHDR$MESSAGE\n&amp;rdquo;)
 );
};
log { source(s_sys); filter(f_sshguard); destination(sshguard); };&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-Then restart syslog-ng```&#34; data-lang=&#34;Then restart syslog-ng```&#34;&gt;sudo service syslog-ng stop
``````
sudo service syslog-ng start&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You&amp;rsquo;ll probably see these errors, they can be ignored if you&amp;rsquo;re not using the afsql module.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Plugin module not found in &#39;module-path&#39;; module-path=&#39;/lib64/syslog-ng&#39;, module=&#39;afsql&#39;
``````
Starting syslog-ng: Plugin module not found in &#39;module-path&#39;; module-path=&#39;/lib64/syslog-ng&#39;, module=&#39;afsql&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ssh into localhost or in from an outside host. This will create a log and cause syslog-ng to call sshguard. At that point you should see this when looking for sshguard:```
ps auxww | grep sshguard&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root 14010 0.0 0.0 16924 1260 ? Sl 20:49 0:00 /usr/local/sbin/sshguard
```You should see it in your iptables rules:```
\[buraglio@centos63 sysconfig\]# sudo iptables -L
Chain INPUT (policy ACCEPT)
target prot opt source destination 
ACCEPT all -- anywhere anywhere state RELATED,ESTABLISHED 
sshguard all -- anywhere anywhere 
ACCEPT icmp -- anywhere anywhere 
ACCEPT all -- anywhere anywhere 
ACCEPT tcp -- anywhere anywhere state NEW tcp dpt:ssh 
ACCEPT tcp -- anywhere anywhere state NEW tcp dpt:https 
ACCEPT udp -- anywhere anywhere state NEW udp dpt:domain 
ACCEPT tcp -- anywhere anywhere state NEW tcp dpt:domain 
ACCEPT tcp -- anywhere anywhere state NEW tcp dpt:ndmp 
ACCEPT tcp -- anywhere anywhere state NEW tcp dpt:dnp 
REJECT all -- anywhere anywhere reject-with icmp-host-prohibited
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Chain FORWARD (policy ACCEPT)
target prot opt source destination
REJECT all &amp;ndash; anywhere anywhere reject-with icmp-host-prohibited&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Chain OUTPUT (policy ACCEPT)
target prot opt source destination
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Chain sshguard (1 references)
target prot opt source destination
```That&amp;rsquo;s pretty much it. Let it sit and wait. It will block scanners automagically and then unblock them after a period of time.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Converting (back) to wordpress from Blogger</title>
      <link>https://forwardingplane.net/post/converting-back-to-wordpress-from-blogger/</link>
      <pubDate>Sun, 02 Dec 2012 19:41:08 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/converting-back-to-wordpress-from-blogger/</guid>
      <description>&lt;p&gt;For a long time I ran a blog called &lt;a href=&#34;http://www.forwardingplane.net&#34;&gt;tech.buraglio.com&lt;/a&gt; that was a self hosted wordpress site. After having kids and getting a bit busier at work, I decided to move everything that I had been hosting (images, scripts, hacks, blogs and DNS) to &amp;ldquo;the cloud&amp;rdquo;. I managed to do this for everything but my primary DNS resolver, which I had always intended to keep, and one &lt;a href=&#34;http://www.shitenonions.com&#34;&gt;wordpress blog&lt;/a&gt; that I hosted for someone else.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.forwardingplane.net/wp-content/uploads/2012/12/bloggerpress.jpg&#34;&gt;&lt;img src=&#34;http://www.forwardingplane.net/wp-content/uploads/2012/12/bloggerpress-300x200.jpg&#34; alt=&#34;&#34; title=&#34;bloggerpress&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  I moved my image hosting from gallery2 to flickr (backup on picasaweb), secondary DNS to nether.net and afraid.org, scripts, hacks and the like to google code and my blogs to blogger.  Blogger was &lt;strong&gt;very&lt;/strong&gt; easy, stable and highly available.  It was also far less flexible.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://www.undertheradarblog.com/wp-content/uploads/2011/12/Top-5-Best-Free-Cloud-Storage-Services-That-You-Need-And-Are-Useful.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;I continued to write from time to time, mostly ramblings or notes on some weird thing I has to set up.  I noticed that a few of my posts were getting a decent amount of traffic, something I was a bit surprised about.  I started to write a bit more&amp;hellip;&amp;hellip;more traffic.  I started cross posting to &lt;a href=&#34;http://www.twitter.com/buraglio&#34;&gt;twitter&lt;/a&gt;.  More traffic.  OK, maybe what I was jotting down was actually useful to someone.  Or I had a stalker.  Probably not the latter. &lt;img src=&#34;http://blog.dreamhost.com/wp-content/uploads/2009/09/23-wordpress_logo.png&#34; alt=&#34;&#34; /&gt;  &lt;img src=&#34;http://www.decodeunicode.org/en/u+003e/data/glyph/196x196/003E.gif&#34; alt=&#34;&#34; /&gt;&lt;img src=&#34;http://upload.wikimedia.org/wikipedia/commons/thumb/3/31/Blogger.svg/256px-Blogger.svg.png&#34; alt=&#34;&#34; /&gt; Since I already had apache working and serving other stuff, and one of them is another WP site, I already has MySQL running.  I just enabled SSL for the new domain that I had added and was ready to go.  I&amp;rsquo;m a really lazy sysadmin, so I used this as a reference. First, installing wordpress.  I chose the &lt;a href=&#34;http://codex.wordpress.org/Installing/Updating_WordPress_with_Subversion&#34;&gt;SVN install&lt;/a&gt; for easier upgrades down the road.  Upgrading WP was somethingI alweays hated doing, so I let it languish when I used it before.  At least now I should, in most cases, be able to just type &amp;ldquo;&lt;em&gt;svn update&lt;/em&gt;&amp;rdquo; to get it up to date (after verifying a back up, of course). After using the &lt;a href=&#34;http://wordpress.org/extend/plugins/blogger-importer/&#34;&gt;blogger importer&lt;/a&gt;, I had to go through and set all of my old blogger drafts to draft status again, wordpress has changed them all to published status. A minor detail. the rest  should be pretty straight forward, right?  Maybe not.  I&amp;rsquo;ve done a lot of twitter and bit.ly linking to my posts and I had a feedburner and quite a few RSS subscribers.  The feedburner stuff I&amp;rsquo;m probably going to have to write off.  The &lt;a href=&#34;http://feeds.feedburner.com/forwardingplane/WszR&#34;&gt;link&lt;/a&gt; needed to be more obvious as to what it was. The biggest thing I have to worry about is that Blogger formats it&amp;rsquo;s &amp;ldquo;pretty&amp;rdquo; links in a different way than wordpress.  Thankfully, however, I&amp;rsquo;m self gosting so I can use apache magic to fix this. &lt;em&gt;.htaccess&lt;/em&gt; to the rescue. For every post, I&amp;rsquo;ve had to create a redirect entry in my .htaccess file.  Most of it is done, but for reference, here is what it looks like: &lt;em&gt;Redirect 301 /2012/11/sdn-across-domains-in-wan-novice-look.html &lt;a href=&#34;http://www.forwardingplane.net/2012/11/sdn-across-domains-in-the-wan-a-novice-look/&#34;&gt;http://www.forwardingplane.net/2012/11/sdn-across-domains-in-the-wan-a-novice-look/&lt;/a&gt;&lt;/em&gt; &lt;em&gt;Redirect 301 /2012/11/and-purple-pony.html &lt;a href=&#34;http://www.forwardingplane.net/2012/11/sdn-across-domains-in-the-wan-a-novice-look/&#34;&gt;http://www.forwardingplane.net/2012/11/sdn-across-domains-in-the-wan-a-novice-look/&lt;/a&gt;&lt;/em&gt; &lt;em&gt;Redirect 301 /2012/11/using-brocade-mlxe-as-replicator-to-ids.html &lt;a href=&#34;http://www.forwardingplane.net/2012/11/using-a-brocade-mlxe-as-a-replicator-to-an-ids/&#34;&gt;http://www.forwardingplane.net/2012/11/using-a-brocade-mlxe-as-a-replicator-to-an-ids/&lt;/a&gt;&lt;/em&gt; &lt;em&gt;Redirect 301 /2012/11/workflow-and-my-every-day-workstation.html &lt;a href=&#34;http://www.forwardingplane.net/2012/11/workflow-and-my-every-day-workstation-setup/&#34;&gt;http://www.forwardingplane.net/2012/11/workflow-and-my-every-day-workstation-setup/&lt;/a&gt;&lt;/em&gt; &lt;em&gt;Redirect 301 /2012/11/vdxrancid-contrib-scripts.html &lt;a href=&#34;http://www.forwardingplane.net/2012/11/vdxrancid-contrib-scripts/&#34;&gt;http://www.forwardingplane.net/2012/11/vdxrancid-contrib-scripts/&lt;/a&gt;&lt;/em&gt; &lt;em&gt;Redirect 301 /2012/11/scinet-privileged-few.html &lt;a href=&#34;http://www.forwardingplane.net/2012/11/scinet-a-privileged-few/&#34;&gt;http://www.forwardingplane.net/2012/11/scinet-a-privileged-few/&lt;/a&gt;&lt;/em&gt; &lt;em&gt;Redirect 301 /2012/11/juniper-ex-4200-arp-ndp-problem-or.html &lt;a href=&#34;http://www.forwardingplane.net/2012/11/juniper-ex-4200-arp-ndp-problem-or-things-id-like-to-see-in-a-tac/&#34;&gt;http://www.forwardingplane.net/2012/11/juniper-ex-4200-arp-ndp-problem-or-things-id-like-to-see-in-a-tac/&lt;/a&gt;&lt;/em&gt; &lt;em&gt;Redirect 301 /2012/11/and-purple-pony.html &lt;a href=&#34;http://www.forwardingplane.net/2012/11/and-a-purple-pony/&#34;&gt;http://www.forwardingplane.net/2012/11/and-a-purple-pony/&lt;/a&gt;&lt;/em&gt; &lt;em&gt;Redirect 301 /2012/10/directionality_31.html &lt;a href=&#34;http://www.forwardingplane.net/2012/10/directionality/&#34;&gt;http://www.forwardingplane.net/2012/10/directionality/&lt;/a&gt;&lt;/em&gt; &lt;em&gt;Redirect 301 /2012/10/juniper-to-ios-conversion-chart.html &lt;a href=&#34;http://www.forwardingplane.net/2012/10/juniper-to-ios-conversion-chart/&#34;&gt;http://www.forwardingplane.net/2012/10/juniper-to-ios-conversion-chart/&lt;/a&gt;&lt;/em&gt; &lt;em&gt;Redirect 301 /2012/10/host-based-sflow-or-sflow-for-more-than.html &lt;a href=&#34;http://www.forwardingplane.net/2012/10/host-based-sflow-or-sflow-for-more-than-just-network-traffic/&#34;&gt;http://www.forwardingplane.net/2012/10/host-based-sflow-or-sflow-for-more-than-just-network-traffic/&lt;/a&gt;&lt;/em&gt; &amp;hellip;.and so on. I got really used to the google analytics, so I had to add a plugin for that.  I chose &lt;a href=&#34;http://wordpress.org/extend/plugins/google-analyticator/&#34;&gt;Google Analyticator&lt;/a&gt;.  &amp;hellip;.Then I realized that users having to create  accounts is lame, so I added &lt;a href=&#34;http://wordpress.org/extend/plugins/social-connect/&#34;&gt;Social Connect&lt;/a&gt;. So far, that&amp;rsquo;s pretty much it.  However, since this is a public unix box I need to make sure it&amp;rsquo;s relatively safe, so I would highly recommend installing &lt;a href=&#34;http://www.sshguard.net&#34;&gt;sshguard&lt;/a&gt; in addition to whatever other firewall rules it can dynamically block offensive hosts and then unblock them after a period of time.  I am also a big fan of &lt;a href=&#34;http://www.duosecurity.com&#34;&gt;duo security&lt;/a&gt; for &lt;a href=&#34;http://en.wikipedia.org/wiki/Two-factor_authentication&#34;&gt;two factor auth&lt;/a&gt;. We&amp;rsquo;ll see how this goes&amp;hellip;&amp;hellip;     // &amp;lt;![CDATA[ google_ad_client = &amp;ldquo;ca-pub-5397547757892743&amp;rdquo;; /* Wordpress Small */ google_ad_slot = &amp;ldquo;7170585744&amp;rdquo;; google_ad_width = 468; google_ad_height = 15; // ]]&amp;gt; // &amp;lt;![CDATA[ // ]]&amp;gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Workflow and my every day workstation setup.</title>
      <link>https://forwardingplane.net/post/workflow-and-my-every-day-workstation-setup/</link>
      <pubDate>Sun, 25 Nov 2012 00:03:00 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/workflow-and-my-every-day-workstation-setup/</guid>
      <description>&lt;p&gt;Recently, there was a &lt;a href=&#34;http://forum.packetpushers.net/showthread.php/309-Productivity-or-Social-Apps?p=1276&#34;&gt;thread over at Packet Pushers&lt;/a&gt; about what folks use for their daily workflow.  I quickly realized that my setup is pretty simple (as I like it) and relied on a large amount of terminal based tools, which makes sense since I have been a UNIX (or UNIX based) OS user since my migration from the original MacOS back in the 1990s.  Anyway, Since I wrote most of this up already, I thought I&amp;rsquo;d post it here:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Envoronment and Editing&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Editor: VIM via Terminal.app or BBEdit. Occasionally Textedit, but primarily I use VIM&lt;br /&gt;
Calendar: iCalMail: &lt;a href=&#34;http://mailplaneapp.com/&#34;&gt;Mailplane&lt;/a&gt; ($24.95) and Mail.app (Free) (different accounts).Blogging software: Blogger interface or Wordpress editor depending on site.  Both Free.Screen capture: built in Mac hotkey (Apple+4), Free.Screen video capture: &lt;a href=&#34;http://www.evological.com/evocam.html&#34;&gt;Evocam&lt;/a&gt; or a clunky script I wrote that records to flv ($30)Reminder/ToDo: Apple reminders app (Free; works across all their platforms)Shell: zsh, of course (Free)&lt;br /&gt;
Network Diagram tool: &lt;a href=&#34;http://www.omnigroup.com/products/omnigraffle/&#34;&gt;OmniGraffle Professional&lt;/a&gt; ($199.99)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Communications&lt;/strong&gt;&lt;br /&gt;
IM: Skype, MS Lync and Messages.app (Free, Free, Free)&lt;br /&gt;
&lt;strong&gt;Virtualization&lt;/strong&gt;&lt;br /&gt;
&lt;a href=&#34;https://www.virtualbox.org/&#34;&gt;Virtual Box&lt;/a&gt; or &lt;a href=&#34;http://store.vmware.com/store/vmware/pd/productID.165310200/Currency.USD/?src=PaidSearch_Google_eBiz_Fusion_US_Brand&#34;&gt;VMWare Fusion&lt;/a&gt; on my laptop, depending on the application. See &lt;a href=&#34;http://forum.packetpushers.net/showthread.php/309-Productivity-or-Social-Apps?p=1276&#34;&gt;this post&lt;/a&gt; for good reasons. (Free, $50)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Random Apps&lt;/strong&gt;&lt;br /&gt;
&lt;a href=&#34;https://itunes.apple.com/us/app/caffeine/id411246225?mt=12&#34;&gt;Caffeine&lt;/a&gt; (Keep screen awake easily, prevents sleep mode; Free)  &lt;br /&gt;
&lt;a href=&#34;https://itunes.apple.com/us/app/growl/id467939042?mt=12&#34;&gt;Growl&lt;/a&gt; (Notifications; $3.99)&lt;a href=&#34;http://www.abyssoft.com/software/teleport/&#34;&gt;Teleport&lt;/a&gt; (Secure virtual KVM; Free)&lt;br /&gt;
&lt;a href=&#34;https://itunes.apple.com/us/app/datavault-password-manager/id408865957?mt=12&#34;&gt;DataVault Password Manager&lt;/a&gt; for password sync and storage ($9.99; may look into 1Password)&lt;br /&gt;
&lt;a href=&#34;http://db.tt/iIXz2oDO&#34;&gt;Dropbox&lt;/a&gt; for Cloud storage (Free, paid also available)&lt;br /&gt;
&lt;a href=&#34;https://spideroak.com/download/referral/1ddbb514c7eede1e37ad6411e76b549c&#34;&gt;Spideroak&lt;/a&gt; for Secure cloud folder sync (Free, Paid options available and worth the money)&lt;br /&gt;
&lt;a href=&#34;http://www.crashplan.com/&#34;&gt;Crashplan&lt;/a&gt; for Backup ($Varies depending on plan.  Free option available.  This app is amazing, check it out)&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://itunes.apple.com/us/app/pocket/id568494494?mt=12&#34;&gt;Pocket&lt;/a&gt; for offline reading (Free)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Browser&lt;/strong&gt;&lt;br /&gt;
Chrome for day to day browsing  Disconnect and Collusion for privacy and blocking of tracking  Adblock  Flashblock  IPvfoo  Tapatalk Notifier   Tweetdeck&lt;br /&gt;
Safari for quick testingFirefox for stuff that won&amp;rsquo;t work in anything else.&lt;/p&gt;

&lt;p&gt;[[ This is a content summary only. Visit my website for full links, other content, and more! ]]&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Host based sflow, or, sflow for more than just network traffic</title>
      <link>https://forwardingplane.net/post/host-based-sflow-or-sflow-for-more-than-just-network-traffic/</link>
      <pubDate>Sat, 27 Oct 2012 02:33:00 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/host-based-sflow-or-sflow-for-more-than-just-network-traffic/</guid>
      <description>&lt;p&gt;I&amp;rsquo;m an awful sysadmin.  Running services permanently isn&amp;rsquo;t really my forte, I tend to lean more on the &amp;ldquo;I&amp;rsquo;ll get this proof of concept all working, prove that it works or doesn&amp;rsquo;t, then roll it on for polishing by someone else&amp;rdquo; kinda guy.  That final 15% is something I&amp;rsquo;m constantly working to refine and better myself at accomplishing.   I&amp;rsquo;m decent at debugging network services, and can be handy in a &amp;ldquo;oh crap, it&amp;rsquo;s down!&amp;rdquo; scamerio, but day to day sysadmin&amp;hellip;not really my speciality.&lt;br /&gt;
I know enough programming to be dangerous and have enough experience to know how to set up or fix pretty much any OS with nearly any service on it.  15 years as a slash and burn Network Engineer will often lend itself to that.  That being said, I do enjoy playing with new options, software packages and and LOVE instrumentation.  Then I came across &lt;a href=&#34;http://host-sflow.sourceforge.net/&#34;&gt;this&lt;/a&gt;.     &lt;a href=&#34;http://blog.sflow.com/2012/01/host-sflow-distributed-agent.html&#34;&gt;Host based sflow&lt;/a&gt;&amp;hellip;..for more than just network traffic.&lt;br /&gt;
This idea is &lt;strong&gt;fantastic&lt;/strong&gt;.&lt;br /&gt;
&lt;strong&gt;Why&lt;/strong&gt; did I never think of it?!?!?!?&lt;/p&gt;

&lt;p&gt;Essentially it&amp;rsquo;s &lt;a href=&#34;http://en.wikipedia.org/wiki/SFlow&#34;&gt;sflow&lt;/a&gt;, a mechanism for monitoring network traffic, or thats at least how I thought of it being from the network side.  It&amp;rsquo;s a lot like Netflow, but an open standard.  Many network devices support it for sampling transit routed packets.  It never occured to me to run it on hosts for other things like&amp;hellip;..http hits, disk utilization&amp;hellip;.memory usage.  This seems perfect for a cloud environment, or for a VM farm&amp;hellip;.or anywhere you don&amp;rsquo;t want to run snmpd or some weird commercial agent on a host.&lt;br /&gt;
I already have an &lt;a href=&#34;http://nfsen.sourceforge.net/&#34;&gt;nfsen&lt;/a&gt;/&lt;a href=&#34;http://nfdump.sourceforge.net/&#34;&gt;nfdump&lt;/a&gt; instance, but it should work with any open source or commercial collector that supports sflow, which is a huge number.  Intermapper flow, inmon, there is a long list.&lt;/p&gt;

&lt;p&gt;I had to see this work, since we had just discussed this type of monitoring in our new [broadband project of the year award winning] ISP, &lt;a href=&#34;http://www.uc2b.net/&#34;&gt;UC2B&lt;/a&gt; that I am heavily involved in.&lt;br /&gt;
So, on to the meat and potato..&lt;br /&gt;
I grabbed the dpkg and installed it on my personal ubuntu server.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;sudo dpkg -i hsflowd_1.22.2-1_x86_64.deb &lt;/em&gt;&lt;br /&gt;
From there I needed to edit the conf file to point it my test flow collector, which happens to reside on the same box.  Use your favorite editor, I like vi personally but I&amp;rsquo;ve been using it for 15 years. &lt;br /&gt;
&lt;em&gt;sudo vi /etc/hsflowd.conf&lt;/em&gt;&lt;br /&gt;
Change the following lines:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;DNSSD = off&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;  &lt;em&gt;polling = 30&lt;/em&gt;&lt;br /&gt;
&lt;em&gt;  sampling.http = 10&lt;/em&gt;&lt;br /&gt;
&lt;em&gt;  sampling.memcache = 500&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt; collector {&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;    ip = 127.0.0.1&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;     udpport = 6997&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;  }&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Close out the file.  I chose to tweak a few of the defaults to see what it&amp;rsquo;d yield.  &lt;/p&gt;

&lt;p&gt;Now edit your nfsen.conf file&lt;/p&gt;

&lt;p&gt;&lt;em&gt;%sources = (&lt;/em&gt;&lt;br /&gt;
&lt;em&gt;    &amp;lsquo;home&amp;rsquo;    =&amp;gt; { &amp;lsquo;port&amp;rsquo; =&amp;gt; &amp;lsquo;6996&amp;rsquo;, &amp;lsquo;col&amp;rsquo; =&amp;gt; &amp;lsquo;#0000ff&amp;rsquo;, &amp;lsquo;type&amp;rsquo; =&amp;gt; &amp;lsquo;netflow&amp;rsquo; },&lt;/em&gt;&lt;br /&gt;
&lt;em&gt;    &amp;lsquo;cupcake&amp;rsquo;    =&amp;gt; { &amp;lsquo;port&amp;rsquo; =&amp;gt; &amp;lsquo;6997&amp;rsquo;, &amp;lsquo;col&amp;rsquo; =&amp;gt; &amp;lsquo;#0000ff&amp;rsquo;, &amp;lsquo;type&amp;rsquo; =&amp;gt; &amp;lsquo;sflow&amp;rsquo; },&lt;/em&gt;&lt;br /&gt;
&lt;em&gt;);&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;sudo /services/netflow/bin/nfsen reconfig&lt;/em&gt;&lt;br /&gt;
This should yield at the very least network data and provide a proof of concept. other services can be monitored by using the json options, but that&amp;rsquo;s beyond the scope of this writing.  I could see a big win from this in a home brew cloud environment or a large VM farm since it can provide a very straightforward way to generate very useful data in a standard format that can be very simply monitored, queried and archived.    &lt;br /&gt;
_&lt;a href=&#34;http://gan.doubleclick.net/gan_click?lid=41000000028007181&amp;amp;pid=UBM9786132095695&amp;amp;adurl=http%3A%2F%2Fwww.cdsbooksdvds.com%2Fproduct.jhtm%3Fsku%3DUBM9786132095695&amp;amp;usg=AFHzDLucmjq8niDqbnNmvyDzFPVpDnuqQQ&amp;amp;pubid=590157&#34;&gt;Paessler Router Traffic Grapher&lt;/a&gt;_&lt;/p&gt;

&lt;p&gt;[[ This is a content summary only. Visit my website for full links, other content, and more! ]]&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Looking more deeply into iMessage</title>
      <link>https://forwardingplane.net/post/looking-more-deeply-into-imessage/</link>
      <pubDate>Sun, 06 Nov 2011 23:28:00 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/looking-more-deeply-into-imessage/</guid>
      <description>&lt;p&gt;I&amp;rsquo;ve been looking at iMessage from time to time as my schedule permits, for some reason that I can&amp;rsquo;t really explain I&amp;rsquo;m fixated on it.  So, just like I did with FaceTime, I started doing network sniffing to see just what it&amp;rsquo;s doing.  The results were not terribly unexpected.  &lt;/p&gt;

&lt;p&gt;   iPhone.buraglio.com.53140 &amp;gt; st11p01st-courier143-bz.push.apple.com.5223: Flags [R], cksum 0x5ec8 (correct), seq 4109691913, win 0, length 0&lt;br /&gt;
14:07:51.665485 IP (tos 0x20, ttl 49, id 11699, offset 0, flags [DF], proto TCP (6), length 64, bad cksum 0 (-&amp;gt;8fc7)!)&lt;br /&gt;
    st11p01st-courier143-bz.push.apple.com.5223 &amp;gt; iPhone.buraglio.com.53140: Flags [.], cksum 0xb792 (correct), seq 76, ack 475, win 192, options [nop,nop,TS val 154465503 ecr 230925781,nop,nop,sack 1 {474:475}], length 0&lt;br /&gt;
14:07:51.667170 IP (tos 0x20, ttl 64, id 22535, offset 0, flags [DF], proto TCP (6), length 40)&lt;br /&gt;
    iPhone.buraglio.com.53140 &amp;gt; st11p01st-courier143-bz.push.apple.com.5223: Flags [R], cksum 0x5ec8 (correct), seq 4109691913, win 0, length 0&lt;br /&gt;
14:07:51.677715 IP (tos 0x20, ttl 46, id 41627, offset 0, flags [none], proto TCP (6), length 52, bad cksum 0 (-&amp;gt;f541)!)&lt;/p&gt;

&lt;p&gt;However, it appears to me, in my initial looking, that the outgoing message is inconsistently using the cellular data network.  I can replicate this by sending a message via my iPhone to another iMessage user, and I never see any traffic from that host on my network.  However, if I get a response, it comes back in similar to the capture above.  It would make sense to me that the service would use wifi when available as opposed to the more expensive cellular data.&lt;/p&gt;

&lt;p&gt;If I have my iPad on, I see that traffic as well as it only has wifi.&lt;/p&gt;

&lt;p&gt;    iPhone.buraglio.com.52084 &amp;gt; st11p01st-courier094-bz.push.apple.com.5223: Flags [.], cksum 0x7f0b (correct), seq 160, ack 2436, win 8122, options [nop,nop,TS val 121427102 ecr 1305430889], length 0&lt;br /&gt;
    st11p01st-courier066-bz.push.apple.com.5223 &amp;gt; iPad.buraglio.com.57869: Flags [P.], cksum 0xbd1c (correct), seq 1327:2436, ack 160, win 501, options [nop,nop,TS val 3197914588 ecr 1393723712], length 1109&lt;/p&gt;

&lt;p&gt;So, nothing terribly conclusive so far in my small amount of testing, more data capture and variables to come.  &lt;/p&gt;

&lt;p&gt;[[ This is a content summary only. Visit my website for full links, other content, and more! ]]&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ftps (secure ftp) from the command line</title>
      <link>https://forwardingplane.net/post/ftps-secure-ftp-from-the-command-line/</link>
      <pubDate>Tue, 04 Oct 2011 04:31:00 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/ftps-secure-ftp-from-the-command-line/</guid>
      <description>&lt;p&gt;I have recently enabled &lt;a href=&#34;http://www.duosecurity.com/&#34;&gt;Duo Security&lt;/a&gt; for many of my personal services, and I can&amp;rsquo;t recommend them enough. Personal &lt;a href=&#34;http://en.wikipedia.org/wiki/Two-factor_authentication&#34;&gt;two factor authentication&lt;/a&gt; is very useful and really powerful. It works on my iPhone and I have yet to run into any real issues&amp;hellip;.except for one. I can&amp;rsquo;t use automation to scp or sftp anything anymore and keep my two factor auth working in a way I&amp;rsquo;m comfortable with.&lt;/p&gt;

&lt;p&gt;Enter &lt;a href=&#34;http://en.wikipedia.org/wiki/Ftps&#34;&gt;ftps&lt;/a&gt;. FTP is a terrible, yet immensely useful protocol. I chose to use &lt;a href=&#34;https://security.appspot.com/vsftpd.html&#34;&gt;vsftp&lt;/a&gt; under debian Linux with Implicit TLS/SSL, meaning there is no negotiation of protocol as with explicit ftps (or ftpes). It&amp;rsquo;s secure, or none.&lt;/p&gt;

&lt;p&gt;Configuring this is pretty easy, but it does require some editing of the /etc/vsftpd.conf file. I added some stuff to make it do ftpes as such:&lt;/p&gt;

&lt;p&gt;_ssl_enable=YES&lt;br /&gt;
allow_anon_ssl=NO&lt;br /&gt;
force_local_data_ssl=YES&lt;br /&gt;
force_local_logins_ssl=YES&lt;br /&gt;
rsa_cert_file=/etc/ssl/certs/vsftpd.pem&lt;br /&gt;
_&lt;/p&gt;

&lt;p&gt;This and a few other tweaks that aren&amp;rsquo;t relevant here, make ftpes work on my machine.&lt;/p&gt;

&lt;p&gt;Now, clients are another story. Most of the modern GUI based clients work. I know &lt;a href=&#34;http://filezilla-project.org/&#34;&gt;filezilla&lt;/a&gt; works, and it&amp;rsquo;s free. The problem I have, is that I need to do this programmatically, via a script.&lt;/p&gt;

&lt;p&gt;A bit of digging didn&amp;rsquo;t yield much, however, I did come across &lt;a href=&#34;http://lftp.yar.ru/&#34;&gt;lftp&lt;/a&gt;. lftp is an extremely powerful command line ftp client that has a LOT of features, one of which is ftpes support. Now, the one problem with lftp is that it is extremely full featured. Like, overly featured. So much so, that it can be a bit daunting to make it do what you want, which in my case was pretty simple.&lt;/p&gt;

&lt;p&gt;I wrote a simple script to make it do what I wanted, which was just to upload a file and move it around.&lt;/p&gt;

&lt;p&gt;_&lt;br /&gt;
#!/bin/sh&lt;br /&gt;
_&lt;em&gt;/usr/bin/lftp -u user,password remote.host.com&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;_&amp;lt;__&lt;/p&gt;

&lt;p&gt;cd data&lt;/p&gt;

&lt;p&gt;lcd /mnt/NAS/files/updates&lt;/p&gt;

&lt;p&gt;put updates.txt&lt;/p&gt;

&lt;p&gt;mv updates.txt data.txt&lt;/p&gt;

&lt;p&gt;quit 0&lt;/p&gt;

&lt;p&gt;EOF&lt;/p&gt;

&lt;p&gt;_&lt;/p&gt;

&lt;p&gt;This works fine, and since I&amp;rsquo;m using ftpes, it does all of the negotiation for me.&lt;/p&gt;

&lt;p&gt;[[ This is a content summary only. Visit my website for full links, other content, and more! ]]&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Black Hole routing</title>
      <link>https://forwardingplane.net/post/black-hole-routing/</link>
      <pubDate>Tue, 04 Oct 2011 01:00:00 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/black-hole-routing/</guid>
      <description>&lt;p&gt;It&amp;rsquo;s no secret or ground breaking area to do black hole routing.&lt;/p&gt;

&lt;p&gt;ISPs and NSPs have been doing it forever to allow for a very low cost, very scriptable and very effective way to wholesale block a layer3 address. However, it can seem like a bit of a black box to anyone who has never done it.&lt;/p&gt;

&lt;p&gt;I recently did some work spinning this up in a good sized network that it didn&amp;rsquo;t currently exist, and remembered how monumentally useful (and simple) it actually is.&lt;/p&gt;

&lt;p&gt;There are lots of ways to do this. There are a lot of different &lt;a href=&#34;http://packetlife.net/blog/2009/jul/6/remotely-triggered-black-hole-rtbh-routing/&#34;&gt;articles&lt;/a&gt; written about how to do it. Cisco includes it in their CCIE Security track.&lt;/p&gt;

&lt;p&gt;The idea is a pretty simple one. Run &lt;a href=&#34;http://en.wikipedia.org/wiki/Reverse_path_forwarding#Unicast_RPF_.28uRPF.29&#34;&gt;uRPF&lt;/a&gt; on your eBGP speakers. Create a peering with a router on the inside. For my purposes I used a private ASN and peered it with eBGP to my border devices. Create a static route to null0 on the BHR (Black Hole Router), which then sends the route (possibly tagged with a community) to the eBGP speakers. They see an internal route for this external host, so any packets that come from that host on the outside get dropped on the floor by uRPF. In theory it&amp;rsquo;s all handled in hardware so the overhead is minimal and the blocks are as fast as a BGP route advertisement/withdrawal.&lt;/p&gt;

&lt;p&gt;There are, of course, lots of caveats to this, like, what if you are taking default on your eBGP speakers? How is that handled. One of the places I recently set this up takes default, one takes full tables. I suggest reading &lt;a href=&#34;http://www.cisco.com/web/about/security/intelligence/unicast-rpf.html&#34;&gt;this page&lt;/a&gt; if you aren&amp;rsquo;t experienced with uRPF, it explains how cissco handles it and is a decent primer on uRPF in general.&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;m a simple guy and I like things to be easy to support, so my designs tend to be those that can easily be maintained by someone that !=me and not so overly complicated that they can be reverse engineered in case of emergency or replicated if need be.&lt;/p&gt;

&lt;p&gt;That said, I&amp;rsquo;ve chosen to do it in a pocketbook friendly way. It probably stems from cutting my teeth at a decent sized mom and pop ISP that had a very small operating budget so we did things in creative and cost savings ways while still keeping them simple and supportable. I&amp;rsquo;m not sure why, but it makes more sense to me to run a software router like &lt;a href=&#34;http://www.blogger.com/www.quagga.net&#34;&gt;Quagga&lt;/a&gt; or &lt;a href=&#34;http://www.openbgpd.org/&#34;&gt;OpenBGPd&lt;/a&gt; that I can run as a VM and connect to my IGP and EGP, scripting the adds and removal of the routes we want to blackhole. It can also be done with an actual router, but I personally prefer to drop it in as a software router.&lt;/p&gt;

&lt;p&gt;The use of a linux box allows for a bunch of neat options. You can use the iproute2 package to watch changes to the routing table, you can run it in a virtual machine, it can be done in a very economical way, etc.&lt;/p&gt;

&lt;p&gt;Using Quagga has its pros and its cons. Quagga is a great platform, but it is an open source project. Their ISISd support is a bit lacking, so if your IGP is ISIS, it will work, but it feels half baked to me (and there is zero documentation that I could find). The ospf[v2 and v3] versions work fine. BGPd works well enough. It can be put into RANCID for configuration management and it is easily scriptable using vtysh and its IOS-like interface.&lt;/p&gt;

&lt;p&gt;Here is a basic design for a black hole router running inside a network with an external peering with something like a bogon route server:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://4.bp.blogspot.com/-5lZmt2zsQ3Y/T3oMBMHyysI/AAAAAAABIS4/T5lzIgb0I2I/s1600/BHR+Example.jpg&#34;&gt;&lt;img src=&#34;http://4.bp.blogspot.com/-5lZmt2zsQ3Y/T3oMBMHyysI/AAAAAAABIS4/T5lzIgb0I2I/s320/BHR+Example.jpg&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This just shows a basic setup, one site border router and a black hole box. In this example, the BHR is also peered with an external &amp;ldquo;service&amp;rdquo; like a bogon route server. This is a value-add, and not required.&lt;/p&gt;

&lt;p&gt;Any traffic that comes in can be routed to null0 on the bhr. This, in turn, sends a routes to the SBR. The SBR then installs it as an internal route. Now, any traffic that comes in from this route outside will looked like spoofed traffic and uRPF will discard it.&lt;/p&gt;

&lt;p&gt;Very simple, very effective.&lt;/p&gt;

&lt;p&gt;[[ This is a content summary only. Visit my website for full links, other content, and more! ]]&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>GoogleCL, command line based google blogger, picasa, calendar and much, much more.</title>
      <link>https://forwardingplane.net/post/googlecl-command-line-based-google-blogger-picasa-calendar-and-much-much-more/</link>
      <pubDate>Wed, 07 Sep 2011 03:42:00 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/googlecl-command-line-based-google-blogger-picasa-calendar-and-much-much-more/</guid>
      <description>&lt;p&gt;Google has introduced a very powerful set of python based command line (CLI) tools called &lt;a href=&#34;http://code.google.com/p/googlecl/&#34;&gt;GoogleCL&lt;/a&gt;. This post was made using GoogleCL from my Mac. I highly recommend checking it out if you like to automate or script stuff.&lt;/p&gt;

&lt;p&gt;[[ This is a content summary only. Visit my website for full links, other content, and more! ]]&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Switching from MacPorts to Homebrew</title>
      <link>https://forwardingplane.net/post/switching-from-macports-to-homebrew/</link>
      <pubDate>Sat, 06 Aug 2011 17:22:00 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/switching-from-macports-to-homebrew/</guid>
      <description>&lt;p&gt;I&amp;rsquo;ve recently decided that even though I love the BSD style &lt;a href=&#34;http://www.macports.org&#34;&gt;MacPorts&lt;/a&gt; system, it can be too clunky to maintain and doesn&amp;rsquo;t handle dependancies as well as I&amp;rsquo;d like (much like the actual BSD ports collection). So, in doing a little looking I found that &lt;a href=&#34;http://www.finkproject.org/&#34;&gt;Fink&lt;/a&gt; is still out of date, but &lt;a href=&#34;http://mxcl.github.com/homebrew/&#34;&gt;Homebrew&lt;/a&gt; is very simple and also really elegant comparatively speaking.&lt;/p&gt;

&lt;p&gt;Since homebrew doesn&amp;rsquo;t wrk well with other packge systems installed, and I already&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;d like to know what I had installed since this system has been in use for 2+ years, so I do a list and send it to a txt file:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;touch ~/Documents/installed.macports.txt&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;sudo port list installed &amp;gt; Documents/installed.macports.txt&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;sudo cat .macports/history &amp;gt;&amp;gt; ~/Documents/installed.macports.txt&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Then I remove the installed packages:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;sudo port -f uninstall installed&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Per the instructions found on the &lt;a href=&#34;http://guide.macports.org/chunked/installing.macports.uninstalling.html&#34;&gt;MacPorts page&lt;/a&gt;, remove all of the directories as such:&lt;/p&gt;

&lt;p&gt;_sudo rm -rf \_&lt;/p&gt;

&lt;p&gt;_/opt/local \_&lt;/p&gt;

&lt;p&gt;_/Applications/DarwinPorts \_&lt;/p&gt;

&lt;p&gt;_/Applications/MacPorts \_&lt;/p&gt;

&lt;p&gt;_/Library/LaunchDaemons/org.macports.* \_&lt;/p&gt;

&lt;p&gt;_/Library/Receipts/DarwinPorts*.pkg \_&lt;/p&gt;

&lt;p&gt;_/Library/Receipts/MacPorts*.pkg \_&lt;/p&gt;

&lt;p&gt;_/Library/StartupItems/DarwinPortsStartup \_&lt;/p&gt;

&lt;p&gt;_/Library/Tcl/darwinports1.0 \_&lt;/p&gt;

&lt;p&gt;_/Library/Tcl/macports1.0 \_&lt;/p&gt;

&lt;p&gt;&lt;em&gt;~/.macports&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;If this is an upgraded machine (say, from 10.6 to 10.7), you&amp;rsquo;ll need to also reinstall the Xcode Developer Tools via the app store before installing homebrew.&lt;/p&gt;

&lt;p&gt;After waiting forever to get XCode downloaded, and since it&amp;rsquo;s been installed via the App Store under Lion (10.7), I need to run the “Install Xcode” app that is placed in /Applications.&lt;/p&gt;

&lt;p&gt;Now I can &lt;a href=&#34;https://github.com/mxcl/homebrew/wiki/Installation&#34;&gt;Install homebrew&lt;/a&gt; via the handy cli command:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;sudo /usr/bin/ruby -e &amp;ldquo;$(curl -fsSL &lt;a href=&#34;https://raw.github.com/gist/323731)&amp;quot;&#34;&gt;https://raw.github.com/gist/323731)&amp;quot;&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;You&amp;rsquo;ll then see something like this:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;\==&amp;gt; This script will install:&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;/usr/local/bin/brew&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;/usr/local/Library/Formula/&amp;hellip;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;/usr/local/Library/Homebrew/&amp;hellip;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;\==&amp;gt; The following directories will be made group writable:&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;/usr/local/share/man&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;/usr/local/lib/pkgconfig&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;/usr/local/share/man/man8&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;/usr/local/share/doc&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;/usr/local/bin&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;/usr/local/include&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;/usr/local/lib&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;/usr/local/share&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;\==&amp;gt; The following directories will have their group set to staff:&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;/usr/local/share/man&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;/usr/local/lib/pkgconfig&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;/usr/local/share/man/man8&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;/usr/local/share/doc&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;/usr/local/bin&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;/usr/local/include&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;/usr/local/lib&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;/usr/local/share&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Press enter to continue&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;If you want to continue, hit enter.  In my case, I saw this:&lt;/p&gt;

&lt;p&gt;\==&amp;gt; /usr/bin/sudo /bin/chmod o+w /usr/local&lt;/p&gt;

&lt;p&gt;\==&amp;gt; /usr/bin/sudo /bin/chmod g+w /usr/local/share/man /usr/local/lib/pkgconfig /usr/local/share/man/man8 /usr/local/share/doc /usr/local/bin /usr/local/include /usr/local/lib /usr/local/share&lt;/p&gt;

&lt;p&gt;\==&amp;gt; /usr/bin/sudo /usr/bin/chgrp staff /usr/local/share/man /usr/local/lib/pkgconfig /usr/local/share/man/man8 /usr/local/share/doc /usr/local/bin /usr/local/include /usr/local/lib /usr/local/share&lt;/p&gt;

&lt;p&gt;\==&amp;gt; Downloading and Installing Homebrew&amp;hellip;&lt;/p&gt;

&lt;p&gt;\==&amp;gt; /usr/bin/sudo /bin/chmod o-w /usr/local&lt;/p&gt;

&lt;p&gt;Warning: Now install Xcode: &lt;a href=&#34;http://developer.apple.com/technologies/xcode.html&#34;&gt;http://developer.apple.com/technologies/xcode.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Warning: The following *evil* dylibs exist in /usr/local/lib&lt;/p&gt;

&lt;p&gt;They may break builds or worse. You should consider deleting them:&lt;/p&gt;

&lt;p&gt;/usr/local/lib/libfuse.2.dylib&lt;/p&gt;

&lt;p&gt;/usr/local/lib/libfuse_ino64.2.dylib&lt;/p&gt;

&lt;p&gt;\==&amp;gt; Installation successful!&lt;/p&gt;

&lt;p&gt;Now type: brew help&lt;/p&gt;

&lt;p&gt;I chose to leave those libraries and deal with the fallout as I saw it.&lt;/p&gt;

&lt;p&gt;Now I need to install the base repository manager that brew uses:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;sudo brew install git&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Then I can update the brew repository:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;sudo brew update&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;That&amp;rsquo;s basically it. Now I can install apps via HomeBrew using the simple command:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;sudo brew install&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;I chose to install nmap as a test:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;sudo brew install nmap&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;You&amp;rsquo;re done. Enjoy your HomeBrew =)&lt;/p&gt;

&lt;p&gt;[[ This is a content summary only. Visit my website for full links, other content, and more! ]]&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>MacOS 10.7 and IPv6 privacy addressing</title>
      <link>https://forwardingplane.net/post/macos-10-7-and-ipv6-privacy-addressing/</link>
      <pubDate>Sun, 31 Jul 2011 02:40:00 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/macos-10-7-and-ipv6-privacy-addressing/</guid>
      <description>&lt;p&gt;I&amp;rsquo;m not a fan of IPv6 privacy addressing. I understand the logic behind it, I really doo, obfuscate the LLADDR (MAC address) of the host in question, but I really dont&amp;rsquo;t see the realistic purpose. If someone wanted to use my mac address, what good would that really get them, unless they&amp;rsquo;re on the same layer 2 segment? More importantly, if they;re on the same layer 2 segment, they have my MAC address anyway.&lt;br /&gt;
Privacy addresses cause more heartburn than they cure. How do I track someone who has a rotating address? Am I scraping the neighbor table of my network equipment often enough to have reasonable accountability? Probably, but what if I&amp;rsquo;m not? I could go on and on about how I think &lt;a href=&#34;http://www.ietf.org/rfc/rfc4941.txt&#34;&gt;RFC4941&lt;/a&gt; addresses aren&amp;rsquo;t that useful, but instead I&amp;rsquo;ll just write down how to disable them (I&amp;rsquo;ve always been known as more of a machete than a scalpel anyway =).&lt;/p&gt;

&lt;p&gt;With MacOS 10.7 (Lion) it&amp;rsquo;s now on by default. To disable it, you need to open a terminal and type:&lt;/p&gt;

&lt;p&gt;_sudo sysctl -w net.inet6.ip6.use_tempaddr=0&lt;br /&gt;
_&lt;br /&gt;
Poof! There you go. &lt;a href=&#34;http://tech.buraglio.com/2011/07/osx-107-lion-dhcpv6-client-working-with.html&#34;&gt;You should be using DHCPv6 anyway&lt;/a&gt; =) [](&lt;a href=&#34;http://events.internet2.edu/2011/jt-uaf/agenda.cfm?go=session&amp;amp;id=10001852&amp;amp;event=1151&#34;&gt;http://events.internet2.edu/2011/jt-uaf/agenda.cfm?go=session&amp;amp;id=10001852&amp;amp;event=1151&lt;/a&gt;) &lt;a href=&#34;http://events.internet2.edu/2011/jt-uaf/agenda.cfm?go=session&amp;amp;id=10001852&amp;amp;event=1151&#34;&gt;&lt;strong&gt;*cue vendors getting off their rear ends and implementing dhcpv6 relay*&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;-&amp;ndash;edit&amp;mdash;&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;A good point made by Charley Kline, to make this persist across reboots a line needs to be added to your /etc/sysctl.conf.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;To accomplish this, edit /etc/sysctl.conf&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&lt;strong&gt;sudo vi /etc/sysctl.conf&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Add the following line:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&lt;strong&gt;net.inet6.ip6.use_tempaddr=0&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;--edit&amp;ndash;&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;For all you windows users:&lt;/p&gt;

&lt;p&gt;XP:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;netsh interface ipv6 set privacy state=disabled store=persistent&lt;br /&gt;
netsh interface ipv6 set privacy state=disabled&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Vista:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;netsh interface ipv6 set global randomizeidentifiers=disabled&lt;br /&gt;
netsh interface ipv6 set global randomizeidentifiers=disabled store=persistent&lt;br /&gt;
netsh interface ipv6 set privacy disabled&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;I assume Windows 7 is similar to Vista, but I have not tested.&lt;/p&gt;

&lt;p&gt;[[ This is a content summary only. Visit my website for full links, other content, and more! ]]&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>OSX (10.7; Lion) DHCPv6 client working with pfsense server.</title>
      <link>https://forwardingplane.net/post/osx-10-7-lion-dhcpv6-client-working-with-pfsense-server/</link>
      <pubDate>Tue, 26 Jul 2011 18:20:00 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/osx-10-7-lion-dhcpv6-client-working-with-pfsense-server/</guid>
      <description>&lt;p&gt;It looks like MacOS 10.7 (Lion) has fully functioning DHCPv6. It&amp;rsquo;s about time.&lt;/p&gt;

&lt;p&gt;Before:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://1.bp.blogspot.com/-6FQwzCiawpg/TjDWmwrbONI/AAAAAAAAAEI/9mOtP9fMbqE/s1600/Screen%2BShot%2B2011-07-25%2Bat%2B8.45.24%2BPM.png&#34;&gt;&lt;img src=&#34;http://1.bp.blogspot.com/-6FQwzCiawpg/TjDWmwrbONI/AAAAAAAAAEI/9mOtP9fMbqE/s400/Screen%2BShot%2B2011-07-25%2Bat%2B8.45.24%2BPM.png&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;After:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://4.bp.blogspot.com/-stFnUb3g1zI/TjDW1MDpOyI/AAAAAAAAAEY/YgG7fXCfujY/s1600/Screen%2BShot%2B2011-07-26%2Bat%2B7.18.45%2BAM.png&#34;&gt;&lt;img src=&#34;http://4.bp.blogspot.com/-stFnUb3g1zI/TjDW1MDpOyI/AAAAAAAAAEY/YgG7fXCfujY/s400/Screen%2BShot%2B2011-07-26%2Bat%2B7.18.45%2BAM.png&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;pfSense setup:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://2.bp.blogspot.com/-gSN5Rx7vIUU/TjDW0t1BcEI/AAAAAAAAAEQ/1hQNIlCJl30/s1600/Screen%2BShot%2B2011-07-26%2Bat%2B7.16.50%2BAM.png&#34;&gt;&lt;img src=&#34;http://2.bp.blogspot.com/-gSN5Rx7vIUU/TjDW0t1BcEI/AAAAAAAAAEQ/1hQNIlCJl30/s400/Screen%2BShot%2B2011-07-26%2Bat%2B7.16.50%2BAM.png&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Using Internet Systems Consortium DHCP Server 4.2.1-P1 as the server (on my pfSense box) I am able to get not only a privacy address (via stateless autoconfigure) but also a normal EUI-64 address as well as an IPv6 address via dhcpv6.&lt;/p&gt;

&lt;p&gt;I didn&amp;rsquo;t do anything except use the &amp;ldquo;Automatic&amp;rdquo; setting in the network control panel, so out of the box OSX 10.7 &amp;ldquo;Lion&amp;rdquo; looks like it does the right thing with DHCPv6, at least at face value.&lt;/p&gt;

&lt;p&gt;[[ This is a content summary only. Visit my website for full links, other content, and more! ]]&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>alurancid and pfrancid</title>
      <link>https://forwardingplane.net/post/alurancid-and-pfrancid/</link>
      <pubDate>Thu, 30 Jun 2011 20:12:00 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/alurancid-and-pfrancid/</guid>
      <description>&lt;p&gt;I did some minor tweaking to the Alcatel Lucent RANCID scripts and some modifications to make RANCID work under my pfsense environment (originally m0n0rancid code from John Skopis). Since I don&amp;rsquo;t really do much dev work and am not interested in maintaing a box do be an SVN server for the public, I threw it up onto google code.&lt;br /&gt;
I&amp;rsquo;ll be adding a brief how-to on making RANCID work with pfSense as soon as I get some time.&lt;/p&gt;

&lt;p&gt;The scripts can be found here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://code.google.com/p/alurancid/&#34;&gt;Alcatel-Lucent RANCID&lt;/a&gt;&lt;br /&gt;
&lt;a href=&#34;http://code.google.com/p/pfrancid/&#34;&gt;pfSense RANCID&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;[[ This is a content summary only. Visit my website for full links, other content, and more! ]]&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Better support for Linux (and annoyed about it)</title>
      <link>https://forwardingplane.net/post/better-support-for-linux-and-annoyed-about-it/</link>
      <pubDate>Mon, 20 Jun 2011 08:43:00 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/better-support-for-linux-and-annoyed-about-it/</guid>
      <description>&lt;p&gt;I&amp;rsquo;ve been a *BSD user since around 1997, when I installed NetBSD on a Mac SE 30 that I got for free. I was always intrigued with alternative operating systems like BeOS, *BSD, Plan9 and Linux so it made sense that I&amp;rsquo;d poke around with different systems.&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;d gone back and forth from OpenBSD to FreeBSD but eventually settled on FreeBSD as my OS of choice. I ran it as a desktop before MacOS X came out and was generally happy with it. I learned most of the common flavors of Linux over the years out of curiosity and necessity but always went back to BSD for anything critical.&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;m sad to say that I think this is changing.&lt;/p&gt;

&lt;p&gt;I feel like a bit of a sell out, it was always cool to say I ran FreeBSD and to silently look at Linux users as nerdy dorks that were afraid of girls that lived in their mothers basement and talked about &lt;a href=&#34;http://en.wikipedia.org/wiki/Linus_Torvalds&#34;&gt;Linus Torvalds&lt;/a&gt; and &lt;a href=&#34;http://en.wikipedia.org/wiki/Richard_Stallman&#34;&gt;Richard Stallman&lt;/a&gt; like they are demigods.&lt;/p&gt;

&lt;p&gt;As I get busier both personally and professionally, it&amp;rsquo;s becoming more of a chore to manage a BSD system or a set of BSD systems. The ports collection is clunky and annoying to use once I saw the elegance of something like apt. The software support for the stuff I do every day either available for linux first or only available under linux. Network tunables like web100 are linux specific. HPC clusters are almost exclusively Linux. The straw that has broken the camels back is &lt;a href=&#34;http://www.thc.org/thc-ipv6/&#34;&gt;THC-IPv6&lt;/a&gt;. I had a need to do some IPv6 testing that required poking at equipment in a way that tests it&amp;rsquo;s metal. I needed tools to try to break the network and do other nefarious things. &lt;a href=&#34;http://www.thc.org/thc-ipv6/&#34;&gt;THC-IPv6&lt;/a&gt; fits the bill. It works ONLY under Linux due to the use of /proc. Yes, you can make /proc work under FreeBSD, but it&amp;rsquo;s annoying and I&amp;rsquo;m fairly certain that the code still won&amp;rsquo;t build without hackery that I&amp;rsquo;m not willing to do.&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;d been poking around with Debian for years as an alternative for those things that just don&amp;rsquo;t run under BSD. The tools I need have been building fine under Debian and Ubuntu. It&amp;rsquo;s just *easy*.&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;ll still hold a place in my heart for BSD, I think the license it FAR superior (GPL has a host of issues that I&amp;rsquo;m not comfortable with), but for now, Im going to have to &amp;ldquo;sell out&amp;rdquo; and use Linux. Mark the calendar, this is the day the music died.&lt;/p&gt;

&lt;p&gt;[[ This is a content summary only. Visit my website for full links, other content, and more! ]]&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Sync catalogs (iPhoto, iTunes) on a mac</title>
      <link>https://forwardingplane.net/post/sync-catalogs-iphoto-itunes-on-a-mac/</link>
      <pubDate>Fri, 18 Feb 2011 12:46:00 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/sync-catalogs-iphoto-itunes-on-a-mac/</guid>
      <description>&lt;p&gt;I have huge iPhoto and iTunes catalogs. This can present a problem for both loading the applications and for backup. I have learned to deal with the Application load times, but backups are very important to me.&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;d gone through the iPhoto backup process and restore more than once, and I didn&amp;rsquo;t like the fact that I didn&amp;rsquo;t have an offsite backup, so I paid for a flickr pro account ($24/yr, supports iPhoto export and RAW format). I had been simply copying my iTunes over to my NAS for a long time (as well as using Time Machine), but that became a chore because I had not automated it.&lt;/p&gt;

&lt;p&gt;After about a month of off-and-on searching, I finally went back to my UNIX roots and decided on rsync.&lt;/p&gt;

&lt;p&gt;You simply can&amp;rsquo;t beat rsync.&lt;/p&gt;

&lt;p&gt;I wrote a very simple shell script to call from cron every night to sync whatever IU thought I needed to sync to my NAS (it works to any other source, really, due to rsync&amp;rsquo;s flexibility).&lt;/p&gt;

&lt;p&gt;This is my simple rsync script:&lt;/p&gt;

&lt;p&gt;#!/bin/sh&lt;/p&gt;

&lt;p&gt;# Sync catalogs to externally mounted volume.&lt;/p&gt;

&lt;p&gt;# nick@buraglio.com&lt;/p&gt;

&lt;p&gt;RSYNC=&amp;lsquo;/usr/bin/rsync&amp;rsquo;&lt;/p&gt;

&lt;p&gt;ITUNESSRC=&amp;lsquo;/Users/Shared/iTunes&amp;rsquo; # iTunes Folder&lt;/p&gt;

&lt;p&gt;ITUNESDST=&amp;lsquo;/Volumes/Volume_1/Catalog\ Backups/iTunes&amp;rsquo; #Destination for iTunes Backup&lt;/p&gt;

&lt;p&gt;IPHOTOSRC=&amp;lsquo;/Users/Shared/iPhoto&amp;rsquo; #iPhoto Folder&lt;/p&gt;

&lt;p&gt;IPHOTODST=&amp;lsquo;/Volumes/Volume_1/Catalog\ Backups/iPhoto&amp;rsquo; #Destination for iPhoto Backup&lt;/p&gt;

&lt;p&gt;PARAMS=&amp;lsquo;&amp;ndash;ignore-existing &amp;ndash;delete &amp;ndash;progress &amp;ndash;recursive &amp;ndash;perms &amp;ndash;times &amp;ndash;size-only &amp;ndash;whole-file&amp;rsquo; # Any parameters for rsync&lt;/p&gt;

&lt;p&gt;EXCLUDEITUNES=&amp;lsquo;-exclude=&amp;rsquo;.*&amp;rsquo; -exclude=&amp;rsquo;*.m4v&amp;rdquo; # Files or folders for exclusion&lt;/p&gt;

&lt;p&gt;EXCLUDEIPHOTO=&amp;lsquo;-exclude=&amp;rsquo;.*&amp;rdquo; # Files or folders for exclusion&lt;/p&gt;

&lt;p&gt;$RSYNC $PARAMS $EXCLUDEITUNES $ITUNESSRC $ITUNESDST&lt;/p&gt;

&lt;p&gt;$RSYNC $PARAMS $EXCLUDEIPHOTO $IPHOTOSRC $IPHOTODST&lt;/p&gt;

&lt;p&gt;Thats it. Since the &amp;ldquo;&amp;ndash;delete&amp;rdquo; flag is in place, I recommend use of the &amp;ldquo;&amp;ndash;dry-run&amp;rdquo; flag the first time to make sure it does what you want, since delete &lt;strong&gt;will&lt;/strong&gt; remove everything in it&amp;rsquo;s path and make the folder match. I just have this run from cron every day using this line in my users crontab.&lt;/p&gt;

&lt;p&gt;@daily  /opt/local/bin/rsynccatalogs.sh&lt;/p&gt;

&lt;p&gt;[[ This is a content summary only. Visit my website for full links, other content, and more! ]]&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Alcatel Lucent RANCID scripts</title>
      <link>https://forwardingplane.net/post/alcatel-lucent-rancid-scripts/</link>
      <pubDate>Mon, 06 Dec 2010 07:06:00 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/alcatel-lucent-rancid-scripts/</guid>
      <description>&lt;p&gt;At the &lt;a href=&#34;https://scinet.supercomputing.org/&#34;&gt;2010 Supercomputing conference&lt;/a&gt; this year, one of my tasks was to get &lt;a href=&#34;http://shrubbery.net/rancid/&#34;&gt;RANCID&lt;/a&gt; working on the Alcatel Lucent 77xx series. for some this may have been a simple task, but for me, a self taught and inefficient programmer, it was something that took some time.&lt;br /&gt;
The Alcatel Lucent boxes were good performers, but their CLI is pretty awful. The prompt changes based on having unsaved configuration items, and can contain things liks an asterisk. The configuration file also displays the # symbol, a very common &amp;ldquo;enabled&amp;rdquo; router prompt, making the config a bit different to parse. I&amp;rsquo;m happy to report that the &lt;a href=&#34;http://shrubbery.net/rancid/&#34;&gt;RANCID&lt;/a&gt; scripts work for the ALU boxes now. for anyone that wants to use them (since I dont know if they&amp;rsquo;ll be added to the base distribution), they can be found &lt;a href=&#34;http://www.buraglio.com/scripts/alurancid/&#34;&gt;here&lt;/a&gt;.&lt;br /&gt;
SVN of this and some other things I hacked into RANCID for the Nexus and the CRS can be found &lt;a href=&#34;http://buraglio.com/dev/&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;[[ This is a content summary only. Visit my website for full links, other content, and more! ]]&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Android (Nexus One) or iPhone?</title>
      <link>https://forwardingplane.net/post/android-nexus-one-or-iphone/</link>
      <pubDate>Wed, 13 Oct 2010 09:56:00 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/android-nexus-one-or-iphone/</guid>
      <description>&lt;p&gt;*Cross posted from my &lt;a href=&#34;http://www.nickburaglio.com/&#34;&gt;personal blog&lt;/a&gt; since it&amp;rsquo;s a technical subject*&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://handies.phandroid.com/media/nexus-one-1269816018-806.jpg&#34;&gt;&lt;img src=&#34;http://handies.phandroid.com/media/nexus-one-1269816018-806.jpg&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;That is the million dollar question on many phone geeks minds.&lt;/p&gt;

&lt;p&gt;The iPhone is really a love it or hate it kind of device, much like Apple stuff in general. Android, on the other hand, is still new enough that some folks are still ignoring it. Well, I wanted to know which worked better for me, and so I set out to test them both.&lt;/p&gt;

&lt;p&gt;For the purposes of this test, I&amp;rsquo;m used an HTC Nexus One running both Stock and CyanogenMod firmware (Android 2.2) and an Apple iPhone 4 running iOS 4.1.&lt;/p&gt;

&lt;p&gt;I must say, the results tha t I got were not what I expected. I&amp;rsquo;ve been a mac guy for a REALLY long time, even dating back to the Apple ][ days. That said, I&amp;rsquo;m not as religious about it as some folks are. I gave up my beloved PowerMac 7100 in favor of a BSD machine back in the 1990&amp;rsquo;s and have been a champion of the BSD OS ever since.&lt;/p&gt;

&lt;p&gt;A little history, I&amp;rsquo;ve been an iPhone user since the 2g. I&amp;rsquo;ve done all of the jailbreaking and unlocking, even when it wasn&amp;rsquo;t straightforward and &amp;ldquo;one-click&amp;rdquo;. I&amp;rsquo;m also pretty familiar with Linux and I prefer a command line over a gui.&lt;/p&gt;

&lt;p&gt;I thought that the Android phone would be a perfect next step for someone who likes to tinker with the UI, tweak settings and generally be able to control most aspects of his mobile device.&lt;/p&gt;

&lt;p&gt;&amp;hellip;.and that was mostly true. I LOVED the fact that my stuff was stored in the cloud. The fact that I could default my N1 and lock in as myself and all of my apps just showed back up with absolutely 0 user input (other than logging in) was awesome to me. A few apps had me totally sold. &lt;a href=&#34;http://blog.350nice.com/wp/products/picpush&#34;&gt;PicPush&lt;/a&gt;, for one, was a great app. Automatically doing things like pushing my images into the &amp;ldquo;cloud&amp;rdquo; (flickr and picasa) was amazing. The one BIG deal to me, though, was &lt;a href=&#34;http://www.androlib.com/android.application.tv-studer-smssync-jjD.aspx&#34;&gt;SMS backup&lt;/a&gt;. the idea of always having my text messages backed up into my email, tagged and all, was too appealing to pass up. I LOVED this ability. I get a lot of txt messages and, unfortunately, a lot of important info comes in that way. The fact that I can have it show up somewhere else, backed up, with no work on my part was&amp;hellip;sublime. Simple Google voice integration was a huge plus as well.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://macosrumors.com/wp-content/uploads/2010/06/iphone4-thumb-640xauto-14425.jpg&#34;&gt;&lt;img src=&#34;http://macosrumors.com/wp-content/uploads/2010/06/iphone4-thumb-640xauto-14425.jpg&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&amp;hellip;Then I played with my wife&amp;rsquo;s iPhone 4. We did facetime with our son while away for a weekend. &lt;a href=&#34;http://www.tuaw.com/2010/09/17/gv-connect-app-for-google-voice-now-available/&#34;&gt;The allowed the Google Voice apps back in the iTunes store&lt;/a&gt;, so no more jailbreaking needed for useful apps. Backgrounding processes works. Multiple Exchange accounts now supported without jailbreaking and hacking the plist.&lt;/p&gt;

&lt;p&gt;*sigh*&lt;/p&gt;

&lt;p&gt;This is going to be a harder sell than I originally suspected.&lt;/p&gt;

&lt;p&gt;So I set out to test my theory. I bought an iPhone 4 (after selling my 3g on ebay to ofset the cost). I fully expected that I&amp;rsquo;d like the N1 better. Simply comparing the hardware of the devices is pretty close, as described &lt;a href=&#34;http://www.phonescoop.com/phones/compare.php?id%5B%5D=2520&amp;amp;id%5B%5D=2798&amp;amp;id%5B%5D=&amp;amp;id%5B%5D=&amp;amp;id%5B%5D=&#34;&gt;here at phonescoop.com&lt;/a&gt;. In my opinion (and for the things important to me) the phones really cancel each others strong points out with attributes like removable media and battery (N1) with better screen and MUCH better visibility in sunlight (iPhone).&lt;/p&gt;

&lt;p&gt;Here is my rough (and obviously biased toward things I think are and aren&amp;rsquo;t important) rundown:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Screen&lt;/strong&gt;: The iPhone has better resolution, far better visibility in the sun. &lt;strong&gt;iPhone, without question.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Apps&lt;/strong&gt;: Close. Android has more tuning and tweaking apps, allows for the UI to be bent and molded. iPhone has FAR more apps and many are much more refined. My belief is that after Android has been around as long as the iPhone and in as many dev hands, this will level out and maybe even surpass (since apple isn&amp;rsquo;t strangling the dev abilities). &lt;strong&gt;Close, but I&amp;rsquo;m going to have to give this one to iPhone based on the sheer number and quality of apps.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Compatibility&lt;/strong&gt;: Also close. I both love and hate that I need iTunes. Syncing my contacts, mail and calendars to the &amp;ldquo;cloud&amp;rdquo; on my iPhone helps, but ultimately, probably slightly better for Android. Media sync kinda sucks for anyone that has bought straight into iTunes for cataloging music and movies. iPhoto support is nice, though. &lt;a href=&#34;http://www.doubletwist.com/&#34;&gt;DoubleTwist&lt;/a&gt; for Android is still buggy and lacks features in my experience. I use only UNIX and Mac, so I never looked into any windows software since it would only be foreign to me and I have not owned a windows machine in more than 10 years. In general, I&amp;rsquo;d probably have to give this one a tie based on the trade offs. &lt;strong&gt;For me, iPhone was the clear winner.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Media support&lt;/strong&gt;: Also a trade off. Android has WAY more codecs that it can support (especially if you use a cool custom ROM like &lt;a href=&#34;http://www.cyanogenmod.com/&#34;&gt;CyanogenMod&lt;/a&gt;), but for someone that has been cataloging music with iTunes since it came out and has an ENORMOUS music and movie collection with smart playlists galore, iTunes support is the clear winner. (Obviously this one is clearly biased since I&amp;rsquo;ve bought into iTunes hook, line and sinker).&lt;/p&gt;

&lt;p&gt;Editing 720p video right on my iPhone works seamlessly. &lt;strong&gt;I&amp;rsquo;m going to have to go with iPhone on this one.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Multimedia Messaging&lt;/strong&gt;: A minor or non issue for some but I use it a lot. FaceTime is amazing and we use it quite a bit. Sending MMS movies and uploading to youtube seems far better on the iPhone. I never could get MMS movies to work on my N1 and the upload to youtube was pretty rough, sometimes failing completely. &lt;strong&gt;I&amp;rsquo;m gonna give this one to the iPhone.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;UI&lt;/strong&gt;: Also tough. Mods have made Android very elegant. The ability to tweak the UI and add features is a clear advantage to me. However, the fact that Apple keeps a lockdown on that stuff means that I always have a consistant experience. The UI on the iPhone is obviously elegant and sleek. The trade offs (for me) cancel each other out. &lt;strong&gt;For my money this is going to have to be a tie.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;802.11 Network&lt;/strong&gt;: Both do 802.11N on the 2.4ghz band. Both do WPA2 enterprise. Nexus One can create a hotspot without me jailbreaking it and/or paying AT&amp;amp;T. &lt;strong&gt;Nexus One CLEAR winner.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Storage:&lt;/strong&gt; My iPhone has 16G of storage total. ~14ish is usable. My N1 has 512M on board and a removable microSD card that is 16G. C&lt;strong&gt;learly the Nexus One wins this category for having removable media.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Batter Life:&lt;/strong&gt; I get a lot of calls and txts (and email) all day. I can go about 2 days with the iPhone 4 with the same accounts configured and txt/data/phone usage as I get almost 24hours with the Nexus One.&lt;/p&gt;

&lt;p&gt;However, I can charge the Nexus One with any standard MicroUSB cable and change out the battery with a fresh one. I can also replace the battery if it goes bad (easily). &lt;strong&gt;Advantage, Nexus One.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Overall, the jury is still out, as I still have both. Lately, though, I;ve been considering selling the N1 and getting an iPad. I do, however, believe that Android is probably going to grab a significant market share since there are a LOT of apple haters out there, and there are even more companies grabbing the OS since it&amp;rsquo;s open source.&lt;/p&gt;

&lt;p&gt;[[ This is a content summary only. Visit my website for full links, other content, and more! ]]&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>NFS mounting a NAS with MacOS 10.6 (Snow Leopard)</title>
      <link>https://forwardingplane.net/post/nfs-mounting-a-nas-with-macos-10-6-snow-leopard/</link>
      <pubDate>Mon, 06 Sep 2010 11:00:00 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/nfs-mounting-a-nas-with-macos-10-6-snow-leopard/</guid>
      <description>&lt;p&gt;I know this is &lt;a href=&#34;http://hints.macworld.com/article.php?story=20090830073912179&#34;&gt;documented elsewhere&lt;/a&gt;, but this was a pain for me, so I wanted to take some notes.  I have several Snow Leopard (MAcOS 10.6) Macs and a Netgear DNS-323.  I want to mount the drive using NFS and any good UNIX admin would.&lt;br /&gt;
Unlike older versions of the Mac OS, NFS mounts are now handled under the Disk Utility application (which seems odd to me, but whatever).&lt;br /&gt;
So, to make this work right I had to do the following:&lt;br /&gt;
First, I had to make sure that the NFS Add-on was installed on the DNS-323.&lt;br /&gt;
Second, Open up Disk utility and go to file, NFS mounts.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://4.bp.blogspot.com/_t5EEUl7btNU/TIR2joSzRDI/AAAAAAAAC_A/jIWYuHwgZ-c/s1600/Screen+shot+2010-09-06+at+12.02.59+AM.png&#34;&gt;&lt;img src=&#34;http://4.bp.blogspot.com/_t5EEUl7btNU/TIR2joSzRDI/AAAAAAAAC_A/jIWYuHwgZ-c/s320/Screen+shot+2010-09-06+at+12.02.59+AM.png&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This will open up a new window like this:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://2.bp.blogspot.com/_t5EEUl7btNU/TIR2u9UMXQI/AAAAAAAAC_I/oZBsg4qkZ3Y/s1600/Screen+shot+2010-09-06+at+12.03.18+AM.png&#34;&gt;&lt;img src=&#34;http://2.bp.blogspot.com/_t5EEUl7btNU/TIR2u9UMXQI/AAAAAAAAC_I/oZBsg4qkZ3Y/s320/Screen+shot+2010-09-06+at+12.03.18+AM.png&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;From here, add your NFS mount location that you&amp;rsquo;ve specified within the NFS add-on (setting that part up is beyond the scope of this tutorial, you should know how to do that if you&amp;rsquo;ve gotten this far).&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Viewing ipv6 router advertisements</title>
      <link>https://forwardingplane.net/post/viewing-ipv6-router-advertisements/</link>
      <pubDate>Fri, 03 Sep 2010 19:00:00 +0000</pubDate>
      
      <guid>https://forwardingplane.net/post/viewing-ipv6-router-advertisements/</guid>
      <description>&lt;p&gt;I knew a tool like this had to exist, but I had never needed to look in the past.  While debugging a RA problem, I come upon the need to view IPv6 router advertisements.  How can one do this?  tcpdump?  Yeah, I guess that could work.  It&amp;rsquo;s almost like using a bulldozer when a wheelbarrow is all you need, though.  I could use &lt;a href=&#34;http://ndpmon.sourceforge.net/&#34;&gt;ndpmon&lt;/a&gt;, I suppose, but that, too seems like overkill.&lt;br /&gt;
So, the search began. After about 10 seconds of google searching&amp;hellip;.. Success!  A tool, does in fact exist for viewing exactly that type of packet.&lt;br /&gt;
Enter &lt;a href=&#34;http://gd.tuwien.ac.at/linuxcommand.org/man_pages/radvdump8.html&#34;&gt;radvdump&lt;/a&gt;.  It is part of the marvelous &lt;a href=&#34;http://www.freebsd.org/cgi/man.cgi?query=rtadvd&amp;amp;sektion=8&#34;&gt;rtadvd&lt;/a&gt; project.  It also exists in &lt;a href=&#34;http://www.macports.org/&#34;&gt;MacPorts&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Sweet, now I can see my IPv6 router advertisements in a very simple manner.  The syntax is very straightforward, the command sudo /opt/local/sbin/radvdump will yield you pretty much everything you need to know about what is in your router advertisement:&lt;/p&gt;

&lt;p&gt;# radvd configuration generated by radvdump 1.6&lt;br /&gt;
# based on Router Advertisement from fe80::20d:b9ff:fe18:8ca1&lt;br /&gt;
# received by interface en0&lt;/p&gt;

&lt;p&gt;interface en0&lt;br /&gt;
{&lt;br /&gt;
AdvSendAdvert on;&lt;br /&gt;
# Note: {Min,Max}RtrAdvInterval cannot be obtained with radvdump&lt;br /&gt;
AdvManagedFlag off;&lt;br /&gt;
AdvOtherConfigFlag off;&lt;br /&gt;
AdvReachableTime 0;&lt;br /&gt;
AdvRetransTimer 0;&lt;br /&gt;
AdvCurHopLimit 64;&lt;br /&gt;
AdvDefaultLifetime 1800;&lt;br /&gt;
AdvHomeAgentFlag off;&lt;br /&gt;
AdvDefaultPreference medium;&lt;br /&gt;
AdvSourceLLAddress on;&lt;/p&gt;

&lt;p&gt;prefix 2001:470:xxxx:xxx::/64&lt;br /&gt;
{&lt;br /&gt;
AdvValidLifetime 2592000;&lt;br /&gt;
AdvPreferredLifetime 604800;&lt;br /&gt;
AdvOnLink on;&lt;br /&gt;
AdvAutonomous on;&lt;br /&gt;
AdvRouterAddr off;&lt;br /&gt;
}; # End of prefix definition&lt;/p&gt;

&lt;p&gt;prefix 2001:470:xxxx:xxx::/64&lt;br /&gt;
{&lt;br /&gt;
AdvValidLifetime 2592000;&lt;br /&gt;
AdvPreferredLifetime 604800;&lt;br /&gt;
AdvOnLink on;&lt;br /&gt;
AdvAutonomous on;&lt;br /&gt;
AdvRouterAddr off;&lt;br /&gt;
}; # End of prefix definition&lt;/p&gt;

&lt;p&gt;}; # End of interface definition&lt;/p&gt;

&lt;p&gt;Once you have all of that working, head over to see the &lt;a href=&#34;http://www.kame.net/&#34;&gt;dancing kame&lt;/a&gt; (if you&amp;rsquo;re old school) of just head to &lt;a href=&#34;http://www.buraglio.com/&#34;&gt;my main domain&lt;/a&gt; and it&amp;rsquo;ll show you your ipv4 or ipv6 address at the top. Alternatively, you can use &lt;a href=&#34;http://www.google.com/intl/en/ipv6/&#34;&gt;google over ipv6&lt;/a&gt; in a number of &lt;a href=&#34;http://ipv6.google.com/&#34;&gt;ways&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;[[ This is a content summary only. Visit my website for full links, other content, and more! ]]&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
